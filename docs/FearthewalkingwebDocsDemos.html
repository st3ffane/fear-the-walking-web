<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">.lst-kix_8hsxmcrcwgbf-7>li:before{content:"\0025cb  "}.lst-kix_8hsxmcrcwgbf-6>li:before{content:"\0025cf  "}.lst-kix_8hsxmcrcwgbf-8>li:before{content:"\0025a0  "}.lst-kix_8hsxmcrcwgbf-5>li:before{content:"\0025a0  "}.lst-kix_z3z1tzvla6e6-0>li:before{content:"\0025cf  "}.lst-kix_z3z1tzvla6e6-1>li:before{content:"\0025cb  "}.lst-kix_z3z1tzvla6e6-3>li:before{content:"\0025cf  "}.lst-kix_z3z1tzvla6e6-4>li:before{content:"\0025cb  "}.lst-kix_bsmj4x93xtiv-0>li:before{content:"-  "}.lst-kix_lt6ovg7vgtck-7>li:before{content:"-  "}.lst-kix_lt6ovg7vgtck-8>li:before{content:"-  "}.lst-kix_z3z1tzvla6e6-2>li:before{content:"\0025a0  "}.lst-kix_z3z1tzvla6e6-7>li:before{content:"\0025cb  "}.lst-kix_z3z1tzvla6e6-8>li:before{content:"\0025a0  "}ul.lst-kix_ozsjlvi4x573-0{list-style-type:none}.lst-kix_z3z1tzvla6e6-5>li:before{content:"\0025a0  "}.lst-kix_z3z1tzvla6e6-6>li:before{content:"\0025cf  "}.lst-kix_8hsxmcrcwgbf-0>li:before{content:"\0025cf  "}.lst-kix_8hsxmcrcwgbf-1>li:before{content:"\0025cb  "}ul.lst-kix_ozsjlvi4x573-4{list-style-type:none}.lst-kix_8hsxmcrcwgbf-3>li:before{content:"\0025cf  "}ul.lst-kix_ozsjlvi4x573-3{list-style-type:none}ul.lst-kix_ozsjlvi4x573-2{list-style-type:none}.lst-kix_8hsxmcrcwgbf-2>li:before{content:"\0025a0  "}.lst-kix_8hsxmcrcwgbf-4>li:before{content:"\0025cb  "}ul.lst-kix_ozsjlvi4x573-1{list-style-type:none}ul.lst-kix_ozsjlvi4x573-8{list-style-type:none}ul.lst-kix_ozsjlvi4x573-7{list-style-type:none}ul.lst-kix_ozsjlvi4x573-6{list-style-type:none}ul.lst-kix_ozsjlvi4x573-5{list-style-type:none}ul.lst-kix_q7mqkdsqzfdu-2{list-style-type:none}ul.lst-kix_q7mqkdsqzfdu-1{list-style-type:none}ul.lst-kix_q7mqkdsqzfdu-0{list-style-type:none}ul.lst-kix_nmzc4rav7vza-8{list-style-type:none}ul.lst-kix_nmzc4rav7vza-0{list-style-type:none}ul.lst-kix_nmzc4rav7vza-1{list-style-type:none}ul.lst-kix_nmzc4rav7vza-2{list-style-type:none}ul.lst-kix_nmzc4rav7vza-3{list-style-type:none}ul.lst-kix_nmzc4rav7vza-4{list-style-type:none}ul.lst-kix_nmzc4rav7vza-5{list-style-type:none}ul.lst-kix_nmzc4rav7vza-6{list-style-type:none}ul.lst-kix_nmzc4rav7vza-7{list-style-type:none}ul.lst-kix_8hsxmcrcwgbf-6{list-style-type:none}ul.lst-kix_8hsxmcrcwgbf-5{list-style-type:none}ul.lst-kix_8hsxmcrcwgbf-8{list-style-type:none}ul.lst-kix_8hsxmcrcwgbf-7{list-style-type:none}ul.lst-kix_8hsxmcrcwgbf-2{list-style-type:none}ul.lst-kix_8hsxmcrcwgbf-1{list-style-type:none}ul.lst-kix_8hsxmcrcwgbf-4{list-style-type:none}ul.lst-kix_8hsxmcrcwgbf-3{list-style-type:none}ul.lst-kix_q7mqkdsqzfdu-6{list-style-type:none}ul.lst-kix_q7mqkdsqzfdu-5{list-style-type:none}ul.lst-kix_q7mqkdsqzfdu-4{list-style-type:none}ul.lst-kix_q7mqkdsqzfdu-3{list-style-type:none}ul.lst-kix_q7mqkdsqzfdu-8{list-style-type:none}ul.lst-kix_q7mqkdsqzfdu-7{list-style-type:none}ul.lst-kix_8hsxmcrcwgbf-0{list-style-type:none}.lst-kix_q7mqkdsqzfdu-8>li:before{content:"\0025a0  "}.lst-kix_ozsjlvi4x573-2>li:before{content:"\0025a0  "}.lst-kix_q7mqkdsqzfdu-6>li:before{content:"\0025cf  "}.lst-kix_q4c96w6aejbw-8>li:before{content:"\0025a0  "}.lst-kix_q7mqkdsqzfdu-7>li:before{content:"\0025cb  "}.lst-kix_q4c96w6aejbw-7>li:before{content:"\0025cb  "}.lst-kix_ozsjlvi4x573-3>li:before{content:"\0025cf  "}.lst-kix_ozsjlvi4x573-6>li:before{content:"\0025cf  "}.lst-kix_ozsjlvi4x573-4>li:before{content:"\0025cb  "}.lst-kix_q7mqkdsqzfdu-1>li:before{content:"\0025cb  "}.lst-kix_ozsjlvi4x573-5>li:before{content:"\0025a0  "}.lst-kix_q4c96w6aejbw-2>li:before{content:"\0025a0  "}.lst-kix_q7mqkdsqzfdu-2>li:before{content:"\0025a0  "}.lst-kix_q4c96w6aejbw-4>li:before{content:"\0025cb  "}.lst-kix_q7mqkdsqzfdu-3>li:before{content:"\0025cf  "}.lst-kix_q4c96w6aejbw-3>li:before{content:"\0025cf  "}.lst-kix_ozsjlvi4x573-7>li:before{content:"\0025cb  "}.lst-kix_q7mqkdsqzfdu-4>li:before{content:"\0025cb  "}.lst-kix_q4c96w6aejbw-6>li:before{content:"\0025cf  "}.lst-kix_ozsjlvi4x573-8>li:before{content:"\0025a0  "}.lst-kix_q7mqkdsqzfdu-5>li:before{content:"\0025a0  "}.lst-kix_q4c96w6aejbw-5>li:before{content:"\0025a0  "}ul.lst-kix_597z9mq2fg8h-1{list-style-type:none}ul.lst-kix_597z9mq2fg8h-0{list-style-type:none}ul.lst-kix_597z9mq2fg8h-3{list-style-type:none}ul.lst-kix_597z9mq2fg8h-2{list-style-type:none}ul.lst-kix_bsmj4x93xtiv-2{list-style-type:none}ul.lst-kix_bsmj4x93xtiv-3{list-style-type:none}ul.lst-kix_bsmj4x93xtiv-0{list-style-type:none}ul.lst-kix_bsmj4x93xtiv-1{list-style-type:none}ul.lst-kix_bsmj4x93xtiv-6{list-style-type:none}ul.lst-kix_bsmj4x93xtiv-7{list-style-type:none}ul.lst-kix_bsmj4x93xtiv-4{list-style-type:none}ul.lst-kix_bsmj4x93xtiv-5{list-style-type:none}.lst-kix_q4c96w6aejbw-1>li:before{content:"\0025cb  "}ul.lst-kix_bsmj4x93xtiv-8{list-style-type:none}.lst-kix_q7mqkdsqzfdu-0>li:before{content:"\0025cf  "}.lst-kix_q4c96w6aejbw-0>li:before{content:"\0025cf  "}ul.lst-kix_597z9mq2fg8h-8{list-style-type:none}ul.lst-kix_597z9mq2fg8h-5{list-style-type:none}ul.lst-kix_597z9mq2fg8h-4{list-style-type:none}ul.lst-kix_597z9mq2fg8h-7{list-style-type:none}ul.lst-kix_597z9mq2fg8h-6{list-style-type:none}ul.lst-kix_lt6ovg7vgtck-4{list-style-type:none}.lst-kix_nmzc4rav7vza-4>li:before{content:"\0025cb  "}ul.lst-kix_z3z1tzvla6e6-8{list-style-type:none}.lst-kix_597z9mq2fg8h-3>li:before{content:"\0025cf  "}ul.lst-kix_lt6ovg7vgtck-3{list-style-type:none}ul.lst-kix_z3z1tzvla6e6-7{list-style-type:none}.lst-kix_jas2zdq3af60-6>li:before{content:"\0025cf  "}.lst-kix_jas2zdq3af60-7>li:before{content:"\0025cb  "}ul.lst-kix_lt6ovg7vgtck-6{list-style-type:none}.lst-kix_597z9mq2fg8h-2>li:before{content:"\0025a0  "}.lst-kix_597z9mq2fg8h-4>li:before{content:"\0025cb  "}ul.lst-kix_lt6ovg7vgtck-5{list-style-type:none}ul.lst-kix_lt6ovg7vgtck-8{list-style-type:none}.lst-kix_597z9mq2fg8h-1>li:before{content:"\0025cb  "}.lst-kix_597z9mq2fg8h-5>li:before{content:"\0025a0  "}ul.lst-kix_lt6ovg7vgtck-7{list-style-type:none}.lst-kix_jas2zdq3af60-4>li:before{content:"\0025cb  "}.lst-kix_jas2zdq3af60-5>li:before{content:"\0025a0  "}.lst-kix_jas2zdq3af60-8>li:before{content:"\0025a0  "}.lst-kix_nmzc4rav7vza-3>li:before{content:"\0025cf  "}ul.lst-kix_jas2zdq3af60-8{list-style-type:none}.lst-kix_nmzc4rav7vza-7>li:before{content:"\0025cb  "}ul.lst-kix_z3z1tzvla6e6-0{list-style-type:none}.lst-kix_597z9mq2fg8h-7>li:before{content:"\0025cb  "}ul.lst-kix_jas2zdq3af60-6{list-style-type:none}ul.lst-kix_jas2zdq3af60-7{list-style-type:none}ul.lst-kix_z3z1tzvla6e6-2{list-style-type:none}.lst-kix_597z9mq2fg8h-0>li:before{content:"\0025cf  "}.lst-kix_597z9mq2fg8h-6>li:before{content:"\0025cf  "}.lst-kix_597z9mq2fg8h-8>li:before{content:"\0025a0  "}ul.lst-kix_jas2zdq3af60-4{list-style-type:none}.lst-kix_nmzc4rav7vza-6>li:before{content:"\0025cf  "}ul.lst-kix_z3z1tzvla6e6-1{list-style-type:none}ul.lst-kix_jas2zdq3af60-5{list-style-type:none}ul.lst-kix_lt6ovg7vgtck-0{list-style-type:none}ul.lst-kix_z3z1tzvla6e6-4{list-style-type:none}ul.lst-kix_jas2zdq3af60-2{list-style-type:none}ul.lst-kix_z3z1tzvla6e6-3{list-style-type:none}ul.lst-kix_jas2zdq3af60-3{list-style-type:none}ul.lst-kix_lt6ovg7vgtck-2{list-style-type:none}.lst-kix_nmzc4rav7vza-5>li:before{content:"\0025a0  "}ul.lst-kix_z3z1tzvla6e6-6{list-style-type:none}ul.lst-kix_jas2zdq3af60-0{list-style-type:none}ul.lst-kix_lt6ovg7vgtck-1{list-style-type:none}ul.lst-kix_z3z1tzvla6e6-5{list-style-type:none}ul.lst-kix_jas2zdq3af60-1{list-style-type:none}.lst-kix_jas2zdq3af60-0>li:before{content:"\0025cf  "}.lst-kix_jas2zdq3af60-1>li:before{content:"\0025cb  "}ul.lst-kix_q4c96w6aejbw-1{list-style-type:none}ul.lst-kix_q4c96w6aejbw-0{list-style-type:none}.lst-kix_nmzc4rav7vza-0>li:before{content:"\0025cf  "}.lst-kix_jas2zdq3af60-2>li:before{content:"\0025a0  "}.lst-kix_jas2zdq3af60-3>li:before{content:"\0025cf  "}.lst-kix_nmzc4rav7vza-2>li:before{content:"\0025a0  "}.lst-kix_nmzc4rav7vza-1>li:before{content:"\0025cb  "}.lst-kix_lt6ovg7vgtck-6>li:before{content:"-  "}.lst-kix_lt6ovg7vgtck-5>li:before{content:"-  "}.lst-kix_bsmj4x93xtiv-2>li:before{content:"-  "}.lst-kix_bsmj4x93xtiv-4>li:before{content:"-  "}.lst-kix_bsmj4x93xtiv-1>li:before{content:"-  "}.lst-kix_bsmj4x93xtiv-5>li:before{content:"-  "}.lst-kix_lt6ovg7vgtck-2>li:before{content:"-  "}ul.lst-kix_q4c96w6aejbw-3{list-style-type:none}ul.lst-kix_q4c96w6aejbw-2{list-style-type:none}.lst-kix_lt6ovg7vgtck-3>li:before{content:"-  "}ul.lst-kix_q4c96w6aejbw-5{list-style-type:none}ul.lst-kix_q4c96w6aejbw-4{list-style-type:none}.lst-kix_lt6ovg7vgtck-4>li:before{content:"-  "}ul.lst-kix_q4c96w6aejbw-7{list-style-type:none}ul.lst-kix_q4c96w6aejbw-6{list-style-type:none}ul.lst-kix_q4c96w6aejbw-8{list-style-type:none}.lst-kix_bsmj4x93xtiv-3>li:before{content:"-  "}.lst-kix_lt6ovg7vgtck-1>li:before{content:"-  "}.lst-kix_nmzc4rav7vza-8>li:before{content:"\0025a0  "}.lst-kix_bsmj4x93xtiv-6>li:before{content:"-  "}.lst-kix_bsmj4x93xtiv-8>li:before{content:"-  "}.lst-kix_lt6ovg7vgtck-0>li:before{content:"-  "}.lst-kix_ozsjlvi4x573-0>li:before{content:"\0025cf  "}.lst-kix_ozsjlvi4x573-1>li:before{content:"\0025cb  "}.lst-kix_bsmj4x93xtiv-7>li:before{content:"-  "}ol{margin:0;padding:0}table td,table th{padding:0}.c6{padding-top:6pt;text-indent:36pt;padding-bottom:6pt;line-height:1.5;orphans:2;widows:2}.c7{padding-top:6pt;padding-bottom:6pt;line-height:1.5;orphans:2;widows:2}.c3{orphans:2;text-indent:38pt;widows:2;text-align:justify;height:12pt}.c11{orphans:2;text-indent:38pt;widows:2;text-align:left}.c13{orphans:2;text-indent:38pt;widows:2;height:12pt}.c16{orphans:2;text-indent:38pt;widows:2}.c12{orphans:2;text-indent:36pt;widows:2}.c45{background-color:#ffffff;max-width:820.3pt;padding:72pt 7.4pt 72pt 14.2pt}.c34{color:inherit;text-decoration:inherit}.c0{font-weight:bold;font-family:"Verdana"}.c28{padding:0;margin:0}.c51{margin-left:14.2pt;margin-right:21pt}.c44{margin-left:-43.5pt;margin-right:-43.5pt}.c22{color:#1155cc;text-decoration:underline}.c9{font-size:12pt;color:#990055}.c43{margin-left:288pt;text-align:left}.c17{orphans:2;widows:2}.c46{color:#d3d3d3}.c27{margin-left:180pt}.c29{margin-left:72pt}.c52{text-decoration:underline}.c4{font-family:"Verdana"}.c26{padding-left:0pt}.c38{text-align:center}.c14{font-size:12pt}.c36{color:#a67f59}.c49{text-align:left}.c32{font-style:italic}.c21{color:#0077aa}.c5{color:#669900}.c20{margin-left:108pt}.c25{height:12pt}.c48{color:#45b2fb}.c8{color:#999999}.c33{page-break-after:avoid}.c35{color:#0000ff}.c10{color:#990055}.c37{margin-left:252pt}.c50{text-align:right}.c2{color:#708090}.c31{text-decoration:line-through}.c47{text-indent:2pt}.c30{background-color:#f5f2f0}.c15{color:#d6876d}.c40{text-indent:38pt}.c19{margin-left:36pt}.c41{height:20pt}.c1{font-weight:bold}.c24{margin-left:144pt}.c42{padding-bottom:4pt}.c23{margin-left:216pt}.c39{font-size:14pt}.c18{text-align:justify}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:justify}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:justify}li{color:#000000;font-size:12pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:12pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:justify}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:justify}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:justify}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:justify}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:justify}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:justify}</style></head><body class="c45"><p class="c17 c33 title" id="h.aef895pm72m1"><span>&nbsp;Fear the walking web Docs&amp;Demos</span></p><p class="c17 c25 c33 title" id="h.aef895pm72m1-1"><span></span></p><h1 class="c16 c33 c18" id="h.42o1rfpxnx5b"><span>1: Pr&eacute;sentation:</span></h1><p class="c17 c25"><span></span></p><p class="c17 c25"><span></span></p><p class="c16 c18"><span class="c14">&ldquo;</span><span class="c14 c1">Fear the walking web - flesh and bones</span><span class="c14">&rdquo; est une biblioth&egrave;que javascript pour vous aider a r&eacute;aliser des applications HTML5 en permettant </span><span class="c14 c1">une s&eacute;paration nette entre le code de pr&eacute;sentation HTML et les donn&eacute;es de votre application</span><span class="c14">. &nbsp; &nbsp;Chaque fois que vous avez besoin d&rsquo;afficher des donn&eacute;es provenant d&rsquo;objets javascript (provenant d&rsquo;un service web, d&rsquo;une base de donn&eacute;es ou charg&eacute; via JSon&hellip;) FTW2 peut vous aider &agrave; l&#39;impl&eacute;menter de </span><span class="c14 c1">fa&ccedil;on simple et maintenable</span><span class="c14">.</span></p><p class="c3"><span class="c14"></span></p><h3 class="c16 c33 c18" id="h.62guuffid88q"><span>Les concepts cl&eacute;s de FTW2 sont:</span></h3><p class="c16 c18"><span class="c14">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c14 c15 c1">D&eacute;claratif:</span><span class="c14">&nbsp;les Data-binding sont renseign&eacute;s </span><span class="c14 c1">uniquement dans le code html </span><span class="c14">(a la fa&ccedil;on de XAML, pour ceux qui connaissent), gr&acirc;ce &agrave; une syntaxe simple et comportant peu de mots cl&eacute;s. Les templates pour afficher des objets complets ou des tableaux (appel&eacute;s ici &ldquo;presenter&rdquo; ou &ldquo;item-presenter&rdquo;) sont aussi d&eacute;clar&eacute;s dans la page HTML. </span></p><p class="c16 c18"><span class="c14">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c14 c15 c1">R&eacute;utilise l&rsquo;existant</span><span class="c14">: permet de r&eacute;utiliser au maximum les codes m&eacute;tiers existants sans avoir a (trop) le modifier, </span></p><p class="c16 c18"><span class="c14">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c14 c15 c1">Invisible</span><span class="c14">: aucune API (ou presque), il suffit de lier le fichier javascript et &ccedil;a marche!</span><span class="c14 c1">&nbsp;Pas de d&rsquo;API &agrave; apprendre, pas de fonctions &agrave; appeler</span><span class="c14">!</span></p><p class="c16 c18"><span class="c14">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c14 c15 c1">Stand-alone</span><span class="c14">:</span><span class="c14">&nbsp;FTW&sup2; est </span><span class="c14 c1">VanilliaJS:</span><span class="c14">&nbsp;pas besoin de biblioth&egrave;que tierce pour fonctionner, et fonctionne sur la plus part des navigateurs (en-th&eacute;orie, en-core en test;).</span></p><p class="c3"><span class="c14"></span></p><p class="c3"><span class="c14"></span></p><p class="c17 c25 c18"><span class="c14 c32 c1"></span></p><p class="c17 c25 c18"><span class="c14"></span></p><p class="c17 c25 c18"><span class="c14"></span></p><p class="c17 c25 c18"><span class="c14"></span></p><p class="c17 c18"><span class="c14 c15 c1">Licence:</span></p><p class="c17 c18"><span class="c14 c15 c1">&quot;THE BEER-WARE LICENSE&quot; (Revision 42):</span></p><p class="c17 c18"><span class="c14 c32 c48 c1">&lt;steph.ponteins@gmail.com&gt;</span><span class="c14">&nbsp;wrote this file. As long as you retain this notice you can do whatever you want with this stuff. If we meet some day, and you think this stuff is worth it, you can buy me a beer in return.</span></p><p class="c17 c25 c18"><span class="c14"></span></p><p class="c17 c25 c18"><span class="c14"></span></p><p class="c17 c25 c18"><span></span></p><p class="c17 c25 c18"><span></span></p><p class="c17 c25 c18"><span class="c14"></span></p><p class="c17 c25 c18"><span class="c14"></span></p><p class="c17 c50"><span class="c14 c15 c1">Merci d&#39;avoir t&eacute;l&eacute;charger FTW&sup2;!</span></p><h1 class="c12 c33 c18 c41" id="h.t0g6rr353wcw"><span></span></h1><h1 class="c12 c33 c41 c18" id="h.fcu8x4jqrjyi"><span></span></h1><h1 class="c12 c33 c41 c18" id="h.ncu7lyywd1dv"><span></span></h1><h1 class="c12 c33 c18" id="h.v732wey57gk8"><span>2: Version et Installation:</span></h1><p class="c17 c25"><span></span></p><h2 class="c17 c33" id="h.t9girc4qnzc8"><span class="c1">Version:</span></h2><p class="c12 c18"><span>&nbsp;</span><span class="c14">Actuellement, FTW&sup2; est en </span><span class="c14 c1">version 0.3</span><span class="c14">, il reste encore pas mal de travaille a faire dessus, notamment d&rsquo;optimisation de temps d&#39;ex&eacute;cution ou d&rsquo;utilisation de m&eacute;moire, mais les d&eacute;clarations de binding, les arguments&hellip; sont finalis&eacute;s, et je ferais mon possible pour que toute nouvelle version de &ldquo;Flesh and Bones&rdquo; reste </span><span class="c14 c1">r&eacute;tro-compatible.</span></p><p class="c17 c25 c18"><span></span></p><h2 class="c17 c33 c18" id="h.jysidvkq3fey"><span class="c1">Installation</span><span>:</span></h2><p class="c17"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>R&eacute;f&eacute;rencez simplement le fichier javascript dans votre code HTML:</span></p><p class="c7 c38 c44"><span class="c4 c8 c39">&lt;</span><span class="c4 c10 c39">script </span><span class="c4 c5 c39">src</span><span class="c4 c8 c39">=&quot;</span><span class="c4 c21 c39">fear-the-walking-web-flesh-and-bones.js</span><span class="c4 c8 c39">&quot;&gt;&lt;/</span><span class="c4 c10 c39">script</span><span class="c4 c8 c39">&gt;</span></p><p class="c17 c18"><span>en adaptant l&rsquo;attribut &ldquo;src&rdquo; pour correspondre &agrave; l&rsquo;endroit ou vous avez mis FTW&sup2;. </span></p><p class="c17 c25 c18"><span></span></p><p class="c17 c25 c18"><span></span></p><p class="c17 c25 c18"><span></span></p><p class="c17 c25 c18"><span></span></p><p class="c17 c25 c18"><span></span></p><p class="c17 c25 c18"><span></span></p><p class="c17 c25 c18"><span></span></p><h1 class="c12 c33 c18" id="h.kiyw6ngy0eu4"><span>3: Data-context</span></h1><p class="c17 c25"><span></span></p><p class="c12 c18"><span class="c14">Un </span><span class="c14 c1">data-context</span><span class="c14">&nbsp;(aussi appel&eacute; Model dans le pattern MVVM)</span><span class="c14 c31">&nbsp;est un </span><span class="c14 c31 c1">simple objet javascript </span><span class="c31">de port&eacute;e globale</span><span class="c14">&nbsp;qui servira de conteneur pour les donn&eacute;es a afficher dans l&rsquo;UI et les op&eacute;rations a effectuer dessus.</span></p><p class="c12 c18"><span class="c14">&nbsp;</span></p><p class="c12 c18"><span class="c1">MODIFICATION: </span><span>On doit d&eacute;shormais passer en param&egrave;tre </span><span class="c1">le nom du constructeur de votre contex</span><span>t, le framework se chargera de son initialisation. Le constructeur </span><span class="c1">NE DOIT PAS PRENDRE DE PARAM&Egrave;TRES.</span><span>&nbsp;Juste une affaire de go&ucirc;t. </span></p><p class="c12 c25 c18"><span class="c1"></span></p><p class="c12 c18"><span class="c14">Pour cr&eacute;er un data-context pour votre application, (en g&eacute;n&eacute;ral, se sera la premi&egrave;re chose a faire), cr&eacute;ez juste un objet javascript et </span><span class="c14 c1">d&eacute;clarez le dans la balise &lt;body&gt; de votre page HTML,</span><span>Le moteur de liaison de donn&eacute;es saura alors ou aller chercher les informations dont il a besoin pour cr&eacute;er l&#39;interface graphique.</span></p><p class="c12 c25 c18"><span class="c1"></span></p><p class="c12 c25 c18"><span></span></p><p class="c12 c25 c18"><span></span></p><p class="c7"><span class="c4 c2">&lt;!DOCTYPE html&gt;</span><span class="c4"><br></span><span class="c4 c8">&lt;</span><span class="c4 c10">head</span><span class="c4 c8">&gt;</span><span class="c4"><br> &nbsp;</span><span class="c4 c8">&lt;</span><span class="c4 c10">meta </span><span class="c4 c5">charset</span><span class="c4 c8">=&quot;</span><span class="c4 c21">utf-8</span><span class="c4 c8">&quot;&gt;</span><span class="c4"><br> &nbsp;</span><span class="c4 c8">&lt;</span><span class="c4 c10">title</span><span class="c4 c8">&gt;</span><span class="c4">Hello</span><span class="c4 c8">&lt;/</span><span class="c4 c10">title</span><span class="c4 c8">&gt;</span><span class="c4"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c4 c8">&lt;</span><span class="c4 c10">script </span><span class="c4 c5">src</span><span class="c4 c8">=&quot;</span><span class="c4 c21">fear-the-walking-web-flesh-and-bones.js</span><span class="c4 c8">&quot;&gt;&lt;/</span><span class="c4 c10">script</span><span class="c4 c8">&gt;</span><span class="c4"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c4 c8">&lt;</span><span class="c4 c10">script </span><span class="c4 c8">&gt;</span></p><p class="c6"><span class="c15 c1">var MyContext = {</span></p><p class="c12"><span class="c15 c1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//ici, les donn&eacute;es de mon application</span></p><p class="c12"><span class="c15 c1">};</span></p><p class="c6"><span class="c4 c8">&lt;/</span><span class="c4 c10">script</span><span class="c4 c8">&gt;</span><span class="c4"><br></span><span class="c4 c8">&lt;/</span><span class="c4 c10">head</span><span class="c4 c8">&gt;</span></p><p class="c7"><span class="c4 c8">&lt;</span><span class="c4 c10">body </span><span class="c4 c5">data-context</span><span class="c4 c8">=&quot;</span><span class="c15 c1">MyContext </span><span class="c4 c8">&quot;&gt;</span></p><p class="c7"><span class="c14">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;!-- </span><span class="c14 c5">mon UI ici!</span><span class="c14">&nbsp;</span><span>-- &gt;</span></p><p class="c17 c18"><span class="c14">&lt;/</span><span class="c4 c10">body</span><span class="c14">&gt;</span></p><p class="c12 c18"><span class="c14">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p class="c12 c18"><span>Ou, en passant le nom d&#39;un constructeur, et en laissant le framework l&#39;initialiser:</span></p><p class="c7"><span class="c4 c2">&lt;!DOCTYPE html&gt;</span><span class="c4"><br></span><span class="c4 c8">&lt;</span><span class="c4 c10">head</span><span class="c4 c8">&gt;</span><span class="c4"><br> &nbsp;</span><span class="c4 c8">&lt;</span><span class="c4 c10">meta </span><span class="c4 c5">charset</span><span class="c4 c8">=&quot;</span><span class="c4 c21">utf-8</span><span class="c4 c8">&quot;&gt;</span><span class="c4"><br> &nbsp;</span><span class="c4 c8">&lt;</span><span class="c4 c10">title</span><span class="c4 c8">&gt;</span><span class="c4">Hello</span><span class="c4 c8">&lt;/</span><span class="c4 c10">title</span><span class="c4 c8">&gt;</span><span class="c4"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c4 c8">&lt;</span><span class="c4 c10">script </span><span class="c4 c5">src</span><span class="c4 c8">=&quot;</span><span class="c4 c21">fear-the-walking-web-flesh-and-bones.js</span><span class="c4 c8">&quot;&gt;&lt;/</span><span class="c4 c10">script</span><span class="c4 c8">&gt;</span><span class="c4"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c4 c8">&lt;</span><span class="c4 c10">script </span><span class="c4 c8">&gt;</span></p><p class="c6"><span class="c15 c1">function </span><span class="c15 c1">MyContext () {</span></p><p class="c12"><span class="c15 c1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//ici, les donn&eacute;es de mon application</span></p><p class="c12"><span class="c15 c1">};</span></p><p class="c6"><span class="c4 c8">&lt;/</span><span class="c4 c10">script</span><span class="c4 c8">&gt;</span><span class="c4"><br></span><span class="c4 c8">&lt;/</span><span class="c4 c10">head</span><span class="c4 c8">&gt;</span></p><p class="c7"><span class="c4 c8">&lt;</span><span class="c4 c10">body </span><span class="c4 c5">data-context</span><span class="c4 c8">=&quot;</span><span class="c15 c1">MyContext </span><span class="c4 c8">&quot;&gt;</span></p><p class="c7"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;!-- </span><span class="c5">mon UI ici!</span><span>&nbsp;-- &gt;</span></p><p class="c17"><span>&lt;/</span><span class="c4 c10">body</span><span>&gt;</span></p><p class="c12 c25 c18"><span></span></p><p class="c12 c18"><span class="c1">Vous devez renseigner cet attribut, sinon un exception sera lev&eacute;e au lancement de la page</span><span class="c46">. </span></p><p class="c12 c25 c18"><span></span></p><p class="c12 c25 c18"><span></span></p><p class="c12 c25 c18"><span></span></p><p class="c12 c25 c18"><span></span></p><p class="c12 c25 c18"><span></span></p><p class="c12 c25 c18"><span></span></p><p class="c12 c25 c18"><span></span></p><h1 class="c12 c33 c18" id="h.evgd2ppzyq1i"><span>4: un simple Data-binding:</span></h1><p class="c17 c25"><span></span></p><p class="c17 c18"><span class="c14">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>la liaison de donn&eacute;es (binding) dans FTW&sup2; est </span><span class="c1">d&eacute;clarative</span><span>: on ne la renseigne que dans le fichier html sous la forme :</span></p><h2 class="c12 c33" id="h.or81kjq6ia8f"><span class="c1">{binding param&egrave;tre1:valeur param&egrave;tre2:valeur etc...}</span><span>.</span></h2><p class="c17 c25"><span></span></p><p class="c12 c18"><span>&nbsp;Le framework se chargera de faire les liaisons entre votre contexte de donn&eacute;es (ici, MyContext) et le ou les &eacute;l&eacute;ments HTML vis&eacute;s. Aucune modification des objets javascript n&#39;est n&eacute;cessaire, et </span><span class="c1">on peut lier autant de propri&eacute;t&eacute;s/attributs de l&#39;&eacute;l&eacute;ment html que voulu</span><span>.</span></p><p class="c17 c25 c18"><span></span></p><p class="c17 c25 c18"><span></span></p><p class="c17 c25 c18"><span></span></p><p class="c17 c25 c18"><span></span></p><p class="c17 c25 c18"><span></span></p><p class="c17 c18"><span class="c14">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c14 c1">Marquer un binding dans un </span><span class="c1">&eacute;l&eacute;ment</span><span class="c14 c1">&nbsp;HTML</span></p><p class="c17 c25 c18"><span class="c1"></span></p><p class="c16 c18"><span class="c14">On peut renseigner une liaison de donn&eacute;es de plusieurs fa&ccedil;on, et on peut ajouter autant de liaisons que l&#39;on veut dans un &eacute;l&eacute;ment HTML.</span></p><ul class="c28 lst-kix_jas2zdq3af60-0 start"><li class="c17 c26 c19"><span class="c14 c15 c1">&lt;a data-binded-href=&quot;{binding from:le_nom_de_ma_variable }&quot;&gt;</span><span class="c14">:</span><span>lie</span><span class="c14">&nbsp;la variable </span><span>&agrave;</span><span class="c14">&nbsp;l&#39;attribut href de l&#39;anchor. Cette notation permet de </span><span>lier </span><span class="c14">autant d&#39;attribut qu&#39;on le souhaite, mai</span><span>s une seule liaison par attribut/propri&eacute;t&eacute; est autoris&eacute;e</span><span class="c14">.</span></li><li class="c17 c26 c19"><span class="c14 c15 c1">&lt;span&gt;{binding from:le_nom_de_ma_variable }&lt;span&gt;</span><span class="c14">: un simple raccourcie </span><span>d&#39;&eacute;criture</span><span class="c14">&nbsp;pour &lt;span data-binded-textContent=&quot;</span><span>{binding from:le_nom_de_ma_variable }</span><span class="c14">&quot;&gt;</span></li><li class="c17 c26 c19"><span class="c14 c15 c1">&lt;span data-binded-class=&quot;uneClasse uneAutre {binding from:le_nom_de_ma_variable } uneDerniere&quot;&gt;&lt;span&gt;</span><span class="c14">: permet de faire un binding sur une class CSS. </span><span>Lors de la liaison, seule la partie {binding&hellip;.} sera remplac&eacute;e.</span></li></ul><p class="c17 c25"><span class="c14"></span></p><p class="c17 c25 c18"><span class="c14"></span></p><p class="c17 c25 c18"><span class="c14"></span></p><p class="c16 c18"><span class="c14 c1">Les diff&eacute;rents param&egrave;tres sont:</span></p><p class="c3"><span class="c14"></span></p><ul class="c28 lst-kix_597z9mq2fg8h-0 start"><li class="c17 c26 c19"><span class="c14 c15 c1">from</span><span class="c14">: Obligatoire, le nom de la propri&eacute;t&eacute; &agrave; lier &nbsp; </span><span class="c14 c32">-id&eacute;e: pouvoir mettre une URL pour mettre </span><span class="c32">a jour le binding via ajax?</span></li><li class="c17 c26 c19"><span class="c14 c15 c1">to</span><span class="c14">: optionnel, si renseign&eacute;, le nom de la propri&eacute;t&eacute; de l&#39;&eacute;l&eacute;ment HTML/attribut a lier (</span><span>reliquat</span><span class="c14">&nbsp;d</span><span>&rsquo;ancienne version)</span></li><li class="c17 c26 c19"><span class="c14 c15 c1">converter</span><span class="c14">: optionnel, si renseign&eacute;, une m&eacute;thode globale pour convertir la donn&eacute;e avant la liaison</span><span>, avec les arguments suivant:</span></li></ul><ul class="c28 lst-kix_597z9mq2fg8h-1 start"><li class="c17 c29 c26"><span class="c14">@param: value: la valeur a convertir</span></li><li class="c17 c29 c26"><span class="c14">@param converter_params: param&egrave;tres optionnels (array)</span></li></ul><ul class="c28 lst-kix_597z9mq2fg8h-0"><li class="c17 c26 c19"><span class="c14 c15 c1">converter_params</span><span class="c14">: optionnel, permet de passer des param&egrave;tres a la m&eacute;thode de conversion.</span></li><li class="c17 c26 c19"><span class="c14 c15 c1">fallback</span><span class="c14">: optionnel, si value==null, affichera le fallback a la place</span></li><li class="c17 c26 c19"><span class="c14 c15 c1">alt</span><span class="c14">: optionnel, exp&eacute;rimental, permet de lier ce binding a une autre cl&eacute; que celle de la propri&eacute;t&eacute;</span></li><li class="c17 c26 c19"><span class="c14 c15 c1">forceAttr</span><span class="c14">: optionnel, doit &ecirc;tre &eacute;gal a true. Si renseign&eacute;, forcera la liaison sur l&#39;attribut html plut&ocirc;t que la prop</span><span>ri&eacute;t&eacute;</span><span class="c14">&nbsp;de l&#39;objet</span></li></ul><p class="c17 c25 c18"><span class="c14"></span></p><p class="c17 c18"><span class="c14">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p class="c17 c25 c18"><span></span></p><p class="c17 c18"><span class="c1">Exemple: binding d&rsquo;une propri&eacute;t&eacute; simple:</span></p><p class="c17 c18"><span class="c35 c1">simple_binding</span><span class="c35 c1 c52"><a class="c34" href="https://www.google.com/url?q=http://exemples/simple_binding.html&amp;sa=D&amp;ust=1456995044983000&amp;usg=AFQjCNEn8Qtll2tHaG3twnSTyYuv6RxyPg">.html</a></span></p><p class="c17 c25 c18"><span></span></p><p class="c17 c25 c18"><span></span></p><p class="c7"><span class="c4 c2">&lt;!DOCTYPE html&gt;</span><span class="c4"><br></span><span class="c4 c8">&lt;</span><span class="c4 c10">head</span><span class="c4 c8">&gt;</span><span class="c4"><br> &nbsp;</span><span class="c4 c8">&lt;</span><span class="c4 c10">meta </span><span class="c4 c5">charset</span><span class="c4 c8">=&quot;</span><span class="c4 c21">utf-8</span><span class="c4 c8">&quot;&gt;</span><span class="c4"><br> &nbsp;</span><span class="c4 c8">&lt;</span><span class="c4 c10">title</span><span class="c4 c8">&gt;</span><span class="c4">Hello</span><span class="c4 c8">&lt;/</span><span class="c4 c10">title</span><span class="c4 c8">&gt;</span><span class="c4"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c4 c8">&lt;</span><span class="c4 c10">script </span><span class="c4 c5">src</span><span class="c4 c8">=&quot;</span><span class="c4 c21">fear-the-walking-web-flesh-and-bones.js</span><span class="c4 c8">&quot;&gt;&lt;/</span><span class="c4 c10">script</span><span class="c4 c8">&gt;</span><span class="c4"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c4 c8">&lt;</span><span class="c4 c10">script </span><span class="c4 c8">&gt;</span></p><p class="c6"><span class="c1">function </span><span class="c1">MyContext () {</span></p><p class="c6 c19"><span class="c15 c1">this.app_name = &ldquo;Ma super application&rdquo;;</span></p><p class="c12"><span class="c1">};</span></p><p class="c6"><span class="c4 c8">&lt;/</span><span class="c4 c10">script</span><span class="c4 c8">&gt;</span><span class="c4"><br></span><span class="c4 c8">&lt;/</span><span class="c4 c10">head</span><span class="c4 c8">&gt;</span></p><p class="c7"><span class="c4 c8">&lt;</span><span class="c4 c10">body </span><span class="c4 c5">data-context</span><span class="c4 c8">=&quot;</span><span class="c1">MyContext</span><span class="c15 c1">&nbsp;</span><span class="c4 c8">&quot;&gt;</span></p><p class="c7"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span class="c10">h1</span><span>&gt;</span><span class="c15 c1">{binding from:app_name}</span><span>&lt;/</span><span class="c10">h1</span><span>&gt;</span></p><p class="c17"><span>&lt;/</span><span class="c4 c10">body</span><span>&gt;</span></p><p class="c17 c25 c18"><span></span></p><p class="c17 c18"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;On cr&eacute;e une propri&eacute;t&eacute; &ldquo;app_name&rdquo; contenant le nom de notre application comme n&#39;importe quelle propri&eacute;t&eacute; javascript, et on demande l&rsquo;affichage dans la balise &lt;H1&gt; en utilisant la notation de FTW&sup2; en indiquant le nom de la propri&eacute;t&eacute; que l&rsquo;on veut afficher (param&egrave;tre FROM).</span></p><p class="c17 c25 c18"><span></span></p><p class="c17 c18"><span class="c1">Propri&eacute;t&eacute;s invisibles:</span></p><p class="c17 c18"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Parfois, vous pouvez avoir besoin de cr&eacute;er une propri&eacute;t&eacute; juste pour un usage interne, sans avoir besoin de l&rsquo;afficher dans l&rsquo;UI, ou vous voulez pouvoir contr&ocirc;ler sa valeur en cr&eacute;ant des getters et setters. Pour cr&eacute;er une propri&eacute;t&eacute; &ldquo;invisible&rdquo; pour FTW&sup2;, il suffit de faire d&eacute;buter le nom de la variable par un underscore (par exemple, _app_name), et elle sera superbement ignor&eacute;e par le framework!</span></p><p class="c17 c18"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Si vous cr&eacute;er des getters/setters pour cette propri&eacute;t&eacute;, vous pourrez alors lier ces derniers a votre UI:</span></p><p class="c17 c25 c18"><span></span></p><p class="c17 c25 c18"><span></span></p><p class="c6"><span class="c1">function MyContext () {</span></p><p class="c6 c19"><span class="c1">this.your</span><span class="c1">_name= &ldquo;St&eacute;phane&rdquo;,</span></p><p class="c6 c19"><span class="c1">this._invisble_shadow = 12</span><span class="c5 c1">&nbsp;;//on la rend invisible pour FTW&sup2;, on ne pourra pas l&rsquo;utiliser dans l&rsquo;UI</span></p><p class="c12"><span class="c1">};</span></p><p class="c12 c25"><span class="c1"></span></p><p class="c12"><span class="c5 c1">//on cr&eacute;e une property type getters setters pour _invisible_shadow, le nom de cette property -ici, hello- servira pour renseigner le param&egrave;tre from dans nos bindings</span></p><p class="c12 c25"><span class="c5 c1"></span></p><p class="c12"><span class="c1">MODIFICATION: </span><span>Pour &eacute;viter de surcharger la m&eacute;thode Object.defineProperty, la cr&eacute;ation de getter/setter dans FTW2 passe par une m&eacute;thode &quot;statique&quot; (comprenez, du prototype):</span></p><p class="c12"><span>&nbsp;</span><span class="c39">Nom_du_type.defineBindProperty( &quot;nom_de_la_property&quot;, prop_infos)</span></p><p class="c12 c25"><span></span></p><p class="c12 c25"><span></span></p><p class="c12"><span>dans notre exemple:</span></p><p class="c12"><span class="c1">MyContext.defineBindProperty(&rdquo;</span><span class="c21 c1">hello</span><span class="c1">&rdquo;,{</span></p><p class="c12"><span class="c1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;get: function(){return this._invisible_shadow + 1;},</span></p><p class="c12"><span class="c1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set: function(val){this._invisible_shadow = value;}</span></p><p class="c12"><span class="c1">});</span></p><p class="c12"><span class="c5 c1">//d&eacute;sormais, on peut lier la nouvelle propri&eacute;t&eacute; &ldquo;hello&rdquo; dans nos binding!</span></p><p class="c12"><span class="c1">&hellip;</span></p><p class="c12 c25"><span class="c1"></span></p><p class="c12"><span class="c1">&lt;h1&gt;{binding from:your_name }&lt;/h1&gt;</span></p><p class="c12"><span class="c1">&lt;h2&gt;vous avez: </span><span class="c15 c1">{binding from:hello}</span><span class="c1">&nbsp;ans&lt;/h2&gt;</span></p><p class="c17 c25 c18"><span></span></p><p class="c17 c18"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Pour r&eacute;sum&eacute;:</span></p><p class="c17 c18"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Toutes les propri&eacute;t&eacute;s &lsquo;simples&rsquo; de votre contexte de donn&eacute;es sont r&eacute;f&eacute;ren&ccedil;able dans les bindings par leur nom.</span></p><p class="c17 c18"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Toutes les property type getter/setter de votre contexte de donn&eacute;es sont r&eacute;f&eacute;ren&ccedil;able dans les bindings par leur nom</span></p><p class="c17 c18"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;une propri&eacute;t&eacute; dont le nom commence par un underscore dans votre contexte de donn&eacute;e est invisible et non r&eacute;f&eacute;ren&ccedil;able dans les bindings.</span></p><p class="c17 c25 c18"><span></span></p><p class="c17 c25 c18"><span></span></p><p class="c17 c25 c18"><span></span></p><p class="c17 c18 c51"><span class="c1">Exemple: convertir une donn&eacute;e avant affichage</span><span>:</span></p><p class="c17 c18"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p class="c17 c18"><span class="c1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>Un &ldquo;converter&rdquo; est une fonction de port&eacute;e globale qui sert a transformer la valeur d&rsquo;une propri&eacute;t&eacute; du contexte de donn&eacute;es en autre chose au moment de l&rsquo;afficher a l&rsquo;&eacute;cran. </span></p><p class="c17 c25 c18"><span></span></p><p class="c17 c18"><span class="c1">MODIFICATION</span><span>: un converter peut </span><span class="c1">aussi &ecirc;tre une m&eacute;thode du context global</span><span>&nbsp;si vous avez besoin, par exemple d&#39;acc&eacute;der &agrave; certaines donn&eacute;es. Je trouve personnellement que c&#39;est un mauvais choix, un converter &eacute;tant plut&ocirc;t pens&eacute; comme un bloc totalement autonome. Si vous avez besoin d&#39;acc&eacute;der &agrave; d&#39;autres donn&eacute;es, peut &ecirc;tre avez vous besoin d&#39;une autre propri&eacute;t&eacute;&hellip;</span></p><p class="c17 c18"><span class="c1">MODIFICATION 2</span><span>: le framework vient avec des</span><span class="c1">&nbsp;converters cr&eacute;&eacute;s par d&eacute;faut et r&eacute;utilisable dans votre code</span><span>&nbsp;(bon, pour l&#39;instant, il n&#39;y en a que 2!). Pour pouvoir les appeller dans vos bindings,</span><span class="c1">&nbsp;il faut faire pr&eacute;c&eacute;der leur nom par &quot;ftw2:&quot;</span></p><p class="c17 c25 c18"><span></span></p><p class="c17 c18"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">ftw2:is_true (value, params)</span><span>: renvoie true/false en fonction de value. On peut indiquer en param&egrave;tres un tableau de 2 valeurs, dans ce cas, la valeur retourn&eacute;e par la fonction sera: params[0] si value == false, params[1] sinon</span></p><p class="c17 c18"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">ftw2:localize_number (value, params)</span><span>: localise un nombre en fonction de la langue du navigateur. </span></p><p class="c12 c19 c18"><span>OPTIONNEL: params: un tableau d&#39;informations pour la convertion </span></p><p class="c17 c18"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;params[0]: le nombre de chiffres apr&egrave;s la virgule demand&eacute; (par d&eacute;faut, 2)</span></p><p class="c17 c18"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;params[1]: la locale dans laquelle convertir l&#39;&eacute;criture (par d&eacute;faut, la langue pr&eacute;f&eacute;r&eacute;e du navigateur)</span></p><p class="c17 c25 c18"><span></span></p><p class="c12 c18"><span>Par exemple, une fonction qui localiserait un float pour l&rsquo;affichage:</span></p><p class="c17 c18"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p class="c6"><span class="c1">function MyContext () {</span></p><p class="c6"><span class="c1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c5 c1">// la valeur a afficher dans l&rsquo;UI</span></p><p class="c6 c19"><span class="c1">this.</span><span class="c1">ma_valeur = 13.879, </span></p><p class="c7 c19"><span class="c1">};</span></p><p class="c7 c19"><span class="c1">function localize(value, params){</span></p><p class="c7 c29"><span class="c1">&nbsp;</span><span class="c5 c1">&nbsp;//remplace le point par une virgule</span></p><p class="c7 c29"><span class="c1">&nbsp; if (value == null) return &quot;&quot;;</span></p><p class="c7 c29"><span class="c1">return value.toLocaleString (&quot;fr-FR&quot;, {maximumFractionDigits:2, minimumFractionDigits:2});</span></p><p class="c7 c25 c19"><span class="c1"></span></p><p class="c7 c19"><span class="c1">}</span></p><p class="c7 c19"><span>Dans le html, on indique au binding d&rsquo;utiliser le converter pour l&rsquo;affichage;</span></p><p class="c7 c19"><span class="c1">&lt;</span><span class="c10 c1">h2</span><span class="c1">&gt;localis&eacute;e: {binding from:ma_valeur &nbsp;</span><span class="c15 c1">converter:localize</span><span class="c1">}&lt;/</span><span class="c10 c1">h2</span><span class="c1">&gt;</span></p><p class="c7 c25 c19"><span class="c1"></span></p><p class="c16"><span>Un &ldquo;converter&rdquo; prend en argument </span><span class="c1">la valeur du binding (@arg value)</span><span>, et </span><span class="c1">un tableau d&#39;arguments optionnels</span><span>. Il doit retourner une valeur (g&eacute;n&eacute;ralement sous forme de String) qui sera utilis&eacute;e par le binding lors de l&#39;affichage.</span></p><p class="c16"><span>Pour passer des arguments optionnels a un converter, il faut renseigner le param&egrave;tre </span><span class="c1">converter_params</span><span>&nbsp;dans le html. Les valeurs possibles sont:</span></p><ul class="c28 lst-kix_8hsxmcrcwgbf-0 start"><li class="c17 c26 c19"><span class="c1">converter_params:valeur</span><span>: renseigne 1 argument optionnel.</span></li><li class="c17 c26 c19"><span class="c1">converter_params:[liste,de,valeurs]</span><span>: renseigne des arguments optionnels. Ils seront pass&eacute;s sous forme de tableau au &ldquo;converter&rdquo;.</span></li><li class="c17 c26 c19"><span>Si une valeur est une </span><span class="c1">string avec des espaces</span><span>, l&#39;inclure dans des apostrophes</span></li><li class="c17 c26 c19"><span>Si on veut passer </span><span class="c1">la valeur d&#39;une propri&eacute;t&eacute; du context</span><span>, on fait pr&eacute;c&eacute;der le nom de la propri&eacute;t&eacute; par $. Si la propri&eacute;t&eacute; pass&eacute;e en param&egrave;tre change, le binding sera pr&eacute;venu et se mettra a jour aussi.</span></li></ul><p class="c17 c25 c18"><span></span></p><p class="c17 c18"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dans l&rsquo;exemple pr&eacute;c&eacute;dent, pour contr&ocirc;ler le nombre de chiffres apr&egrave;s la virgule, on transforme la fonction &ldquo;localize&rdquo;:</span></p><p class="c17 c25 c18"><span></span></p><p class="c17 c25 c18"><span></span></p><p class="c7 c19"><span class="c1">function localize(value, after_dot_count){</span></p><p class="c7 c29"><span class="c1">&nbsp;</span><span class="c5 c1">&nbsp;//remplace le point par une virgule</span></p><p class="c7 c29"><span class="c1">&nbsp; if (value == null) return &quot;&quot;;</span></p><p class="c7 c29"><span class="c1">after = after_dot_count || 2; </span><span class="c5 c1">//on garde 2 par d&eacute;faut</span></p><p class="c7 c29"><span class="c1">return value.toLocaleString (&quot;fr-FR&quot;, {maximumFractionDigits:after, minimumFractionDigits:after});</span></p><p class="c7 c19"><span class="c1">}</span></p><p class="c7 c19"><span>et on met a jour le binding:</span></p><p class="c7 c19"><span class="c5 c1">&lt;!-- ici, on affiche avec 2 chiffres apr&egrave;s la virgule --&gt;</span></p><p class="c7 c19"><span class="c1">&lt;</span><span class="c10 c1">h2</span><span class="c1">&gt;localis&eacute;e: {binding from:ma_valeur &nbsp;converter:localize}&lt;/</span><span class="c10 c1">h2</span><span class="c1">&gt;</span></p><p class="c7 c19"><span class="c5 c1">&lt;!-- ici, on en demande 3 --&gt;</span></p><p class="c7 c19"><span class="c1">&lt;</span><span class="c10 c1">h2</span><span class="c1">&gt;localis&eacute;e aussi: {binding from:ma_valeur &nbsp;converter:localize </span><span class="c15 c1">converter_params:3</span><span class="c1">}&lt;/</span><span class="c10 c1">h2</span><span class="c1">&gt;</span></p><p class="c6 c19"><span class="c32">On verra d&rsquo;autres utilisation des converters (notamment coupl&eacute;s avec des classes CSS) dans l&rsquo;application WoWS de d&eacute;monstration en fin de documentation.</span></p><p class="c7 c25 c19"><span class="c1"></span></p><p class="c17 c25 c18"><span></span></p><p class="c17 c25 c18"><span></span></p><p class="c17 c25 c18"><span></span></p><p class="c17 c18"><span class="c1">Exemple: g&eacute;rer le cas NULL</span><span>:</span></p><p class="c12 c25 c18"><span></span></p><p class="c12 c18"><span>Si une de vos valeurs est null ou undefined, on peut demander a afficher une valeur par d&eacute;faut en renseignant le param&egrave;tre </span><span class="c1">fallback</span><span>. Par exemple, on veut que si la propri&eacute;t&eacute; &ldquo;your_name&rdquo; du data-context est nulle, on affiche le message &ldquo;Oups, vous &ecirc;tes un inconnu&hellip;&rdquo;, on modifiera alors le binding:</span></p><p class="c12 c25 c18"><span></span></p><p class="c17"><span class="c1">&lt;h1&gt;{binding from:your_name </span><span class="c15 c1">fallback:&rsquo;Oups, vous &ecirc;tes un inconnu&hellip;&rsquo; </span><span class="c1">}&lt;/h1&gt;</span></p><p class="c17 c25"><span class="c1"></span></p><p class="c12 c18"><span>Si vous cliquez sur le lien </span><span class="c21">&ldquo;Fallback: met le nom a null!&rdquo;</span><span>&nbsp;dans la page d&rsquo;exemple, vous devriez voir appara&icirc;tre le message d&rsquo;erreur.</span></p><p class="c12 c18"><span class="c1">Notez que si la valeur du fallback comporte des espaces, &nbsp;vous devez l&rsquo;inclure dans des apostrophes.</span></p><p class="c17 c25 c18"><span></span></p><p class="c17 c25 c18"><span></span></p><p class="c17 c18"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c32">On verra ,dans l&rsquo;application WoWS de d&eacute;monstration en fin de documentation, l&rsquo;utilisation du param&egrave;tre &ldquo;alt&rdquo;, ou le binding de plusieurs attributs/propri&eacute;t&eacute;s d&rsquo;&eacute;l&eacute;ment HTML dans une application real-world.</span></p><p class="c7 c19"><span class="c1">alt: r&eacute;agir a d&#39;autres cl&eacute;s de binding</span></p><p class="c7 c19 c47"><span class="c1">EXPERIMENTAL. </span><span>Parfois, il peut etre utile de &#39;lier&#39; des donn&eacute;es entre elles, ou de mettre a jour une donn&eacute;e en fonction d&#39;une autre. Tous les bindings ont un param&egrave;tre </span><span class="c1">alt:name1,name2,name3</span><span>...</span><span>&nbsp;pour permettre cette liaison, ou name1,name2... correspondent aux nom des propri&eacute;t&eacute; </span><span>du contexte courant de donn&eacute;es</span><span>&nbsp;auxquelles on veut que le binding r&eacute;agisse en plus de la propri&eacute;t&eacute; indiqu&eacute;e dans le &#39;from&#39;.</span></p><h1 class="c17 c33 c41" id="h.sy2d0sy4usva"><span></span></h1><h1 class="c12 c33" id="h.2pvcx5o8wr58"><span>5: Data-binding d&rsquo;objets et presenters:</span></h1><p class="c17"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exemples: </span><span class="c22"><a class="c34" href="https://www.google.com/url?q=http://exemples/presenters.html&amp;sa=D&amp;ust=1456995045019000&amp;usg=AFQjCNHqZZvp9CV0zeYSmHj_nnuGDj10FQ">presenters.html</a></span></p><p class="c17 c25"><span></span></p><p class="c17 c25"><span></span></p><p class="c12"><span>Lorsqu&#39;on veut lier un objet dans FTW&sup2;, il faut auparavant cr&eacute;er un </span><span class="c1">presenter</span><span>, une sorte de template d&#39;affichage pour les propri&eacute;t&eacute; de l&rsquo;objet. Ceux ci se d&eacute;finissent directement dans le fichier HTML.</span></p><p class="c12 c25"><span></span></p><ul class="c28 lst-kix_z3z1tzvla6e6-0 start"><li class="c17 c26 c19"><span>Directement sous la balise &lt;</span><span class="c10 c1">BODY</span><span>&gt;, on cr&eacute;e </span><span class="c1">un conteneur a presenters</span><span>&nbsp;(un div avec un </span><span class="c1">data-role=presenters</span><span>)</span></li><li class="c17 c26 c19"><span>Chaque childs de ce conteneur repr&eacute;sente un presenter particulier. un presenter </span><span class="c1">doit avoir un id unique</span><span>&nbsp;et renseigner l&#39;attribut </span><span class="c1">data-role=presenter</span></li><li class="c17 c26 c19"><span>Chaque childs de ce presenter repr&eacute;sente un </span><span class="c1">data-type</span><span>&nbsp;particulier, le firstChild &eacute;tant le type par d&eacute;faut, n&#39;a pas besoin de pr&eacute;ciser le type</span></li><li class="c17 c26 c19"><span>A l&#39;int&eacute;rieur d&#39;un presenter, </span><span class="c1">le contexte de donn&eacute;es change</span><span>. Il devient l&#39;objet qui est li&eacute; , rendant accessible directement les propri&eacute;t&eacute; de l&#39;objet pour le binding.</span></li></ul><p class="c17 c25 c18"><span></span></p><p class="c17 c25 c18"><span class="c14"></span></p><p class="c16 c18"><span class="c14">Les </span><span>diff&eacute;rents</span><span class="c14">&nbsp;</span><span>param&egrave;tres</span><span class="c14">&nbsp;sont:</span></p><p class="c3"><span class="c14"></span></p><ul class="c28 lst-kix_597z9mq2fg8h-0"><li class="c17 c26 c19"><span class="c14 c15 c1">from</span><span class="c14">: Obligatoire, le nom de la propri&eacute;t&eacute; &agrave; lier</span></li><li class="c17 c26 c19"><span class="c14 c15 c1">presenter</span><span class="c14">: Obligatoire, l&rsquo;identifiant d&rsquo;un </span><span>&eacute;l&eacute;ment HTML </span><span class="c14">a utiliser pour afficher les informations de l&rsquo;objet.</span></li><li class="c17 c26 c19"><span class="c14 c15 c1">converter</span><span class="c14">: optionnel, si renseign&eacute;, une m&eacute;thode globale pour convertir la donn&eacute;e avant la liaison.</span></li></ul><ul class="c28 lst-kix_597z9mq2fg8h-1 start"><li class="c17 c29 c26"><span class="c14">@param: value: la valeur a convertir</span></li><li class="c17 c26 c29"><span class="c14">@param converter_params: param&egrave;tres optionnels</span></li></ul><ul class="c28 lst-kix_597z9mq2fg8h-0"><li class="c17 c26 c19"><span class="c14 c15 c1">converter_params</span><span class="c14">: optionnel, permet de passer des param&egrave;tres a la m&eacute;thode de conversion.</span></li><li class="c17 c26 c19"><span class="c14 c15 c1">fallback</span><span class="c14">: optionnel, si value==null, id du div presenter a afficher a la place</span></li><li class="c17 c26 c19"><span class="c14 c15 c1">alt</span><span class="c14">: optionnel, exp&eacute;rimental, permet de lier ce binding a une autre cl&eacute; que celle de la propri&eacute;t&eacute;</span></li><li class="c17 c26 c19"><span class="c14 c15 c1">deep</span><span class="c14">: optionnel, doit </span><span>&ecirc;tre</span><span class="c14">&nbsp;</span><span>false. Emp&ecirc;che de cr&eacute;er les liaisons de donn&eacute;es pour les propri&eacute;t&eacute;s internes de l&rsquo;objet. (ie, on peut afficher les propri&eacute;t&eacute;s de l&rsquo;objet, mais on ne souhaite pas &ecirc;tre notifier de leurs changement). Par d&eacute;faut true= si une propri&eacute;t&eacute; interne de l&rsquo;objet est modifi&eacute;, le framework mettra a jour le binding.</span></li></ul><p class="c3"><span class="c1"></span></p><p class="c3"><span class="c1"></span></p><p class="c3"><span class="c1"></span></p><p class="c16 c18"><span>Pour illustrer l&rsquo;utilisation des &ldquo;presenters&rdquo;, on va afficher des informations sur un &lsquo;client&rsquo; (un &nbsp;nom, pr&eacute;nom, sexe) dans une page HTML.</span></p><p class="c16 c18"><span>On commence par cr&eacute;er en javascript un data-context et une classe Client pour regrouper nos informations:</span></p><p class="c3"><span></span></p><p class="c16 c18"><span class="c1">function Client(n,p,s){</span></p><p class="c16 c18"><span class="c1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c5 c1">//on initialise les informations de notre client...</span></p><p class="c16 c18"><span class="c1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.nom = n;</span></p><p class="c16 c18"><span class="c1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.prenom = p;</span></p><p class="c16 c18"><span class="c1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.sexe = s;</span></p><p class="c17 c18"><span class="c1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p><p class="c17 c18"><span class="c1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function MyContext () {</span></p><p class="c17 c18"><span class="c1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c5 c1">//on cr&eacute;e un client pour pouvoir tester les presenters&hellip;.</span></p><p class="c12 c19 c18"><span class="c1">this.</span><span class="c1">client1 = new Client(&ldquo;PONTEINS&rdquo;,&rdquo;St&eacute;phane&rdquo;,&rdquo;M&rdquo;),</span></p><p class="c12 c19 c18"><span class="c1">this.client2= new Client(&ldquo;PITT&rdquo;,&rdquo;Bebert&rdquo;,&rdquo;M&rdquo;)</span></p><p class="c17 c18"><span class="c1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</span></p><p class="c17 c25 c18"><span></span></p><p class="c17 c18"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dans notre HTML, on renseigne le contexte de donn&eacute;es dans la balise &lt;</span><span class="c10">BODY</span><span>&gt; et on ajoute notre template pour afficher les donn&eacute;es de notre client et le binding pour l&rsquo;afficher:</span></p><p class="c17 c18"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p class="c17 c18"><span class="c4 c8">&lt;</span><span class="c4 c10">body </span><span class="c4 c5">data-context</span><span class="c4 c8">=&quot;</span><span class="c1">MyContext</span><span class="c15 c1">&nbsp;</span><span class="c4 c8">&quot;&gt;</span></p><p class="c17 c18"><span class="c4 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;!-- le conteneur pour les presenters --&gt;</span></p><p class="c17 c18"><span class="c4 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span class="c4 c10">div</span><span class="c4 c8">&nbsp;</span><span class="c4 c5">data-role</span><span class="c4 c8">=&rdquo;presenters&rdquo;&gt;</span></p><p class="c17 c25 c18"><span class="c4 c8"></span></p><p class="c17 c18"><span class="c4 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;!-- le presenter pour afficher les donn&eacute;es d&rsquo;un client </span></p><p class="c17 c18"><span class="c4 c8">habituellement, j&rsquo;utilise un div, mais n&rsquo;importe quel &eacute;l&eacute;ment peut faire l&rsquo;affaire, la seule restriction est qu&rsquo;il ne peut pas &ecirc;tre lui m&ecirc;me la cible d&rsquo;un binding-- &gt;</span></p><p class="c17 c25 c18"><span class="c4 c8"></span></p><p class="c17 c18"><span class="c4 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span class="c4 c10">div</span><span class="c4 c8">&nbsp;</span><span class="c4 c5">id</span><span class="c4 c8">=&rdquo;client_presenter&rdquo; </span><span class="c4 c5">data-role</span><span class="c4 c8">=&rdquo;presenter&rdquo;&gt;</span></p><p class="c17 c18"><span class="c4 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span class="c4 c10">div</span><span class="c4 c8">&gt;</span></p><p class="c17 c18"><span class="c4 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;!-- a l&rsquo;interieur d&rsquo;un presenter, le context de donn&eacute;es change et devient l&rsquo;objet a afficher (ici: MyContext.client) --&gt;</span></p><p class="c17 c18"><span class="c4 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span class="c4 c10">h1</span><span class="c4 c8">&gt;Nom: </span><span class="c0">{binding from:nom}</span><span class="c4 c8">&lt;/</span><span class="c4 c10">h1</span><span class="c4 c8">&gt;</span></p><p class="c17 c18"><span class="c4 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span class="c4 c10">h2</span><span class="c4 c8">&gt;Pr&eacute;nom: </span><span class="c0">{binding from:prenom}</span><span class="c4 c8">&lt;/</span><span class="c4 c10">h2</span><span class="c4 c8">&gt;</span></p><p class="c17 c18"><span class="c4 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/</span><span class="c4 c10">div</span><span class="c4 c8">&gt;</span></p><p class="c17 c18"><span class="c4 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/</span><span class="c4 c10">div</span><span class="c4 c8">&gt;</span></p><p class="c17 c18"><span class="c4 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/</span><span class="c4 c10">div</span><span class="c4 c8">&gt;</span></p><p class="c17 c25 c18"><span class="c4 c8"></span></p><p class="c17 c25 c18"><span class="c4 c8"></span></p><p class="c17 c25 c18"><span class="c4 c8"></span></p><p class="c17 c18"><span class="c4 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;!-- affiche le contenu de MyContext.client en utilisant le presenter dont</span></p><p class="c17 c18"><span class="c4 c8">l&rsquo;identifiant est &ldquo;client_presenter&rdquo; -- &gt; </span></p><p class="c17 c18"><span class="c4 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span class="c4 c10">h3</span><span class="c4 c8">&gt;Mon premier client:&lt;/</span><span class="c4 c10">h3</span><span class="c4 c8">&gt;</span></p><p class="c7"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span class="c10">div</span><span>&gt;</span><span class="c1">{binding from:client1</span><span class="c15 c1">&nbsp;presenter:client_presenter</span><span class="c1">}</span><span>&lt;/</span><span class="c10">div</span><span>&gt;</span></p><p class="c7"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c2">&lt;</span><span class="c10">h3</span><span class="c2">&gt;Mon autre client:&lt;/</span><span class="c10">h3</span><span class="c2">&gt;</span></p><p class="c6"><span>&lt;</span><span class="c10">div</span><span>&gt;</span><span class="c1">{binding from:client2</span><span class="c15 c1">&nbsp;presenter:client_presenter</span><span class="c1">}</span><span>&lt;/</span><span class="c10">div</span><span>&gt;</span></p><p class="c17"><span>&lt;/</span><span class="c4 c10">body</span><span>&gt;</span></p><p class="c17 c25 c18"><span></span></p><p class="c3"><span class="c14"></span></p><p class="c16 c18"><span class="c1">Data-types</span></p><p class="c3"><span class="c1"></span></p><p class="c16"><span>Javascript n&#39;&eacute;tant pas fortement typ&eacute;, une propri&eacute;t&eacute; peu contenir a peu pr&egrave;s n&#39;importe quoi. Pour refl&eacute;ter cela, les presenters peuvent d&eacute;finir des &ldquo;data-types&rdquo; pour adapter l&#39;affichage aux donn&eacute;es pr&eacute;sentes. Il suffit, dans un presenter, d&#39;ajouter des childs avec un attribut</span><span class="c46">&nbsp;</span><span class="c15 c1">data-type=&quot;type de la property&quot;</span><span class="c46">.</span></p><p class="c16"><span>Pour reprendre l&rsquo;exemple de l&rsquo;affichage des clients, on va cr&eacute;er une nouvelle classe BonClient qui h&eacute;rite de Client:</span></p><p class="c13"><span></span></p><p class="c16"><span class="c1">function BonCLient (n,p,s,c){</span></p><p class="c16"><span class="c1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Client.call(this,n,p,s); </span><span class="c5 c1">//BonClient est un client, on reutilise les informations</span></p><p class="c16"><span class="c1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.code_promo = c;</span></p><p class="c16"><span class="c1">}</span></p><p class="c16"><span class="c1">BonClient.prototype.__proto__ = new Client(); </span><span class="c5 c1">//pour la chaine de prototype</span></p><p class="c13"><span></span></p><p class="c13"><span></span></p><p class="c12"><span class="c1">function MyContext (){</span></p><p class="c17"><span class="c1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c5 c1">//on cr&eacute;e un client pour pouvoir tester les presenters&hellip;.</span></p><p class="c12 c19"><span class="c1">this.</span><span class="c1">client1 = new Client(&ldquo;PONTEINS&rdquo;,&rdquo;St&eacute;phane&rdquo;,&rdquo;M&rdquo;),</span></p><p class="c12 c19"><span class="c1">this.client2= new </span><span class="c15 c1">BonClient</span><span class="c1">(&ldquo;PITT&rdquo;,&rdquo;Bebert&rdquo;,&rdquo;M&rdquo;, 3246) </span><span class="c5 c1">// B&eacute;bert deviens mon bon client</span></p><p class="c17"><span class="c1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</span></p><p class="c13"><span></span></p><p class="c13"><span></span></p><p class="c13"><span></span></p><p class="c16"><span>Dans le presenter &ldquo;client_presenter&rdquo;, on rajoute le data-type pour BonClient afin d&rsquo;afficher les informations en plus:</span></p><p class="c13"><span></span></p><p class="c17"><span class="c4 c8">&lt;</span><span class="c4 c10">body </span><span class="c4 c5">data-context</span><span class="c4 c8">=&quot;</span><span class="c1">MyContext</span><span class="c15 c1">&nbsp;</span><span class="c4 c8">&quot;&gt;</span></p><p class="c17"><span class="c4 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;!-- le conteneur pour les presenters --&gt;</span></p><p class="c17"><span class="c4 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span class="c4 c10">div</span><span class="c4 c8">&nbsp;</span><span class="c4 c5">data-role</span><span class="c4 c8">=&rdquo;presenters&rdquo;&gt;</span></p><p class="c17"><span class="c4 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;!-- le presenter pour afficher les donn&eacute;es d&rsquo;un client --&gt;</span></p><p class="c17"><span class="c4 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span class="c4 c10">div</span><span class="c4 c8">&nbsp;</span><span class="c4 c5">id</span><span class="c4 c8">=&rdquo;client_presenter&rdquo; </span><span class="c4 c5">data-role</span><span class="c4 c8">=&rdquo;presenter&rdquo;&gt;</span></p><p class="c17"><span class="c4 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span class="c4 c10">div</span><span class="c4 c8">&gt;</span></p><p class="c17"><span class="c4 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;!-- a l&rsquo;interieur d&rsquo;un presenter, le context de donn&eacute;es change et devient l&rsquo;objet a afficher (ici: MyContext.client) --&gt;</span></p><p class="c17"><span class="c4 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span class="c4 c10">h1</span><span class="c4 c8">&gt;Nom: </span><span class="c0">{binding from:nom}</span><span class="c4 c8">&lt;/</span><span class="c4 c10">h1</span><span class="c4 c8">&gt;</span></p><p class="c17"><span class="c4 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span class="c4 c10">h2</span><span class="c4 c8">&gt;Pr&eacute;nom: </span><span class="c0">{binding from:prenom}</span><span class="c4 c8">&lt;/</span><span class="c4 c10">h2</span><span class="c4 c8">&gt;</span></p><p class="c17"><span class="c4 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/</span><span class="c4 c10">div</span><span class="c4 c8">&gt;</span></p><p class="c17 c25"><span class="c4 c8"></span></p><p class="c17"><span class="c4 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span class="c4 c10">div data-type=&rdquo;BonClient&rdquo;</span><span class="c4 c8">&gt;</span></p><p class="c17"><span class="c4 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span class="c4 c10">h1</span><span class="c4 c8">&gt;Nom: </span><span class="c0">{binding from:nom}</span><span class="c4 c8">&lt;/</span><span class="c4 c10">h1</span><span class="c4 c8">&gt;</span></p><p class="c17"><span class="c4 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span class="c4 c10">h2</span><span class="c4 c8">&gt;Pr&eacute;nom: </span><span class="c0">{binding from:prenom}</span><span class="c4 c8">&lt;/</span><span class="c4 c10">h2</span><span class="c4 c8">&gt;</span></p><p class="c12 c20"><span class="c4 c8">&lt;</span><span class="c4 c10">h2</span><span class="c4 c8">&gt;Code: </span><span class="c0">{binding from:code_promo}</span><span class="c4 c8">&lt;/</span><span class="c4 c10">h2</span><span class="c4 c8">&gt;</span></p><p class="c17 c25"><span class="c4 c8"></span></p><p class="c17"><span class="c4 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/</span><span class="c4 c10">div</span><span class="c4 c8">&gt;</span></p><p class="c17 c25"><span class="c4 c8"></span></p><p class="c17"><span class="c4 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/</span><span class="c4 c10">div</span><span class="c4 c8">&gt;</span></p><p class="c17"><span class="c4 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/</span><span class="c4 c10">div</span><span class="c4 c8">&gt;</span></p><p class="c17"><span class="c4 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;!-- affiche le contenu de MyContext.client en utilisant le presenter dont</span></p><p class="c17"><span class="c4 c8">l&rsquo;identifiant est &ldquo;client_presenter&rdquo; -- &gt; </span></p><p class="c17"><span class="c4 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span class="c4 c10">h3</span><span class="c4 c8">&gt;Mon premier client:&lt;/</span><span class="c4 c10">h3</span><span class="c4 c8">&gt;</span></p><p class="c7"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span class="c10">div</span><span>&gt;</span><span class="c1">{binding from:client1</span><span class="c15 c1">&nbsp;presenter:client_presenter</span><span class="c1">}</span><span>&lt;/</span><span class="c10">div</span><span>&gt;</span></p><p class="c7"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c2">&lt;</span><span class="c10">h3</span><span class="c2">&gt;Mon autre client:&lt;/</span><span class="c10">h3</span><span class="c2">&gt;</span></p><p class="c6"><span>&lt;</span><span class="c10">div</span><span>&gt;</span><span class="c1">{binding from:client2</span><span class="c15 c1">&nbsp;presenter:client_presenter</span><span class="c1">}</span><span>&lt;/</span><span class="c10">div</span><span>&gt;</span></p><p class="c17"><span>&lt;/</span><span class="c4 c10">body</span><span>&gt;</span></p><p class="c17 c25"><span class="c4 c8"></span></p><p class="c16"><span class="c32 c1">Note sur la cr&eacute;ation d&rsquo;objet:</span></p><p class="c16"><span class="c32">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;En javascript, on peut cr&eacute;er des objets de 2 fa&ccedil;ons:</span></p><p class="c16"><span class="c32">implicitement avec la notation obj = { &hellip; };</span></p><p class="c16"><span class="c32">explicitement avec le mot cl&eacute; new et une fonction constructeur.</span><span class="c32 c1">&nbsp;Pour utiliser les data-types, vos objets doivent &ecirc;tre cr&eacute;es avec une fonction constructeur et appel au mot cl&eacute; NEW.</span></p><p class="c13"><span class="c1"></span></p><p class="c13"><span class="c1"></span></p><p class="c16"><span class="c1">Data-types et h&eacute;ritage:</span></p><p class="c13"><span class="c46"></span></p><p class="c16"><span>FTW&sup2;, lorsqu&rsquo;il cherche &agrave; afficher un objet, va utiliser la cha&icirc;ne de prototypes afin de d&eacute;terminer le data-type le plus probable. Pour illustrer le fonctionnement, on va cr&eacute;er un nouveau type de Client, SuperClient, h&eacute;ritant de BonClient mais sans data-type d&eacute;di&eacute; dans le presenter.</span></p><p class="c13"><span></span></p><p class="c16"><span class="c1">function SuperClient (n,p,s,c,i){</span></p><p class="c16"><span class="c1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BonClient.call(this,n,p,s,c); </span><span class="c5 c1">//permet de r&eacute;cup&eacute;rer les initialisations des autres constructeurs</span></p><p class="c16"><span class="c1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this._infos = i; </span><span class="c5 c1">//une donn&eacute;e tr&egrave;s importante s&ucirc;rement&hellip;. mais comme le nom commence par un underscore, il reste cach&eacute; pour le binding</span></p><p class="c16"><span class="c1">}</span></p><p class="c13"><span class="c1"></span></p><p class="c16"><span class="c5 c1">// Une petite note sur la notation du prototype:</span></p><p class="c16"><span class="c5 c1">//si on avait &eacute;crit SuperClient.prototype = new BonClient(); simplement, l&rsquo;objet aurait perdu l&rsquo;information sur son constructeur (comportement normal de javascript il semble). En initialisant __proto__, les informations sur le constructeur reste et permettent de diff&eacute;rencier les types de donn&eacute;es;</span></p><p class="c16"><span class="c1">SuperClient.prototype.__proto__ = new BonClient(); </span></p><p class="c13"><span class="c1"></span></p><p class="c13"><span class="c1"></span></p><p class="c16"><span>Dans le data-context global, on cr&eacute;e un nouveau client de type SuperClient, et on l&rsquo;affiche avec un binding. FTW&sup2; apr&egrave;s avoir recherch&eacute; le type &ldquo;SuperClient&rdquo; sans succ&egrave;s, </span><span class="c1">remontera la cha&icirc;ne des prototypes jusqu&#39;&agrave; trouver un type qu&rsquo;il conna&icirc;t</span><span>...</span></p><p class="c3"><span></span></p><p class="c3"><span></span></p><p class="c17 c18"><span class="c1">Fallback et data-type:</span></p><p class="c17 c25 c18"><span class="c1"></span></p><p class="c17 c18"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Comme pour les bindings simples, il est possible de d&eacute;cider quoi afficher dans le cas ou l&rsquo;objet &agrave; afficher est null ou undefined (en place du &ldquo;unknown model!&rdquo; affich&eacute; de base par le framework). Il y a 2 fa&ccedil;on de g&eacute;rer ce cas: ou </span><span class="c1">renseigner un identifiant de &ldquo;presenter&rdquo;</span><span>&nbsp;a utiliser dans ce cas avec le param&egrave;tre &ldquo;fallback&rdquo;, ou </span><span class="c1">cr&eacute;er un data-type=&rdquo;fallback&rdquo;</span><span>&nbsp;dans le &ldquo;presenter&rdquo;.</span></p><p class="c17 c25 c18"><span></span></p><p class="c17 c18"><span class="c1">fallback:</span></p><p class="c17 c18"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p class="c16 c18"><span>un &ldquo;presenter de fallback&rdquo; se cr&eacute;e comme n&rsquo;importe quel autre &ldquo;presenter&rdquo; mais aura pour contexte de donn&eacute;es le contexte &ldquo;global&rdquo; (Dans notre exemple, le contexte du &ldquo;fallback&rdquo; sera MyContext). Un &ldquo;presenter&rdquo; de fallback n&rsquo;est pas associ&eacute; &agrave; un type particulier et peut &ecirc;tre utilis&eacute; par n&rsquo;importe quel binding d&rsquo;objet dans votre page.</span></p><p class="c3"><span></span></p><p class="c12"><span class="c1">function MyContext () {</span></p><p class="c12 c25"><span class="c1"></span></p><p class="c12"><span class="c1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.</span><span class="c15 c1">message =&ldquo;D&eacute;sol&eacute;, pas d&rsquo;infos sur ce client.&rdquo;,</span><span class="c1">&nbsp;</span><span class="c5 c1">//le message a afficher si le client est null</span></p><p class="c17"><span class="c1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c5 c1">//on cr&eacute;e un client pour pouvoir tester les presenters&hellip;.</span></p><p class="c12 c19"><span class="c1">this.</span><span class="c1">client1= </span><span class="c15 c1">null</span><span class="c1">,</span><span class="c5 c1">// ici, le premier client est indefini...</span></p><p class="c12 c19"><span class="c1">this.client2= new BonClient(&ldquo;PITT&rdquo;,&rdquo;Bebert&rdquo;,&rdquo;M&rdquo;, 3246) </span></p><p class="c17"><span class="c1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</span></p><p class="c13"><span></span></p><p class="c3"><span></span></p><p class="c12"><span class="c4 c8">&lt;</span><span class="c4 c10">div</span><span class="c4 c8">&nbsp;</span><span class="c4 c5">data-role</span><span class="c4 c8">=&rdquo;presenters&rdquo;&gt;</span></p><p class="c17 c25"><span class="c4 c8"></span></p><p class="c17"><span class="c4 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;!-- le presenter pour afficher un fallback--&gt;</span></p><p class="c17"><span class="c4 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span class="c4 c10">div</span><span class="c4 c8">&nbsp;</span><span class="c4 c5">id</span><span class="c4 c8">=&rdquo;fallback_presenter&rdquo; </span><span class="c4 c5">data-role</span><span class="c4 c8">=&rdquo;presenter&rdquo;&gt;</span></p><p class="c17"><span class="c4 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &lt;</span><span class="c4 c10">div&gt;</span></p><p class="c17"><span class="c4 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;!-- dans un fallback, le contexte de donn&eacute;es est le contexte global! --&gt;</span></p><p class="c17"><span class="c4 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span class="c4 c10">h1</span><span class="c4 c8">&gt;</span><span class="c4">{binding from:message}</span><span class="c4 c8">&lt;/</span><span class="c4 c10">h1</span><span class="c4 c8">&gt;</span></p><p class="c17"><span class="c4 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &lt;/</span><span class="c4 c10">div</span><span class="c4 c8">&gt;</span></p><p class="c17"><span class="c4 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/</span><span class="c4 c10">div</span><span class="c4 c8">&gt;</span></p><p class="c17 c25"><span class="c4 c8"></span></p><p class="c12 c19"><span class="c4 c8">&lt;!-- le presenter pour afficher les donn&eacute;es d&rsquo;un client --&gt;</span></p><p class="c17"><span class="c4 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span class="c4 c10">div</span><span class="c4 c8">&nbsp;</span><span class="c4 c5">id</span><span class="c4 c8">=&rdquo;client_presenter&rdquo; </span><span class="c4 c5">data-role</span><span class="c4 c8">=&rdquo;presenter&rdquo;&gt;</span></p><p class="c17"><span class="c4 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&hellip;</span></p><p class="c17"><span class="c4 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/</span><span class="c4 c10">div</span><span class="c4 c8">&gt;</span></p><p class="c12"><span class="c4 c8">&lt;/</span><span class="c4 c10">div</span><span class="c4 c8">&gt;</span></p><p class="c3"><span></span></p><p class="c16 c18"><span>Et on pr&eacute;cise juste dans notre binding le param&egrave;tre &ldquo;fallback&rdquo; pour lui indiquer ce qu&rsquo;il faut afficher:</span></p><p class="c3"><span></span></p><p class="c12"><span class="c4 c8">&lt;</span><span class="c4 c10">h3</span><span class="c4 c8">&gt;Mon premier client:&lt;/</span><span class="c4 c10">h3</span><span class="c4 c8">&gt;</span></p><p class="c7"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span class="c10">div</span><span>&gt;</span><span class="c1">{binding from:client1</span><span class="c15 c1">&nbsp;</span><span class="c1">presenter:client_presenter</span><span class="c15 c1">&nbsp;fallback:fallback_presenter</span><span class="c1">}</span><span>&lt;/</span><span class="c10">div</span><span>&gt;</span></p><p class="c3"><span></span></p><p class="c16 c18"><span class="c1">data-type=&rdquo;fallback&rdquo;:</span></p><p class="c3"><span></span></p><p class="c16 c18"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Une autre fa&ccedil;on de g&eacute;rer le cas null ou undefined est de cr&eacute;er un data-type d&eacute;di&eacute; dans le &ldquo;presenter&rdquo;. Dans ce cas, le contexte de donn&eacute;es sera aussi le contexte global de donn&eacute;es. C&rsquo;est juste une question de pr&eacute;f&eacute;rence&hellip; Un data-type=&rdquo;fallback&rdquo; est associ&eacute; a un type de donn&eacute;e (ou pour &ecirc;tre exact, a un type de presenter) et ne peux donc pas &ecirc;tre partag&eacute; par un autre type de presenter.</span></p><p class="c3"><span></span></p><p class="c12"><span class="c4 c8">&lt;</span><span class="c4 c10">div</span><span class="c4 c8">&nbsp;</span><span class="c4 c5">data-role</span><span class="c4 c8">=&rdquo;presenters&rdquo;&gt;</span></p><p class="c17"><span class="c4 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;!-- le presenter pour afficher les donn&eacute;es d&rsquo;un client --&gt;</span></p><p class="c17"><span class="c4 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span class="c4 c10">div</span><span class="c4 c8">&nbsp;</span><span class="c4 c5">id</span><span class="c4 c8">=&rdquo;client_presenter&rdquo; </span><span class="c4 c5">data-role</span><span class="c4 c8">=&rdquo;presenter&rdquo;&gt;</span></p><p class="c17"><span class="c4 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span class="c4 c10">div</span><span class="c4 c8">&gt;</span></p><p class="c17"><span class="c4 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;!-- a l&rsquo;interieur d&rsquo;un presenter, le context de donn&eacute;es change et devient l&rsquo;objet a afficher (ici: MyContext.client) --&gt;</span></p><p class="c17"><span class="c4 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span class="c4 c10">h1</span><span class="c4 c8">&gt;Nom: </span><span class="c0">{binding from:nom}</span><span class="c4 c8">&lt;/</span><span class="c4 c10">h1</span><span class="c4 c8">&gt;</span></p><p class="c17"><span class="c4 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span class="c4 c10">h2</span><span class="c4 c8">&gt;Pr&eacute;nom: </span><span class="c0">{binding from:prenom}</span><span class="c4 c8">&lt;/</span><span class="c4 c10">h2</span><span class="c4 c8">&gt;</span></p><p class="c17"><span class="c4 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/</span><span class="c4 c10">div</span><span class="c4 c8">&gt;</span></p><p class="c17 c25"><span class="c4 c8"></span></p><p class="c17"><span class="c4 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span class="c4 c10">div data-type=&rdquo;BonClient&rdquo;</span><span class="c4 c8">&gt;</span></p><p class="c17"><span class="c4 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span class="c4 c10">h1</span><span class="c4 c8">&gt;Nom: </span><span class="c0">{binding from:nom}</span><span class="c4 c8">&lt;/</span><span class="c4 c10">h1</span><span class="c4 c8">&gt;</span></p><p class="c17"><span class="c4 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span class="c4 c10">h2</span><span class="c4 c8">&gt;Pr&eacute;nom: </span><span class="c0">{binding from:prenom}</span><span class="c4 c8">&lt;/</span><span class="c4 c10">h2</span><span class="c4 c8">&gt;</span></p><p class="c12 c20"><span class="c4 c8">&lt;</span><span class="c4 c10">h2</span><span class="c4 c8">&gt;Code: </span><span class="c0">{binding from:code_promo}</span><span class="c4 c8">&lt;/</span><span class="c4 c10">h2</span><span class="c4 c8">&gt;</span></p><p class="c17 c25"><span class="c4 c8"></span></p><p class="c17"><span class="c4 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/</span><span class="c4 c10">div</span><span class="c4 c8">&gt;</span></p><p class="c17 c25"><span class="c4 c8"></span></p><p class="c17"><span class="c4 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span class="c4 c10">div data-type=&rdquo;fallback&rdquo;&gt;</span></p><p class="c17"><span class="c4 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;&lt;!-- dans un fallback, le contexte de donn&eacute;es est le contexte global! --&gt;</span></p><p class="c17"><span class="c4 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;&lt;</span><span class="c4 c10">h1</span><span class="c4 c8">&gt;Erreur: </span><span class="c4">{binding from:message}</span><span class="c4 c8">&lt;/</span><span class="c4 c10">h1</span><span class="c4 c8">&gt;</span></p><p class="c17"><span class="c4 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &lt;/</span><span class="c4 c10">div</span><span class="c4 c8">&gt;</span></p><p class="c17"><span class="c4 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/</span><span class="c4 c10">div</span><span class="c4 c8">&gt;</span></p><p class="c17"><span class="c4 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/</span><span class="c4 c10">div</span><span class="c4 c8">&gt;</span></p><p class="c3"><span></span></p><p class="c16 c18"><span class="c32">Note: si vous d&eacute;finissez un data-type=&rdquo;fallback&rdquo; ET renseignez le param&egrave;tre fallback dans le binding, le param&egrave;tre fallback sera l&rsquo;affichage choisi en priorit&eacute;!</span></p><p class="c16 c18"><span class="c1 c39">NOUVEAU: Binding de webservice JSON</span></p><p class="c3"><span></span></p><p class="c16 c18"><span>docs/webservice.html</span></p><p class="c3"><span></span></p><p class="c16 c18"><span>Lors du d&eacute;veloppement de l&#39;application d&#39;exemple pour le tutorial, je me suis dis qu&#39;il serait int&eacute;ressant de pouvoir lier directement les r&eacute;sultats des appels AJAX &agrave; un webservice &agrave; mon UI, </span><span class="c1">juste en indiquant une URL au param&egrave;tre FROM du binding</span><span>. &Ccedil;a m&#39;&eacute;viterait de cr&eacute;er des objets &quot;conteneurs&quot; sans autre int&eacute;r&ecirc;t que d&eacute;placer &nbsp;les donn&eacute;es d&#39;un objet &agrave; un autre, et on pourrait laisser le framework r&eacute;cup&eacute;rer les donn&eacute;es tout seul.</span></p><p class="c3"><span></span></p><p class="c12"><span>Lorsqu&#39;on veut lier le r&eacute;sultat d&#39;un webservice dans FTW&sup2;, il faut auparavant cr&eacute;er un </span><span class="c1">presenter</span><span>. </span><span class="c31">LE BINDING DE WEBSERVICE DOIT OBLIGATOIREMENT SE FAIRE SUR UN OBJET!</span></p><p class="c17"><span class="c1">NOUVEAU</span><span>: puisque la notation pour binder un objet et un tableau/liste ont &eacute;t&eacute; fusionn&eacute;es, un binding de webservice peut d&eacute;sormais aussi r&eacute;cup&eacute;rer un tableau de donn&eacute;es.</span></p><p class="c17 c25"><span></span></p><p class="c16"><span>Les diff&eacute;rents param&egrave;tres sont:</span></p><p class="c13"><span></span></p><ul class="c28 lst-kix_597z9mq2fg8h-0"><li class="c17 c26 c19"><span class="c15 c1">from</span><span>: Obligatoire, l&#39;url du webservice et les param&egrave;tres de la requ&ecirc;te:</span></li></ul><p class="c17"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;par exemple: </span><span class="c1">from:http://www.monwebservice.com/service?q=un_param_en_dur&amp;c=$ma_var_js</span></p><p class="c17"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;les param&egrave;tres de la requ&ecirc;te:</span></p><p class="c17"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Pour pouvoir passer une propri&eacute;t&eacute; du context courant au service web, </span><span class="c1">on fait pr&eacute;c&eacute;der son nom par &#39;$&#39;</span><span>. Si le param&egrave;tre n&#39;est pas renseign&eacute; (par exemple, initialis&eacute; &agrave; NULL&hellip;), la requ&ecirc;te est annul&eacute;e.</span></p><p class="c17"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Pour pouvoir passer un argument optionnel &agrave; une requ&ecirc;te, on fera pr&eacute;c&eacute;der le nom de la propri&eacute;t&eacute; par &#39;?$&#39;. Si le param&egrave;tre n&#39;est pas renseign&eacute;, la requ&ecirc;te sera quand m&ecirc;me lanc&eacute;e ( J&#39;ai pas encore fini de mettre ca au point&hellip;)</span></p><p class="c17 c25"><span></span></p><ul class="c28 lst-kix_597z9mq2fg8h-0"><li class="c17 c26 c19"><span class="c15 c1">presenter</span><span>: Obligatoire, l&rsquo;identifiant d&rsquo;un &eacute;l&eacute;ment HTML a utiliser pour afficher les informations de l&rsquo;objet.</span></li><li class="c17 c26 c19"><span class="c15 c1">as</span><span>: optionnel: si vous avez besoin de r&eacute;cup&eacute;rer l&#39;objet dans votre code, vous pouvez lui donner un nom particulier. </span><span class="c1">Vous ne pouvez pas modifier cette propri&eacute;t&eacute; vous m&ecirc;me. (Pas de setter).</span></li><li class="c17 c26 c19"><span class="c15 c1">reader</span><span>: optionnel: par d&eacute;faut, le framework attend des donn&eacute;es au format JSON (content-type=&quot;application/json&quot;). Dans le cas ou le webservice renverrait autre chose (du XML par exemple), vous pouvez sp&eacute;cifier </span><span class="c1">le nom d&#39;une m&eacute;thode (de port&eacute;e globale)</span><span>&nbsp;prenant en param&egrave;tre la r&eacute;ponse du service web sous forme de String, et elle </span><span class="c1">doit renvoyer un Objet</span><span>&nbsp;pour le binding.</span></li><li class="c17 c26 c19"><span class="c15 c1">converter</span><span>: optionnel, si renseign&eacute;, une m&eacute;thode globale pour convertir la donn&eacute;e avant la liaison.</span></li></ul><ul class="c28 lst-kix_597z9mq2fg8h-1 start"><li class="c17 c29 c26"><span>@param: value: la valeur a convertir</span></li><li class="c17 c29 c26"><span>@param converter_params: param&egrave;tres optionnels</span></li></ul><ul class="c28 lst-kix_597z9mq2fg8h-0"><li class="c17 c26 c19"><span class="c15 c1">converter_params</span><span>: optionnel, permet de passer des param&egrave;tres a la m&eacute;thode de conversion.</span></li><li class="c17 c26 c19"><span class="c15 c1">fallback</span><span>: optionnel, si value==null, id du div presenter a afficher a la place</span></li><li class="c17 c26 c19"><span class="c15 c1">alt</span><span>: optionnel, exp&eacute;rimental, permet de lier ce binding a une autre cl&eacute; que celle de la propri&eacute;t&eacute;</span></li><li class="c17 c26 c19"><span class="c15 c1">deep</span><span>: optionnel, doit &ecirc;tre false. Emp&ecirc;che de cr&eacute;er les liaisons de donn&eacute;es pour les propri&eacute;t&eacute;s internes de l&rsquo;objet. (ie, on peut afficher les propri&eacute;t&eacute;s de l&rsquo;objet, mais on ne souhaite pas &ecirc;tre notifier de leurs changement). Par d&eacute;faut true= si une propri&eacute;t&eacute; interne de l&rsquo;objet est modifi&eacute;, le framework mettra a jour le binding.</span></li></ul><p class="c13"><span class="c1"></span></p><p class="c3"><span></span></p><p class="c12 c18"><span>Pour l&#39;exemple, on va utiliser le binding de webservice pour r&eacute;cup&egrave;re les noms d&#39;entreprise a partir du webservice de microsoft.</span></p><p class="c12 c18"><span>html:</span></p><p class="c12 c18"><span>&lt;!DOCTYPE html&gt;</span></p><p class="c12 c18"><span>&lt;</span><span class="c10">head</span><span>&gt;</span></p><p class="c12 c18"><span>&nbsp; &lt;meta charset=&quot;utf-8&quot;&gt;</span></p><p class="c12 c18"><span>&nbsp; &lt;</span><span class="c10">title</span><span>&gt;Test Webservice direct binding&lt;/</span><span class="c10">title</span><span>&gt;</span></p><p class="c12 c18"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span class="c10">script</span><span>&nbsp;</span><span class="c5">src</span><span>=&quot;fear-the-walking-web-flesh-and-bones.js&quot;&gt;&lt;/script&gt;</span></p><p class="c12 c18"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span class="c10">script</span><span>&gt;</span></p><p class="c12 c18"><span>&nbsp; &nbsp; &nbsp; &nbsp; function </span><span class="c1">context() {</span></p><p class="c12 c19 c18"><span class="c1 c5">//le nom de l&#39;entreprise recherch&eacute;e</span></p><p class="c12 c19 c18"><span class="c1">this.</span><span class="c1">search_txt = &quot;app&quot;; </span></p><p class="c12 c19 c18"><span class="c5 c1">//le nbr de r&eacute;sultat demand&eacute;</span></p><p class="c12 c19 c18"><span class="c1">this.</span><span class="c1">count= 5;}; &nbsp;</span><span>&nbsp; &nbsp; &nbsp; </span></p><p class="c12 c18"><span>&nbsp; &nbsp; &nbsp; &nbsp; &lt;/</span><span class="c10">script</span><span>&gt;</span></p><p class="c12 c18"><span>&lt;/</span><span class="c10">head</span><span>&gt;</span></p><p class="c12 c18"><span>&lt;</span><span class="c10">body</span><span>&nbsp;</span><span class="c5">data-context</span><span>=&quot;context&quot; &gt;</span></p><p class="c12 c18"><span>&nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c10">div</span><span>&nbsp;</span><span class="c5">data-role</span><span>=&quot;presenters&quot;&gt;</span></p><p class="c12 c18"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c10">div</span><span>&nbsp;</span><span class="c5">data-role</span><span>=&quot;presenter&quot; </span><span class="c5">id</span><span>=&quot;suggestion_query_result&quot;&gt;</span></p><p class="c12 c18"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p class="c12 c18"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c2">&lt;!-- le presenter pour le r&eacute;sultat du webservice, le premier &eacute;l&eacute;ment est toujours celui par d&eacute;faut </span></p><p class="c12 c29 c18"><span class="c2">l&#39;objet JSON renvoy&eacute; par le webservice poss&egrave;de 2 propri&eacute;t&eacute;s : count: le nombre de r&eacute;ponses et data: un tableau contenant </span></p><p class="c12 c29 c18"><span class="c2">les reponses--&gt;</span></p><p class="c12 c18"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c10">div</span><span>&gt;</span></p><p class="c12 c18"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c10">b</span><span>&gt;Nombre de reponses:</span><span class="c1">{binding from:count fallback:&#39;0&#39;}</span><span>&lt;/</span><span class="c10">b</span><span>&gt;</span></p><p class="c12 c18"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c10">ul</span><span>&gt;</span><span class="c1">{binding from:data item_presenter:suggestions_result}</span><span>&lt;/</span><span class="c10">ul</span><span>&gt;</span></p><p class="c12 c18"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/</span><span class="c10">div</span><span>&gt;</span></p><p class="c12 c18"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c2">&lt;!-- le binding de webservice d&eacute;fini 3 data type particuliers: lorsqu&#39;une requ&ecirc;te est lanc&eacute;e, le type devient un </span></p><p class="c12 c18"><span class="c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WEBSERVICE_LOADING avec une propri&eacute;t&eacute; message --&gt;</span></p><p class="c12 c18"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c10">div</span><span>&nbsp;</span><span class="c5">data-type</span><span>=&quot;WEBSERVICE_LOADING&quot;&gt;</span></p><p class="c12 c18"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c10">i</span><span>&gt;</span><span class="c1">{binding from:message fallback:&#39;Merci de patienter&#39;}</span><span>&lt;/</span><span class="c10">i</span><span>&gt;</span></p><p class="c12 c18"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/</span><span class="c10">div</span><span>&gt;</span></p><p class="c12 c18"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c2">&lt;!-- le data type indiquant une erreur lors de la r&eacute;cup&eacute;ration des donn&eacute;es ou de la conversion en objet --&gt;</span></p><p class="c12 c18"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c10">div</span><span>&nbsp;</span><span class="c5">data-type</span><span>=&quot;WEBSERVICE_ERROR&quot;&gt;</span></p><p class="c12 c18"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c10">i</span><span>&gt;Erreur de chargement des donn&eacute;es du webservice:&lt;/i&gt;</span></p><p class="c12 c18"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c10">b</span><span>&gt;</span><span class="c1">{binding from:message}</span><span>&lt;/b&gt;</span></p><p class="c12 c18"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/</span><span class="c10">div</span><span>&gt;</span></p><p class="c12 c18"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c2">&lt;!-- en cas de timeout&hellip; --&gt;</span></p><p class="c12 c18"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c10">div</span><span>&nbsp;</span><span class="c5">data-type</span><span>=&quot;WEBSERVICE_TIMEOUT&quot;&gt;</span></p><p class="c12 c18"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c10">b</span><span>&gt;{binding from:message}&lt;/</span><span class="c10">b</span><span>&gt;</span></p><p class="c12 c18"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/</span><span class="c10">div</span><span>&gt;</span></p><p class="c12 c18"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/</span><span class="c10">div</span><span>&gt;</span></p><p class="c12 c18"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c2">&lt;!-- le presenter pour les objets contenant les suggestions: ici, on ne s&#39;int&eacute;resse qu&#39;a la propri&eacute;t&eacute; FriendlyName, mais il</span></p><p class="c12 c18"><span class="c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y en a beaucoup d&#39;autres&hellip; --&gt;</span></p><p class="c12 c18"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c10">div</span><span>&nbsp;</span><span class="c5">data-role</span><span>=&quot;presenter&quot; </span><span class="c5">id</span><span>=&quot;suggestions_result&quot;&gt;</span></p><p class="c12 c18"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c10">li</span><span>&gt;</span></p><p class="c12 c18"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c10">i</span><span>&gt;</span><span class="c1">{binding from:FriendlyName}</span><span>&lt;/</span><span class="c10">i</span><span>&gt;</span></p><p class="c12 c18"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/li&gt;</span></p><p class="c12 c18"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/</span><span class="c10">div</span><span>&gt;</span></p><p class="c12 c18"><span>&nbsp; &nbsp; &nbsp; &nbsp; &lt;/</span><span class="c10">div</span><span>&gt;</span></p><p class="c12 c18"><span>&nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c12 c18"><span>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c2">&lt;!-- le contenu de la page --&gt;</span></p><p class="c12 c18"><span>&nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c10">div</span><span>&gt;</span></p><p class="c12 c18"><span>&nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c12 c18"><span>&nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c10">h3</span><span>&gt;Juste un test pour la r&eacute;cup&eacute;ration et binding direct d&#39;un service web renvoyant un r&eacute;sultat sous forme de String JSON.&lt;/</span><span class="c10">h3</span><span>&gt;</span></p><p class="c12 c18"><span>&nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c10">form</span><span>&gt;</span></p><p class="c12 c18"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c10">h4</span><span>&gt;Entrez le d&eacute;but du nom de l&#39;action recherch&eacute;e, puis cliquez n&#39;importe ou sur la page.&lt;/</span><span class="c10">h4</span><span>&gt;</span></p><p class="c12 c18"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c2">&lt;!-- un binding 2way sur search_txt pour r&eacute;cup&eacute;rer la recherche de l&#39;utilisateur, --&gt;</span></p><p class="c12 c18"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c10">input</span><span>&nbsp;</span><span class="c5">type</span><span>=&quot;text&quot; </span><span class="c5">data-binded-value</span><span>=&quot;</span><span class="c1">{binding from:search_txt mode:2way fallback:&#39;Votre recherche ici&#39;}&quot;</span><span>&gt;&lt;/</span><span class="c10">input</span><span>&gt;</span></p><p class="c12 c18"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c10">h4</span><span>&gt;Nombre de r&eacute;sultats:&lt;/</span><span class="c10">h4</span><span>&gt;</span></p><p class="c12 c18"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c2">&lt;!-- un groupe de radio pour choisir le nombre de r&eacute;sultat a afficher, le binding se fait sur la propri&eacute;t&eacute; count --&gt;</span></p><p class="c12 c18"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c10">label</span><span>&nbsp;</span><span class="c5">for</span><span>=&quot;c3&quot;&gt;3&lt;/</span><span class="c10">label</span><span>&gt;&lt;</span><span class="c10">input</span><span>&nbsp;</span><span class="c5">id</span><span>=&quot;c3&quot; </span><span class="c5">name</span><span>=&quot;count&quot; </span><span class="c5">type</span><span>=&quot;radio&quot; </span><span class="c5">data-binded-checked</span><span>=&quot;{binding from:count mode:2way}&quot; </span><span class="c5">value</span><span>=&quot;3&quot;&gt;</span></p><p class="c12 c18"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c10">label</span><span>&nbsp;</span><span class="c5">for</span><span>=&quot;c5&quot;&gt;5&lt;/</span><span class="c10">label</span><span>&gt;&lt;</span><span class="c10">input</span><span>&nbsp;</span><span class="c5">id</span><span>=&quot;c5&quot; </span><span class="c5">name</span><span>=&quot;count&quot; </span><span class="c5">type</span><span>=&quot;radio&quot; </span><span class="c5">data-binded-checked</span><span>=&quot;{binding from:count mode:2way}&quot; </span><span class="c5">value</span><span>=&quot;5&quot;&gt;</span></p><p class="c12"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c10">label</span><span>&nbsp;</span><span class="c5">for</span><span>=&quot;c8&quot;&gt;8&lt;/</span><span class="c10">label</span><span>&gt;&lt;</span><span class="c10">input</span><span>&nbsp;</span><span class="c5">id</span><span>=&quot;c8&quot; </span><span class="c5">name</span><span>=&quot;count&quot; </span><span class="c5">type</span><span>=&quot;radio&quot; </span><span class="c5">data-binded-checked</span><span>=&quot;{binding from:count mode:2way}&quot; </span><span class="c5">value</span><span>=&quot;8&quot;&gt;</span></p><p class="c12"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c12 c18"><span>&nbsp; &nbsp; &nbsp; &nbsp; &lt;/</span><span class="c10">form</span><span>&gt;</span></p><p class="c12 c25 c18"><span></span></p><p class="c12 c18"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c2">&lt;!-- on affiche les r&eacute;sultat: on binde l&#39;url de notre service web, on renseigne les param&egrave;tres q (query) avec la propri&eacute;t&eacute; search_txt et count. </span></p><p class="c12 c18"><span class="c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;comme on a affaire a un tableau de r&eacute;sultat, on renseigne la propri&eacute;t&eacute; item_presenter. A chaque modification de search_txt ou de count,</span></p><p class="c12 c18"><span class="c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;le framework relancera une requete AJAX pour mettre a jour les donn&eacute;es&hellip;. --&gt;</span></p><p class="c12 c49"><span>&nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c10">div</span><span>&gt;</span><span class="c1">{binding from:http://finance.services.appex.bing.com/Market.svc/MTAutocomplete?q=$search_txt&amp;locale=FR-FR&amp;count=$count as:suggestions presenter:suggestion_query_result}</span><span>&lt;/</span><span class="c10">div</span><span>&gt;</span></p><p class="c12 c18"><span>&nbsp; &nbsp; &nbsp; &nbsp; &lt;/</span><span class="c10">div</span><span>&gt;</span></p><p class="c12 c18"><span>&lt;/</span><span class="c10">body</span><span>&gt;</span></p><p class="c12 c18"><span>&lt;/</span><span class="c10">html</span><span>&gt;</span></p><p class="c12 c25 c18"><span></span></p><p class="c12 c18"><span class="c32">NOTE: d&egrave;s que j&#39;aurais un peu de temps devant moi, je r&eacute;&eacute;crirais le code de l&#39;application de test pour en faire une version avec le binding de webservice.</span></p><p class="c12 c25 c18"><span></span></p><h1 class="c17 c33" id="h.uekhlp7ltgap"><span>6: Data-binding et arrays:</span></h1><p class="c16 c18"><span class="c22"><a class="c34" href="https://www.google.com/url?q=http://exemples/item_presenters.html&amp;sa=D&amp;ust=1456995045129000&amp;usg=AFQjCNHjn7bWb27QWNhVqds3c98WldMIqg">item_presenters.html</a></span></p><p class="c3"><span></span></p><p class="c16 c18"><span class="c1">MODIFICATIONS: Il n&#39;y a plus de diff&eacute;rences de notation entre un presenter pour un objet et un presenter pour un Array. Les 2 utilises le param&egrave;tre &quot;presenter&quot;, et les objets peuvent implementer une m&eacute;thode &quot;is_empty&quot; renvoyant true/false pour g&eacute;rer le cas vide.</span></p><p class="c3"><span></span></p><p class="c16 c18"><span class="c31">Un binding utilisant un &#39;item_presenter&#39; sert a afficher une liste d&#39;objets. Lorsqu&#39;on veut lier un tableau (liste) dans FTW&sup2;, il faut auparavant cr&eacute;er un </span><span class="c1 c31">item_presenter</span><span class="c31">, une sorte de template d&#39;affichage pour les propri&eacute;t&eacute;s de chaque item du tableau. Ceux ci se d&eacute;finissent directement dans le fichier HTML.</span></p><p class="c12 c25"><span></span></p><ul class="c28 lst-kix_z3z1tzvla6e6-0"><li class="c17 c26 c19"><span>Directement sous la balise &lt;</span><span class="c10 c1">BODY</span><span>&gt;, dans </span><span class="c1">le conteneur a presenters</span><span>&nbsp;(un div avec un </span><span class="c1">data-role=presenters</span><span>)</span></li><li class="c17 c26 c19"><span>Chaque childs de ce conteneur repr&eacute;sente un presenter particulier. un presenter </span><span class="c1">doit avoir un id unique</span><span>&nbsp;et renseigner l&#39;attribut </span><span class="c1">data-role=presenter. </span><span>(un item_presenter n&rsquo;est en fait qu&rsquo;un presenter tout &agrave; fait normal)</span></li><li class="c17 c26 c19"><span>Chaque childs de cet item_presenter/presenter repr&eacute;sente un </span><span class="c1">data-type</span><span>&nbsp;particulier, le firstChild &eacute;tant le type par d&eacute;faut, n&#39;a pas besoin de pr&eacute;ciser le type. Le data-type correspond </span><span class="c1">au type des items</span><span>&nbsp;du tableau/liste qui est li&eacute;.</span></li><li class="c17 c26 c19"><span>A l&#39;int&eacute;rieur d&#39;un item_presenter, </span><span class="c1">le contexte de donn&eacute;es change</span><span>. Il devient tour &agrave; tour chaque item du tableau qui est li&eacute; , rendant accessible directement leurs propri&eacute;t&eacute;s pour le binding.</span></li></ul><p class="c17 c25"><span></span></p><p class="c3"><span></span></p><p class="c3"><span></span></p><p class="c16 c18"><span class="c14">Les </span><span>diff&eacute;rents</span><span class="c14">&nbsp;</span><span>param&egrave;tres</span><span class="c14">&nbsp;sont:</span></p><p class="c3"><span class="c14"></span></p><ul class="c28 lst-kix_597z9mq2fg8h-0"><li class="c17 c26 c19"><span class="c14 c15 c1">from</span><span class="c14">: Obligatoire, le nom de la propri&eacute;t&eacute; &agrave; lier</span></li><li class="c17 c26 c19"><span class="c14 c31 c15 c1">item</span><span class="c31 c15 c1">_</span><span class="c14 c31 c15 c1">presenter</span><span class="c14 c31">: Obligatoire, l&rsquo;identifiant d&rsquo;un div a utiliser pour afficher les informations des &eacute;l&eacute;ments de l&rsquo;array.</span></li><li class="c17 c26 c19"><span class="c15 c1">presenter</span><span>: Obligatoire, l&rsquo;identifiant d&rsquo;un div a utiliser pour afficher les informations des &eacute;l&eacute;ments de l&rsquo;array.</span></li><li class="c17 c26 c19"><span class="c14 c15 c1">converter</span><span class="c14">: optionnel, si renseign&eacute;, une m&eacute;thode globale pour convertir la donn&eacute;e avant la liaison.</span></li></ul><ul class="c28 lst-kix_597z9mq2fg8h-1 start"><li class="c17 c29 c26"><span class="c14">@param: value: la valeur a convertir</span></li><li class="c17 c29 c26"><span class="c14">@param converter_params: param&egrave;tres optionnels</span></li></ul><ul class="c28 lst-kix_597z9mq2fg8h-0"><li class="c17 c26 c19"><span class="c14 c15 c1">converter_params</span><span class="c14">: optionnel, permet de passer des param&egrave;tres a la m&eacute;thode de conversion.</span></li><li class="c17 c26 c19"><span class="c14 c15 c1">fallback</span><span class="c14">: optionnel, si value==null, id du div presenter a afficher a la place</span></li><li class="c17 c26 c19"><span class="c15 c1">empty</span><span>: optionnel, si value.length == 0, id du div a afficher a la place</span></li><li class="c17 c26 c19"><span class="c14 c15 c1">alt</span><span class="c14">: optionnel, exp&eacute;rimental, permet de lier ce binding a une autre cl&eacute; que celle de la propri&eacute;t&eacute;</span></li><li class="c17 c26 c19"><span class="c14 c15 c1">deep</span><span class="c14">: par </span><span>d&eacute;faut</span><span class="c14">&nbsp;True, indique si doit cr&eacute;er des liaisons pour les &eacute;l&eacute;ments de l&rsquo;array</span></li></ul><p class="c3"><span class="c14 c1"></span></p><p class="c16 c18"><span>Pour continuer avec nos clients, on va cette fois cr&eacute;er une liste de clients et demander l&rsquo;affichage par un item-presenter. On cr&eacute;e dans le contexte de donn&eacute;es global une propri&eacute;t&eacute; clients et on l&rsquo;initialise.</span></p><p class="c3"><span></span></p><p class="c12"><span class="c1">function MyContext() {</span></p><p class="c17"><span class="c1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.clients = [ new Client(&ldquo;JOE&rdquo;,&rdquo;joe&rdquo;,&rdquo;M&rdquo;),</span></p><p class="c12 c20"><span class="c1">new Client(&ldquo;MALLOW&rdquo;,&rdquo;Marc&rdquo;,&rdquo;M&rdquo;),</span></p><p class="c12 c20"><span class="c1">new Client(&ldquo;DALTON&rdquo;,&rdquo;M&rsquo;a&rdquo;,&rdquo;F&rdquo;)]</span></p><p class="c17"><span class="c1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</span></p><p class="c17 c25"><span class="c1"></span></p><p class="c17"><span class="c1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>Comme pour les objets &ldquo;normaux&rdquo;, on d&eacute;finit un &ldquo;presenter&rdquo; pour les items du tableau:</span></p><p class="c3"><span></span></p><p class="c12"><span class="c4 c8">&lt;</span><span class="c4 c10">div</span><span class="c4 c8">&nbsp;</span><span class="c4 c5">data-role</span><span class="c4 c8">=&rdquo;presenters&rdquo;&gt;</span></p><p class="c17"><span class="c4 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;!-- le presenter pour afficher les donn&eacute;es du tableau -- &gt;</span></p><p class="c17"><span class="c4 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span class="c4 c10">div</span><span class="c4 c8">&nbsp;</span><span class="c4 c5">id</span><span class="c4 c8">=&rdquo;client_item_presenter&rdquo; </span><span class="c4 c5">data-role</span><span class="c4 c8">=&rdquo;presenter&rdquo;&gt;</span></p><p class="c12 c19"><span class="c4 c8">&lt;--ici, on n&rsquo;utilise pas un div mais un LI puisqu&rsquo;on veut afficher dans un UL--&gt;</span></p><p class="c17"><span class="c4 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span class="c4 c10">li</span><span class="c4 c8">&gt;</span></p><p class="c17"><span class="c4 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span class="c4 c10">span</span><span class="c4 c8">&gt;Nom: </span><span class="c0">{binding from:nom}</span><span class="c4 c8">&lt;/</span><span class="c4 c10">span</span><span class="c4 c8">&gt;&amp;nbsp;</span></p><p class="c17"><span class="c4 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span class="c4 c10">span</span><span class="c4 c8">&gt;Pr&eacute;nom: </span><span class="c0">{binding from:prenom}</span><span class="c4 c8">&lt;/</span><span class="c4 c10">span</span><span class="c4 c8">&gt;</span></p><p class="c17"><span class="c4 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/</span><span class="c4 c10">li</span><span class="c4 c8">&gt;</span></p><p class="c17"><span class="c4 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/</span><span class="c4 c10">div</span><span class="c4 c8">&gt;</span></p><p class="c17"><span class="c4 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/</span><span class="c4 c10">div</span><span class="c4 c8">&gt;</span></p><p class="c17 c25"><span class="c4 c8"></span></p><p class="c3"><span></span></p><p class="c16 c18"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Et dans la page HTML, on demande a afficher la liste par un binding:</span></p><p class="c3"><span></span></p><p class="c16 c18"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span class="c10">ul</span><span>&gt;</span><span class="c1">{binding from:clients</span><span class="c15 c1">&nbsp;item_presenter:client_item_presenter</span><span class="c1">}</span><span>&lt;/</span><span class="c10">ul</span><span>&gt;</span></p><p class="c3"><span></span></p><p class="c16 c18"><span>Pour chaque &eacute;l&eacute;ment du tableau &ldquo;clients&rdquo;, le framework va rechercher le data-type correspondant &agrave; l&rsquo;item courant dans le presenter &ldquo;client_item_presenter&rdquo;. Une fois trouv&eacute;, il renseigne les bindings pr&eacute;sents avec les donn&eacute;es de l&rsquo;item courant,(ie: clients[0], clients[1]...) puis rajoute a l&rsquo;&eacute;l&eacute;ment &lt;UL&gt; le code HTML g&eacute;n&eacute;r&eacute; pour l&rsquo;item. (j&#39;esp&egrave;re &ecirc;tre clair&hellip;). Ainsi de suite pour tous les &eacute;l&eacute;ments du tableau.</span></p><p class="c3"><span></span></p><p class="c16 c18"><span class="c1">Modification du tableau et mise &agrave; jour de l&rsquo;UI:</span></p><p class="c3"><span></span></p><p class="c16 c18"><span>Les m&eacute;thodes support&eacute;es par le framework pour la manipulation des tableaux, cad qui mettront automatiquement &agrave; jour l&rsquo;UI, sont:</span></p><p class="c16 c18"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">Array.push</span><span>: ajoute un ou plusieurs &eacute;l&eacute;ments &agrave; la fin du tableau</span></p><p class="c16 c18"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">Array.pop</span><span>: supprime le dernier &eacute;l&eacute;ment du tableau</span></p><p class="c16 c18"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">Array.unshift</span><span>: ajoute au d&eacute;but du tableau</span></p><p class="c16 c18"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">Array.shift</span><span>: supprime en d&eacute;but de tableau</span></p><p class="c17 c19 c18"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c1">Array.splice</span><span>: supprime et ajoute &agrave; un index </span></p><p class="c17 c19 c18"><span class="c32">Note: ce sont les m&eacute;thodes de manipulation les plus utilis&eacute;es, mais on pourra toujours en rajouter au besoin </span></p><p class="c3"><span></span></p><p class="c16 c18"><span class="c1">Le cas de l&rsquo;op&eacute;rateur [ ]:</span></p><p class="c16 c18"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Malheureusement, je n&rsquo;ai pas trouv&eacute;, avec ECMAScript 5, une fa&ccedil;on de mettre &agrave; jour l&rsquo;UI automatiquement lors de l&rsquo;assignation d&rsquo;une valeur dans un tableau en utilisant l&#39;op&eacute;rateur [ ]. ECMAScript 6, avec la cr&eacute;ation des Proxy, semblerai permettre de r&eacute;soudre le probl&egrave;me&hellip; En attendant son adoption par tous les navigateurs, j&rsquo;ai </span><span class="c1">rajout&eacute; aux objets de type Array une m&eacute;thode set(item, index)</span><span>&nbsp;qui permet de modifier un &eacute;l&eacute;ment d&rsquo;un tableau par son index et de mettre &agrave; jour l&rsquo;UI. </span></p><p class="c3"><span></span></p><p class="c3"><span></span></p><p class="c3"><span></span></p><p class="c3"><span></span></p><p class="c3"><span></span></p><p class="c16 c18"><span class="c1">Data-type et valeur NULL:</span></p><p class="c3"><span class="c1"></span></p><p class="c16"><span>D&eacute;finir</span><span>&nbsp;un item_presenter est exactement la m&ecirc;me chose que d&eacute;finir un presenter normal. Vous pouvez aussi utiliser des data-types avec! &nbsp;La gestion du fallback diff&egrave;re l&eacute;g&egrave;rement par rapport aux objets: </span><span class="c1">le param&egrave;tre fallback</span><span>&nbsp;dans le binding sert a </span><span class="c1">g&eacute;rer le cas ou la propri&eacute;t&eacute;(le tableau) est nulle</span><span>, le </span><span class="c1">data-type=&rdquo;fallback&rdquo;</span><span>&nbsp;sert lui a g&eacute;rer le cas ou </span><span class="c1">un item du tableau serait null</span><span>!</span></p><p class="c3"><span></span></p><p class="c3"><span></span></p><p class="c16 c18"><span class="c1">Data-type 2:</span><span class="c15 c1">&nbsp;</span><span class="c1">Lier un tableau de valeurs simples:</span></p><p class="c3"><span class="c1"></span></p><p class="c16 c18"><span>&nbsp;imaginons qu&#39;on d&eacute;finisse une propri&eacute;t&eacute; dont la valeur serait un tableau de valeurs simples (cad de primitives: number, string&hellip;) : </span></p><p class="c16 c19 c18"><span class="c0 c30">ma_prop </span><span class="c0 c30">:</span><span class="c0 c30">&nbsp;</span><span class="c0 c30">[</span><span class="c0 c30">&quot;une&quot;</span><span class="c0 c30">,</span><span class="c0 c30">&quot;liste&quot;</span><span class="c0 c30">,</span><span class="c0 c30">2</span><span class="c0 c30">,</span><span class="c0 c30">&quot;valeurs&quot;</span><span class="c0 c30">];</span><span>, </span></p><p class="c16 c18"><span>Comme c&#39;est un tableau, on devra utiliser un &ldquo;presenter&rdquo; pour l&#39;affichage. Or, dans un &ldquo;presenter&rdquo;, le contexte de donn&eacute;es change, il deviendra donc tour a tour &quot;une&quot;, puis &quot;liste&quot;, puis 2, puis... Dans ce cas, ce qui nous int&eacute;resse n&#39;est pas d&#39;afficher une propri&eacute;t&eacute; du contexte (de String ou Number), mais le contexte lui m&ecirc;me! Le param&egrave;tre </span><span class="c1">from</span><span>&nbsp;accepte une valeur particuli&egrave;re: </span><span class="c1">$this</span><span>. Lorsqu&#39;il rencontre cette valeur, cela indique au moteur de binding d&#39;afficher une repr&eacute;sentation du contexte sous forme de String.</span></p><p class="c7 c40"><span class="c4 c30"><br></span><span class="c4">&nbsp; &nbsp; </span><span class="c4 c8">&lt;</span><span class="c4 c10">div </span><span class="c4 c5">data-role</span><span class="c4 c8">=&quot;</span><span class="c4 c21">presenters</span><span class="c4 c8">&quot;&gt;</span><span class="c4"><br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c4 c8">&lt;</span><span class="c4 c10">div </span><span class="c4 c5">data-role</span><span class="c4 c8">=&quot;</span><span class="c4 c21">presenter</span><span class="c4 c8">&quot;</span><span class="c4 c10">&nbsp;</span><span class="c4 c5">id</span><span class="c4 c8">=&quot;</span><span class="c4 c21">monPresenter</span><span class="c4 c8">&quot;&gt;</span><span class="c4"><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c4 c8">&lt;</span><span class="c4 c10">li</span><span class="c4 c8">&gt;</span><span class="c4">{binding from:$this}</span><span class="c4 c8">&lt;/</span><span class="c4 c10">li</span><span class="c4 c8">&gt;</span><span class="c4"><br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c4 c8">&lt;</span><span class="c4 c10">div</span><span class="c4 c8">&gt;</span><span class="c4"><br></span><span class="c4 c30">&nbsp; &nbsp;</span></p><p class="c16"><span>Notez que m&ecirc;me avec des types simples, on peut d&eacute;finir des data-types pour g&eacute;rer les diff&eacute;rents cas s&eacute;par&eacute;ment:</span></p><p class="c7 c40"><span class="c4 c30"><br></span><span class="c4">&nbsp; &nbsp; </span><span class="c4 c8">&lt;</span><span class="c4 c10">div </span><span class="c4 c5">data-role</span><span class="c4 c8">=&quot;</span><span class="c4 c21">presenters</span><span class="c4 c8">&quot;&gt;</span><span class="c4"><br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c4 c8">&lt;</span><span class="c4 c10">div </span><span class="c4 c5">data-role</span><span class="c4 c8">=&quot;</span><span class="c4 c21">presenter</span><span class="c4 c8">&quot;</span><span class="c4 c10">&nbsp;</span><span class="c4 c5">id</span><span class="c4 c8">=&quot;</span><span class="c4 c21">monPresenter</span><span class="c4 c8">&quot;&gt;</span><span class="c4"><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c4 c8">&lt;</span><span class="c4 c10">li</span><span class="c4 c8">&gt;&lt;span&gt;</span><span class="c4">{binding from:$this}&lt;/span&gt;</span><span class="c4 c8">&lt;/</span><span class="c4 c10">li</span><span class="c4 c8">&gt;</span><span class="c4"><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c4 c8">&lt;</span><span class="c4 c10">li </span><span class="c4 c5">data-type</span><span class="c4 c8">=&quot;</span><span class="c4 c21">Number</span><span class="c4 c8">&quot;&gt;&lt;span&gt;</span><span class="c4">un nombre: {binding from:$this}&lt;/span&gt;</span><span class="c4 c8">&lt;/</span><span class="c4 c10">li</span><span class="c4 c8">&gt;</span><span class="c4"><br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c4 c8">&lt;</span><span class="c4 c10">div</span><span class="c4 c8">&gt;</span></p><p class="c7"><span class="c4 c8">&lt;</span><span class="c4 c10">div</span><span class="c4 c8">&gt;</span><span class="c4"><br></span></p><p class="c7"><span class="c4 c30">&nbsp;</span></p><p class="c16 c18"><span class="c1">Param&egrave;tre deep:</span></p><p class="c3"><span></span></p><p class="c16 c18"><span>Par d&eacute;faut, </span><span class="c1">tout objet affich&eacute; par un binding</span><span>&nbsp;va subir un traitement pour permettre de mettre &agrave; jour l&rsquo;UI </span><span class="c1">lors de la modification d&rsquo;une de ses propri&eacute;t&eacute;s internes.</span><span>&nbsp;(Par exemple, si vous afficher un objet Client par un &ldquo;presenter&rdquo; puis que vous en modifier le nom par myContext.monclient.nom = &ldquo;nouveau nom&rdquo;, le binding associ&eacute; a la propri&eacute;t&eacute; &ldquo;nom&rdquo; de l&rsquo;instance &ldquo;monclient&rdquo; de la classe &ldquo;Client&rdquo; lancera une mise &agrave; jour de l&rsquo;UI pour le refl&eacute;ter). </span><span class="c1">Lors de l&rsquo;affichage d&rsquo;un tableau, le m&ecirc;me processus &agrave; lieu pour tous les items du tableau</span><span>&nbsp;(sauf les types primitifs), ce qui peut devenir lourd, surtout dans le cas ou on veut juste afficher une liste non modifiable (pour permettre &agrave; l&rsquo;utilisateur d&rsquo;en s&eacute;lectionner un item, par exemple).</span></p><p class="c16 c18"><span>On peut alors passer le param&egrave;tre</span><span class="c1">&nbsp;deep:false </span><span>au binding pour lui indiquer de </span><span class="c1">consid&eacute;rer le tableau (ou l&rsquo;objet) comme une propri&eacute;t&eacute; primitive</span><span>&nbsp;(comme un String ou un Number), </span><span>et donc de ne pas prendre en compte les modifications de ses propri&eacute;t&eacute;s internes.</span></p><h1 class="c17 c33" id="h.enp31xnb5b4c"><span>7:</span><span>&nbsp;Commandes:</span></h1><p class="c17 c18"><span class="c14">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c14 c22"><a class="c34" href="https://www.google.com/url?q=http://exemples/commands.html&amp;sa=D&amp;ust=1456995045165000&amp;usg=AFQjCNGlxKb1uZs86L-VtjiHuqsn5kN2eQ">commands</a></span><span class="c22"><a class="c34" href="https://www.google.com/url?q=http://exemples/commands.html&amp;sa=D&amp;ust=1456995045165000&amp;usg=AFQjCNGlxKb1uZs86L-VtjiHuqsn5kN2eQ">.html</a></span></p><p class="c17 c25 c18"><span></span></p><p class="c17 c18"><span class="c14">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>Celui ci permet de lier</span><span class="c46">&nbsp;</span><span class="c15 c1">une m&eacute;thode du contexte de donn&eacute;es global</span><span class="c46">&nbsp;</span><span>a un &eacute;v&egrave;nement javascript quelconque. </span><span>Pour lier un event a une commande, la notation est:</span></p><p class="c17 c49"><span class="c4 c8">&lt;</span><span class="c4 c10">tagname </span><span class="c4 c5">data-bind-eventName </span><span class="c4 c8">= &quot;</span><span class="c4 c21">{binding command:nom_methode command_params:param}</span><span class="c4 c8">&quot;&gt;</span></p><p class="c13"><span class="c4 c8"></span></p><p class="c16"><span>Les diff&eacute;rents param&egrave;tres, pour un binding de commande, sont:</span></p><ul class="c28 lst-kix_q4c96w6aejbw-0 start"><li class="c17 c26 c19"><span class="c15 c1">command</span><span>: Obligatoire, le nom de la m&eacute;thode du contexte de donn&eacute;e global &agrave; lier a l&#39;event. Cette m&eacute;thode prend en arguments:</span></li></ul><ul class="c28 lst-kix_q4c96w6aejbw-1 start"><li class="c17 c29 c26"><span>@param evt: l&#39;objet event g&eacute;n&eacute;r&eacute;</span></li><li class="c17 c29 c26"><span>@param args: param&egrave;tre optionnel (tableau si plusieurs)</span></li></ul><ul class="c28 lst-kix_q4c96w6aejbw-0"><li class="c17 c26 c19"><span class="c15 c1">command_params</span><span>: optionnel, des param&egrave;tres pour la commande (m&ecirc;me fonctionnement que les param&egrave;tres pour converter)</span></li><li class="c17 c26 c19"><span class="c15 c1">converter</span><span>: optionnel, si renseign&eacute;, une m&eacute;thode globale pour d&eacute;terminer le nom de la m&eacute;thode avant la liaison.</span></li></ul><ul class="c28 lst-kix_q4c96w6aejbw-1 start"><li class="c17 c29 c26"><span>@param: value: la valeur a convertir</span></li><li class="c17 c29 c26"><span>@param converter_params: param&egrave;tres optionnels</span></li></ul><ul class="c28 lst-kix_q4c96w6aejbw-0"><li class="c17 c26 c19"><span class="c15 c1">converter_params</span><span>: optionnel, permet de passer des param&egrave;tres a la m&eacute;thode de conversion.</span></li></ul><p class="c17 c25 c18"><span></span></p><p class="c17 c18"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">L&rsquo;eventName </span><span>correspond au </span><span class="c1">nom de l&rsquo;event javascript</span><span>&nbsp;auquel la commande souhaite r&eacute;agir (par exemple, pour r&eacute;agir &agrave; un click, on &eacute;crira </span><span class="c1">data-bind-click = {binding&hellip;.}</span><span>&nbsp;)</span></p><p class="c3"><span class="c14"></span></p><p class="c16 c18"><span>Pour donner un exemple de fonctionnement des commandes, on va reprendre (encore) nos clients&hellip; On va afficher une liste de clients, avec </span><span class="c1">dans l&rsquo;item_presenter une commande pour pouvoir supprimer ce client</span><span>, et dans la page, </span><span class="c1">une commande pour pouvoir en ajouter un nouveau</span><span>&nbsp;(toujours en dur&hellip;).</span></p><p class="c3"><span></span></p><p class="c3"><span></span></p><p class="c16 c18"><span class="c32 c1">javascript:</span></p><p class="c3"><span></span></p><p class="c16 c18"><span class="c1">function Client (n,p,s){</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c5 c1">//on ajoute un identifiant unique au client (comme s&#39;il provenait d&#39;une base de donn&eacute;es par exemple)</span></p><p class="c16 c18"><span class="c5 c1">&nbsp; &nbsp; &nbsp; //generateUUID() est une m&eacute;thode d&eacute;finie dans le framework qui fait ce que son nom indique...</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; this.id = generateUUID();</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; this.nom = n;</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; this.prenom = p;</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; this.sexe=s;</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; };</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; function myContext () { &nbsp;</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c5 c1">//une liste de clients renseign&eacute;e par d&eacute;faut</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.clients= [ new Client(&quot;MANSON&quot;,&quot;Marylin&quot;,&quot;???&quot;),</span></p><p class="c16 c24 c18"><span class="c1">new Client(&quot;MALLOW&quot;,&quot;Marc&quot;,&quot;M&quot;),</span></p><p class="c16 c24 c18"><span class="c1">&nbsp;new Client(&quot;DALTON&quot;,&quot;M&#39;a&quot;,&quot;F&quot;)],</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; };</span></p><p class="c3"><span class="c1"></span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c5 c1">//On d&eacute;fini les m&eacute;thodes pour les commandes</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c5 c1">//param&egrave;tres: evt: l&#39;objet event g&eacute;n&eacute;r&eacute; (ici ClickEvent), et les param&egrave;tres optionnels</span></p><p class="c16 c18"><span class="c5 c1">&nbsp; &nbsp; &nbsp; &nbsp; //comme je ne d&eacute;fini qu&#39;un seul param&egrave;tre -id- je le &nbsp;r&eacute;cup&egrave;re directement,</span></p><p class="c16 c18"><span class="c5 c1">&nbsp; &nbsp; &nbsp; &nbsp; //si j&#39;en avait d&eacute;fini plusieurs, on aurait eu un tableau</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; myContext.prototype.delete_client = function(evt, id){</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c5 c1">//recherche l&#39;index du client a supprimer</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for (i=0;i&lt;this.clients.length;i++){</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c5 c1">&nbsp;//si l&#39;id est le bon</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (this.clients[i].id == id){</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c5 c1">&nbsp;//supprime le du tableau</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; this.clients.splice(i,1);</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c3"><span class="c1"></span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; myContext.prototype.add_client = function(evt){</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c5 c1">&nbsp;//ajoute un nouveau client &agrave; la liste, en dur pour l&#39;instant...</span></p><p class="c16 c18"><span class="c5 c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //le fait d&#39;appeller push sur mon tableau suffit a mettre a jour l&#39;UI!!!</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; this.clients.push(new Client(&quot;NOUVEAU&quot;,&quot;Client&quot;,&quot;F&quot;));</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; };</span></p><p class="c3"><span></span></p><p class="c16 c18"><span class="c32 c1">html:</span></p><p class="c3"><span></span></p><p class="c16 c18"><span>&lt;</span><span class="c10">body</span><span>&nbsp;</span><span class="c5">data-context</span><span>=</span><span class="c21">&quot;myContext&quot;</span><span>&gt;</span></p><p class="c16 c18"><span>&nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c10">div</span><span>&nbsp;</span><span class="c5">data-role</span><span>=</span><span class="c21">&quot;presenters&quot;</span><span>&gt;</span></p><p class="c16 c18"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c2">&lt;!-- le presenter pour afficher les donn&eacute;es du tableau --&gt;</span></p><p class="c16 c18"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span class="c10">div</span><span>&nbsp;</span><span class="c5">id</span><span>=</span><span class="c21">&quot;client_item_presenter&quot;</span><span>&nbsp;</span><span class="c5">data-role</span><span>=</span><span class="c21">&quot;presenter&quot;</span><span>&gt;</span></p><p class="c16 c18"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c2">&lt;!--ici, on n&#39;utilise pas un div mais un LI puisqu&#39;on veut afficher dans un UL--&gt;</span></p><p class="c3"><span class="c2"></span></p><p class="c16 c18"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span class="c10">li</span><span>&gt;</span></p><p class="c16 c18"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span class="c10">span</span><span>&gt;Nom: </span><span class="c1">{binding from:nom}</span><span>&lt;/</span><span class="c10">span</span><span>&gt;&amp;nbsp;</span></p><p class="c16 c18"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span class="c10">span</span><span>&gt;Pr&eacute;nom: </span><span class="c1">{binding from:prenom}</span><span>&lt;/</span><span class="c10">span</span><span>&gt;&amp;nbsp;</span></p><p class="c16 c18"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2">&nbsp;&lt;!-- On cree une commande qui prend en parametre optionnel l&#39;identifiant du client pour pouvoir le retrouver --&gt;</span></p><p class="c16 c18"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c10">a</span><span>&nbsp;</span><span class="c5">href</span><span>=</span><span class="c21">&quot;#&quot;</span><span>&nbsp;</span><span class="c5">data-binded-click</span><span>=&quot;</span><span class="c1">{binding command:delete_client command_params:$id}</span><span>&quot;&gt;Supprimer&lt;/</span><span class="c10">a</span><span>&gt;</span></p><p class="c16 c18"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/</span><span class="c10">li</span><span>&gt;</span></p><p class="c16 c18"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/</span><span class="c10">div</span><span>&gt;</span></p><p class="c16 c18"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c16 c18"><span>&nbsp; &nbsp; &nbsp; &nbsp; &lt;/</span><span class="c10">div</span><span>&gt;</span></p><p class="c16 c18"><span>&nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c10">h3</span><span>&gt;Une simple liste de clients:&lt;/</span><span class="c10">h3</span><span>&gt;</span></p><p class="c16 c18"><span>&nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c10">ul</span><span>&gt;</span><span class="c1">{binding from:clients item_presenter:client_item_presenter}</span><span>&lt;/</span><span class="c10">ul</span><span>&gt;</span></p><p class="c16 c18"><span>&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2">&lt;-- ici, une commande simple sans param&egrave;tres --&gt; </span></p><p class="c16 c18"><span>&nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c10">a </span><span class="c5">href</span><span>=</span><span class="c21">&quot;#&quot;</span><span>&nbsp;</span><span class="c5">data-binded-click</span><span>=&quot;</span><span class="c1">{binding command:add_client}</span><span>&quot;&gt;Ajouter un client&lt;/</span><span class="c10">a</span><span>&gt;</span></p><p class="c16 c18"><span>&nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c16 c18"><span>&nbsp; </span></p><p class="c16 c18"><span>&nbsp; &lt;/</span><span class="c10">body</span><span>&gt;</span></p><p class="c3"><span></span></p><p class="c3"><span></span></p><p class="c3"><span></span></p><p class="c3"><span></span></p><h1 class="c17 c33" id="h.31stu1p9znmy"><span>8: Input binding: r&eacute;cup&eacute;rer les informations de l&rsquo;utilisateur:</span></h1><p class="c17 c25"><span></span></p><p class="c17"><span class="c22"><a class="c34" href="https://www.google.com/url?q=http://exemples/2way.html&amp;sa=D&amp;ust=1456995045191000&amp;usg=AFQjCNH-IwYgmNbElGblWkZL-GidAyXEsA">2way.html</a></span></p><p class="c17 c25"><span></span></p><p class="c17 c25"><span></span></p><p class="c17 c18"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Maintenant qu&rsquo;on sait afficher des donn&eacute;es provenant d&rsquo;objets javascript, et interagir avec eux via des commandes, on va voir comment</span><span class="c1">&nbsp;r&eacute;cup&eacute;rer des informations entr&eacute;es par l&rsquo;utilisateur gr&acirc;ce aux bindings mode 2way</span><span>.</span></p><p class="c17 c18"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p class="c17 c18"><span class="c14">notation: </span><span class="c14 c1">data-binded-value=&rdquo;{binding from:... mode:2way &nbsp; event:...}&rdquo;</span></p><p class="c17 c25 c18"><span class="c1"></span></p><p class="c16 c18"><span class="c14">Les diff&eacute;rents param&egrave;tres sont:</span></p><p class="c3"><span class="c14"></span></p><ul class="c28 lst-kix_597z9mq2fg8h-0"><li class="c17 c26 c19"><span class="c14 c15 c1">from</span><span class="c14">: Obligatoire, le nom de la propri&eacute;t&eacute; &agrave; lier</span></li><li class="c17 c26 c19"><span class="c14 c15 c1">converter</span><span class="c14">: optionnel, si renseign&eacute;, une m&eacute;thode globale pour convertir la donn&eacute;e avant la liaison.</span></li></ul><ul class="c28 lst-kix_597z9mq2fg8h-1 start"><li class="c17 c29 c26"><span class="c14">@param: value: la valeur a convertir</span></li><li class="c17 c29 c26"><span class="c14">@param converter_params: param&egrave;tres optionnels</span></li></ul><ul class="c28 lst-kix_597z9mq2fg8h-0"><li class="c17 c26 c19"><span class="c14 c15 c1">converter_params</span><span class="c14">: optionnel, permet de passer des param&egrave;tres a la m&eacute;thode de conversion.</span></li><li class="c17 c26 c19"><span class="c14 c15 c1">fallback</span><span class="c14">: optionnel, si value==null, affichera le fallback a la place (placeholder)</span></li><li class="c17 c26 c19"><span class="c14 c15 c1">alt</span><span class="c14">: optionnel, exp&eacute;rimental, permet de lier ce binding a une autre cl&eacute; que celle de la propri&eacute;t&eacute;</span></li><li class="c17 c26 c19"><span class="c14 c15 c1">mode=2way: </span><span class="c14 c1">obligatoire, permet de noter l&rsquo;input</span></li><li class="c17 c26 c19"><span class="c14 c15 c1">event</span><span class="c14">: par </span><span>d&eacute;faut</span><span class="c14">&nbsp;</span><span class="c14 c1">blur</span><span class="c14">, event sur lequel r&eacute;agir pour prendre en compte les changements</span></li></ul><p class="c17 c25 c18"><span class="c14"></span></p><p class="c17 c18"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Pour qu&rsquo;un binding mode 2way puisse fonctionner, il doit se faire sur </span><span class="c1">un &eacute;l&eacute;ment HTML poss&eacute;dant une propri&eacute;t&eacute; contenant la valeur de l&rsquo;input</span><span>&nbsp;(en r&egrave;gle g&eacute;n&eacute;rale VALUE) et </span><span class="c1">g&eacute;n&eacute;rant des events lors de sa modification</span><span>. (Ce qui est le cas pour les &eacute;l&eacute;ment &lt;INPUT&gt; par exemple).</span></p><p class="c17 c18"><span class="c14">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Notation:</span></p><p class="c17 c25 c18"><span></span></p><p class="c17 c38"><span class="c5 c1">data-binded-nom_de_la_propriete</span><span class="c1">&nbsp;= {binding from:... mode:2way}</span></p><p class="c17 c38 c25"><span class="c1"></span></p><p class="c17 c25 c38"><span class="c1"></span></p><p class="c16"><span class="c1">1: un simple exemple de binding: cr&eacute;er/&eacute;diter un client</span></p><p class="c16"><span class="c1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>Comme on ne change pas une &eacute;quipe qui gagne, reprenons notre liste de client et modifions le code pour int&eacute;grer un formulaire pour pouvoir ajouter/mettre &agrave; jour les informations. </span></p><p class="c16 c18"><span>&nbsp;</span></p><p class="c16 c18"><span class="c2">&lt;!DOCTYPE html&gt;</span></p><p class="c16 c18"><span class="c2">&lt;</span><span class="c10">head</span><span class="c2">&gt;</span></p><p class="c16 c18"><span class="c2">&nbsp; &lt;</span><span class="c10">meta</span><span class="c2">&nbsp;</span><span class="c5">charset</span><span class="c2">=&quot;utf-8&quot;&gt;</span></p><p class="c16 c18"><span class="c2">&nbsp; &lt;</span><span class="c10">title</span><span class="c2">&gt;Fear the walking web! Demos&lt;/</span><span class="c10">title</span><span class="c2">&gt;</span></p><p class="c3"><span class="c2"></span></p><p class="c16 c18"><span class="c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span class="c10">script</span><span class="c2">&nbsp;</span><span class="c5">src</span><span class="c2">=&quot;../../fear-the-walking-web-flesh-and-bones.js&quot;&gt;&lt;/</span><span class="c10">script</span><span class="c2">&gt;</span></p><p class="c16 c18"><span class="c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span class="c10">script</span><span class="c2">&gt;</span></p><p class="c16 c18"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c1">function Client (n,p,s){</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c5 c1">&nbsp;//on ajoute un identifiant unique au client (comme s&#39;il provenait d&#39;une base de donn&eacute;es par exemple)</span></p><p class="c16 c18"><span class="c5 c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //generateUUID() est une methode d&eacute;finie dans le framework qui fait ce que son nom indique...</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; this.id = generateUUID();</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; this.nom = n;</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; this.prenom = p;</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; this.sexe=s;</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; };</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; function myContext () { &nbsp;</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c5 c1">//une liste de clients renseign&eacute;e par d&eacute;faut</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; this.clients = [ new Client(&quot;MANSON&quot;,&quot;Marylin&quot;,&quot;U&quot;),new Client(&quot;MALLOW&quot;,&quot;Marc&quot;,&quot;M&quot;), new Client(&quot;DALTON&quot;,&quot;M&#39;a&quot;,&quot;F&quot;)],</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c5 c1">//le client s&eacute;lectionn&eacute; &agrave; &eacute;diter</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; this.</span><span class="c15 c1">selected = null,</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; };</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; myContext.prototype.delete_client = function(evt, id){</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c5 c1">&nbsp;//recherche l&#39;index du client a supprimer</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for (i=0;i&lt;this.clients.length;i++){</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c5 c1">&nbsp;//si l&#39;id est le bon</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (this.clients[i].id == id){</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c5 c1">//supprime le du tableau</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; this.clients.splice(i,1);</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; myContext.prototype.add_client = function(evt){</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c5 c1">//ajoute un nouveau client &agrave; la liste</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cl = new Client(&quot;NOUVEAU&quot;,&quot;Client&quot;,&quot;F&quot;);</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; this.clients.push(cl);</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c5 c1">//s&eacute;lectionne le pour &eacute;dition</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c15 c1">&nbsp;this.selected = cl;</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; };</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c15 c1">&nbsp;myContext.prototype.edit_client = function(evt, id){</span></p><p class="c16 c18"><span class="c1 c15">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c5 c1">&nbsp;//comme pour le delete, recherche le client &agrave; editer</span></p><p class="c16 c18"><span class="c15 c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for (i=0;i&lt;this.clients.length;i++){</span></p><p class="c16 c18"><span class="c15 c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c5 c1">//si l&#39;id est le bon</span></p><p class="c16 c18"><span class="c15 c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (this.clients[i].id == id){</span></p><p class="c16 c18"><span class="c15 c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c5 c1">//Trouv&eacute;</span></p><p class="c16 c18"><span class="c15 c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; this.selected = this.clients[i];</span></p><p class="c16 c18"><span class="c15 c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;</span></p><p class="c16 c18"><span class="c15 c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c16 c18"><span class="c15 c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c16 c18"><span class="c15 c1">&nbsp; &nbsp; &nbsp; &nbsp; };</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c5 c1">&nbsp;//un converter pour determiner la classe CSS a appliquer lors de la selection d&rsquo;un client</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c15 c1">function is_selected (value, params){</span></p><p class="c16 c18"><span class="c15 c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c16 c18"><span class="c15 c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (value){</span></p><p class="c16 c18"><span class="c15 c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c16 c18"><span class="c15 c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c5 c1">&nbsp;//recupere l&#39;index de l&#39;objet</span></p><p class="c16 c18"><span class="c15 c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for (i=0;i&lt;myContext.clients.length;i++){</span></p><p class="c16 c18"><span class="c15 c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (myContext.clients[i].id == value.id){</span></p><p class="c16 c18"><span class="c15 c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c5 c1">//g&eacute;n&egrave;re la r&egrave;gle css a appliquer</span></p><p class="c16 c18"><span class="c15 c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; index = i+1;</span><span class="c5 c1">//nth-child commence &agrave; 1!</span></p><p class="c16 c18"><span class="c15 c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; style=&quot;.list li:nth-child(&quot;+index+&quot;){background:#E3E3E3;}&quot;;</span></p><p class="c16 c18"><span class="c15 c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return style;</span></p><p class="c16 c18"><span class="c15 c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c16 c18"><span class="c15 c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c16 c18"><span class="c15 c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c16 c18"><span class="c15 c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c16 c18"><span class="c15 c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return &quot; &quot;;</span><span class="c5 c1">//si pas de s&eacute;lection, renvoie vide</span></p><p class="c16 c18"><span class="c15 c1">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c16 c18"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c16 c18"><span class="c2">&nbsp; &lt;/</span><span class="c10">script</span><span class="c2">&gt;</span></p><p class="c16 c18"><span class="c2">&nbsp; </span></p><p class="c16 c18"><span class="c2">&nbsp; &lt;/</span><span class="c10">head</span><span class="c2">&gt;</span></p><p class="c11"><span class="c2">&nbsp; &lt;</span><span class="c10">body</span><span class="c2">&nbsp;</span><span class="c5">data-context</span><span class="c2">=&quot;myContext&quot;&gt;</span></p><p class="c11"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c10">div</span><span class="c2">&nbsp;</span><span class="c5">data-role</span><span class="c2">=&quot;presenters&quot;&gt;</span></p><p class="c11 c25"><span class="c2"></span></p><p class="c11 c25"><span class="c2"></span></p><p class="c11"><span class="c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;!-- le presenter pour afficher les donn&eacute;es du tableau --&gt;</span></p><p class="c11"><span class="c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span class="c10">div</span><span class="c2">&nbsp;</span><span class="c5">id</span><span class="c2">=&quot;client_item_presenter&quot; </span><span class="c5">data-role</span><span class="c2">=&quot;presenter&quot;&gt;</span></p><p class="c11"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;!--ici, on n&#39;utilise pas un div mais un LI puisqu&#39;on veut afficher dans un UL--&gt;</span></p><p class="c11 c25"><span class="c2"></span></p><p class="c11"><span class="c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span class="c10">li</span><span class="c2">&gt;</span></p><p class="c11"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;!-- on cr&eacute;e un lien avec 2 bindings: un sur l&#39;event clic et un sur le contenu du lien... --&gt;</span></p><p class="c11"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c10">a</span><span class="c2">&nbsp;</span><span class="c5">href</span><span class="c2">=&quot;#&quot; </span><span class="c5">data-binded-click</span><span class="c2">=&quot;</span><span>{binding command:edit_client command_params:$id}&quot;</span><span class="c2">&gt;Nom: </span><span>{binding from:nom}</span><span class="c2">&lt;/</span><span class="c10">a</span><span class="c2">&gt;&amp;nbsp;</span></p><p class="c11"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c10">span</span><span class="c2">&gt;Pr&eacute;nom:</span><span>&nbsp;{binding from:prenom}</span><span class="c2">&lt;/</span><span class="c10">span</span><span class="c2">&gt;&amp;nbsp;</span></p><p class="c11"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;!-- On cree une commande qui prend en parametre optionnel l&#39;identifiant du client pour pouvoir le retrouver --&gt;</span></p><p class="c11"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c10">a</span><span class="c2">&nbsp;</span><span class="c5">href</span><span class="c2">=&quot;#&quot; </span><span class="c5">data-binded-click</span><span class="c2">=&quot;</span><span>{binding command:delete_client command_params:$id}</span><span class="c2">&quot;&gt;Supprimer&lt;/</span><span class="c10">a</span><span class="c2">&gt;</span></p><p class="c11"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></p><p class="c11"><span class="c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/</span><span class="c10">li</span><span class="c2">&gt;</span></p><p class="c11"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/</span><span class="c10">div</span><span class="c2">&gt;</span></p><p class="c11 c25"><span class="c2"></span></p><p class="c11 c25"><span class="c2"></span></p><p class="c11 c25"><span class="c2"></span></p><p class="c11"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;!-- un presenter utilis&eacute; comme formulaire --&gt;</span></p><p class="c11"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c10">div</span><span class="c2">&nbsp;</span><span class="c5">id</span><span class="c2">=&quot;client_formulaire&quot; </span><span class="c5">data-role</span><span class="c2">=&quot;presenter&quot;&gt;</span></p><p class="c11"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c10">div</span><span class="c2">&gt;</span></p><p class="c11"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;!--on cree un binding 2way vers myContext.selected.nom a partir de la propri&eacute;t&eacute; VALUE de l&rsquo;input, et on demande la mise a jour de l&#39;UI par l&#39;event input (lors de la frappe) --&gt;</span></p><p class="c11"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c10">input</span><span class="c2">&nbsp;</span><span class="c5">type</span><span class="c2">=&quot;text&quot; </span><span class="c5">data-binded-value</span><span class="c2">=</span><span>&quot;{binding from:nom mode:2way fallback:&#39;Le nom du client&#39; event:input}&quot;</span><span class="c2">&gt;&lt;/</span><span class="c10">input</span><span class="c2">&gt;</span></p><p class="c11"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;!--on cree un binding 2way vers myContext.selected.prenom, et on demande la mise a jour de l&#39;UI par l&#39;event blur (par defaut) --&gt;</span></p><p class="c11"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c10">input</span><span class="c2">&nbsp;</span><span class="c5">type</span><span class="c2">=&quot;text&quot; </span><span class="c5">data-binded-value</span><span class="c2">=</span><span>&quot;{binding from:prenom mode:2way fallback:&#39;Le prenom du client&#39;}</span><span class="c2">&quot;&gt;&lt;/input&gt;</span></p><p class="c11"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c11"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;!-- binding avec un radiogroup: travaille a partir de la propri&eacute;t&eacute; CHECKED, c&#39;est un peu la seule facon de faire...--&gt;</span></p><p class="c11"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c10">input</span><span class="c2">&nbsp;</span><span class="c5">type</span><span class="c2">=&quot;radio&quot; </span><span class="c5">value</span><span class="c2">=&quot;M&quot; </span><span class="c5">data-binded-checked</span><span class="c2">=&quot;</span><span>{binding from:sexe mode:2way}</span><span class="c2">&quot; </span><span class="c5">name</span><span class="c2">=&quot;sexe&quot;&gt;Masculin&lt;/</span><span class="c10">input</span><span class="c2">&gt;</span></p><p class="c11"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c10">input</span><span class="c2">&nbsp;</span><span class="c5">type</span><span class="c2">=&quot;radio&quot; </span><span class="c5">value</span><span class="c2">=&quot;F&quot; </span><span class="c5">data-binded-checked</span><span class="c2">=&quot;</span><span>{binding from:sexe mode:2way}</span><span class="c2">&quot;</span><span class="c5">name</span><span class="c2">=&quot;sexe&quot; &gt;Feminin&lt;/</span><span class="c10">input</span><span class="c2">&gt;</span></p><p class="c11"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c10">input</span><span class="c2">&nbsp;</span><span class="c5">type</span><span class="c2">=&quot;radio&quot; </span><span class="c5">value</span><span class="c2">=&quot;U&quot; </span><span class="c5">data-binded-checked</span><span class="c2">=&quot;</span><span>{binding from:sexe mode:2way}</span><span class="c2">&quot; </span><span class="c5">name</span><span class="c2">=&quot;sexe&quot; &gt;Inconnu&lt;/</span><span class="c10">input</span><span class="c2">&gt;</span></p><p class="c11 c25"><span class="c2"></span></p><p class="c11 c25"><span class="c2"></span></p><p class="c11"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/</span><span class="c10">div</span><span class="c2">&gt;</span></p><p class="c11 c25"><span class="c2"></span></p><p class="c11 c25"><span class="c2"></span></p><p class="c11"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c10">div</span><span class="c2">&nbsp;</span><span class="c5">data-type</span><span class="c2">=&quot;fallback&quot;&gt;</span></p><p class="c11"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;!-- si le client est null, un simple message???? --&gt;</span></p><p class="c11"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c10">h3</span><span class="c2">&gt;Selectionnez un client pour l&#39;editer ou cliquez sur &quot;Ajouter un nouveau client&quot;&lt;/</span><span class="c10">h3</span><span class="c2">&gt;</span></p><p class="c11"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/</span><span class="c10">div</span><span class="c2">&gt;</span></p><p class="c11"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/</span><span class="c10">div</span><span class="c2">&gt;</span></p><p class="c11"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &lt;/</span><span class="c10">div</span><span class="c2">&gt;</span></p><p class="c11 c25"><span class="c2"></span></p><p class="c11 c25"><span class="c2"></span></p><p class="c11 c25"><span class="c2"></span></p><p class="c11 c25"><span class="c2"></span></p><p class="c11 c25"><span class="c2"></span></p><p class="c11"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &lt;!-- on tente le coup: generer un style par binding? </span></p><p class="c11"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp;Dommage qu&rsquo;il faille le d&eacute;clarer dans le body pour prendre en compte les bindings....--&gt;</span></p><p class="c11"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c10">style</span><span class="c2">&gt;</span><span>{binding from:selected converter:is_selected}</span><span class="c2">&lt;/</span><span class="c10">style</span><span class="c2">&gt;</span></p><p class="c11"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c11"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c11"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c10">h3</span><span class="c2">&gt;Une simple liste de clients:&lt;/</span><span class="c10">h3</span><span class="c2">&gt;</span></p><p class="c11"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c10">ul</span><span class="c2">&nbsp;</span><span class="c5">class</span><span class="c2">=&quot;list&quot;&gt;</span><span>{binding from:clients presenter:client_item_presenter}</span><span class="c2">&lt;/</span><span class="c10">ul</span><span class="c2">&gt;</span></p><p class="c11 c25"><span class="c2"></span></p><p class="c11"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp;&lt;!-- Un presenter pour le client selectionn&eacute; </span><span class="c2">--&gt;</span><span class="c2">&nbsp;</span></p><p class="c11"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c10">div</span><span class="c2">&gt;</span><span>{binding from:selected presenter:client_formulaire}</span><span class="c2">&lt;/</span><span class="c10">div</span><span class="c2">&gt;</span></p><p class="c11"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c10">a</span><span class="c2">&nbsp;</span><span class="c5">href</span><span class="c2">=&quot;#&quot; </span><span class="c5">data-binded-click</span><span class="c2">=&quot;</span><span>{binding command:add_client}</span><span class="c2">&quot;&gt;Ajouter un client&lt;/</span><span class="c10">a</span><span class="c2">&gt;</span></p><p class="c11"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c11"><span class="c2">&nbsp; </span></p><p class="c11"><span class="c2">&nbsp; &lt;/</span><span class="c10">body</span><span class="c2">&gt;</span></p><p class="c16 c18"><span class="c2">&lt;/</span><span class="c10">html</span><span class="c2">&gt;</span></p><p class="c16 c18"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p class="c3"><span></span></p><p class="c16"><span class="c1">2: quelques exemples d&rsquo;input binding:</span></p><p class="c16"><span class="c1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.1: input type=&rdquo;text, url,......&rdquo;</span></p><p class="c16"><span class="c1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>Le binding 2way permet de lier la propri&eacute;t&eacute; </span><span class="c1">VALUE</span><span>, l&rsquo;event par d&eacute;faut est </span><span class="c1">CHANGE</span><span>, pour sp&eacute;cifier une modification &agrave; chaque caract&egrave;re, on passera le param&egrave;tre </span><span class="c1">EVENT:INPUT</span></p><p class="c13"><span></span></p><p class="c11 c29"><span class="c2">&lt;</span><span class="c10">input</span><span class="c2">&nbsp;</span><span class="c5">type</span><span class="c2">=&quot;text&quot; </span><span class="c5">data-binded-value</span><span class="c2">=</span><span>&quot;{binding from:ma_prop</span></p><p class="c17 c23 c49"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mode:2way </span></p><p class="c12 c43"><span>fallback:&rsquo;valeur du placeholder&#39;}&quot;</span><span class="c2">&gt;&lt;/</span><span class="c10">input</span><span class="c2">&gt;</span></p><p class="c12 c25 c43"><span class="c2"></span></p><p class="c16"><span class="c1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.2 input type=&rdquo;radio&rdquo;</span></p><p class="c16"><span class="c1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>Le fonctionnement des radiogroups est un peu particulier&hellip; Par d&eacute;faut, la propri&eacute;t&eacute; &ldquo;int&eacute;ressante&rdquo; &nbsp; du radiogroup est </span><span class="c1">VALUE </span><span>(la valeur du radiobutton s&eacute;lectionn&eacute;), mais c&rsquo;est la propri&eacute;t&eacute; </span><span class="c1">CHECKED </span><span>qui permet de savoir quel radiobutton est actuellement s&eacute;lectionn&eacute;!</span></p><p class="c16"><span class="c1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>Par d&eacute;faut, l&rsquo;event utilis&eacute; est le </span><span class="c1">CLICK</span><span>.</span></p><p class="c13"><span></span></p><p class="c16"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c32">Note: les param&egrave;tres </span><span class="c32 c1">CONVERTER </span><span class="c32">et </span><span class="c32 c1">CONVERTER_PARAMS </span><span class="c32">sont utilis&eacute;s dans le framework pour d&eacute;terminer la valeur du radiogroup. C&rsquo;est mieux de ne pas les utiliser dans vos binding sur radiogroup. (En fait, le converter est une m&eacute;thode (nomm&eacute;e dans le framework check_radio_value, vers le d&eacute;but du fichier) qui prend en arguments la valeur de la propri&eacute;t&eacute; du data-context, et en argument optionnel la valeur du radiobutton cliqu&eacute;. Elle revoie TRUE si les 2 valeurs sont identiques)</span></p><p class="c13"><span class="c1"></span></p><p class="c16"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp;</span></p><p class="c11"><span class="c2">&lt;</span><span class="c10">input</span><span class="c2">&nbsp;</span><span class="c5">type</span><span class="c2">=&quot;radio&quot; </span><span class="c5">value</span><span class="c2">=&quot;M&quot; </span><span class="c5">data-binded-checked</span><span class="c2">=&quot;</span><span class="c1">{binding from:sexe mode:2way}</span><span class="c2">&quot; </span><span class="c5">name</span><span class="c2">=&quot;sexe&quot;&gt;Masculin&lt;/</span><span class="c10">input</span><span class="c2">&gt;</span></p><p class="c11 c25"><span class="c2"></span></p><p class="c11 c25"><span class="c2"></span></p><p class="c11 c25"><span class="c2"></span></p><p class="c16"><span class="c1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.3 input type=&rdquo;checkbox&rdquo;</span></p><p class="c16"><span class="c1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Comme pour les radiobuttons, les checkboxs doivent lier la propri&eacute;t&eacute; </span><span class="c1">CHECKED </span><span>pour conna&icirc;tre leur &eacute;tat. Pour une checkbox, </span><span class="c1">la propri&eacute;t&eacute; VALUE est ignor&eacute;e</span><span>, et le binding renverra </span><span class="c1">true/false </span><span>&nbsp;suivant l&rsquo;&eacute;tat de la checkbox.</span></p><p class="c13"><span></span></p><p class="c16"><span>&lt;</span><span class="c10">input</span><span>&nbsp;</span><span class="c5">id</span><span>=&quot;chk&quot; </span><span class="c5">type</span><span>=&quot;checkbox&quot; </span><span class="c5">data-binded-checked</span><span>=&quot;</span><span class="c1">{binding from:types mode:2way}</span><span>&quot;&gt;Check me!&lt;/input&gt;</span></p><p class="c16"><span>&nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c13"><span></span></p><p class="c13"><span></span></p><p class="c13"><span></span></p><p class="c13"><span></span></p><p class="c13"><span></span></p><p class="c16"><span class="c1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.4 input type=&rdquo;text&rdquo; list=&rdquo;...&rdquo;</span></p><p class="c13"><span class="c1"></span></p><p class="c16"><span class="c1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>Nouveau en HTML5,</span><span class="c1">&nbsp;</span><span>mais fonctionne de la m&ecirc;me fa&ccedil;on que les inputs text&hellip;. L&rsquo;event pris en compte par d&eacute;faut est </span><span class="c1">INPUT </span><span>(les changements sont pris en compte a chaque modification du texte)</span></p><p class="c13"><span></span></p><p class="c16"><span>&lt;</span><span class="c10">input</span><span>&nbsp;</span><span class="c5">type</span><span>=&quot;text&quot; </span><span class="c5">data-binded-value</span><span>=&quot;</span><span class="c1">{binding from:possible mode:2way fallback:fr}</span><span>&quot; </span><span class="c5">list</span><span>=&quot;myList&quot;&gt;&lt;/</span><span class="c10">input</span><span>&gt;</span></p><p class="c17 c19"><span>&lt;</span><span class="c10">datalist</span><span>&nbsp;</span><span class="c5">id</span><span>=&quot;myList&quot;&gt;</span></p><p class="c17 c19"><span>&lt;</span><span class="c10">option</span><span>&nbsp;</span><span class="c5">value</span><span>=&rdquo;fr&rdquo;&gt;Bonjour&lt;/</span><span class="c10">option</span><span>&gt;</span></p><p class="c17 c19"><span>&lt;</span><span class="c10">option</span><span>&nbsp;</span><span class="c5">value</span><span>=&rdquo;es&rdquo;&gt;Ola&lt;/</span><span class="c10">option</span><span>&gt;</span></p><p class="c17"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span class="c10">option</span><span>&nbsp;</span><span class="c5">value</span><span>=&rdquo;en&rdquo;&gt;Hello&lt;/</span><span class="c10">option</span><span>&gt;</span></p><p class="c17 c25"><span></span></p><p class="c17 c25"><span></span></p><p class="c17"><span class="c1">&nbsp; &nbsp; </span><span>&lt;/</span><span class="c10">datalist</span><span>&gt;</span></p><p class="c13"><span></span></p><p class="c13"><span></span></p><p class="c16"><span class="c32 c1">G&eacute;n&eacute;rer une datalist pour l&rsquo;input:</span></p><p class="c16"><span class="c32">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Comme pour n&rsquo;importe quel &eacute;l&eacute;ment HTML, on peut cr&eacute;er un binding sur une datalist pour afficher une liste de choix dynamiquement.</span></p><p class="c13"><span class="c32"></span></p><p class="c16"><span class="c32">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1 On cr&eacute;e dans notre data-context un tableau contenant les informations de la liste a afficher:</span></p><p class="c16"><span class="c32 c5">//on cr&eacute;e une liste d&rsquo;objets contenant les propri&eacute;t&eacute;s value: la valeur de l&rsquo;option et label: ce qu&rsquo;on affichera. C&rsquo;est juste pour l&rsquo;exemple, n&rsquo;importe quel objet fait l&rsquo;affaire.</span></p><p class="c16"><span class="c32 c1">this.</span><span class="c32 c1">possibles = [ {value:&quot;fr&quot;,label:&quot;Bonjour&quot;},{value:&quot;en&quot;,label:&quot;Hello&quot;},{value:&quot;es&quot;,label:&quot;Ola&quot;}]</span></p><p class="c13"><span class="c32"></span></p><p class="c16"><span class="c32">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2 On cr&eacute;e un presenter pour pouvoir afficher les informations des objets de la liste:</span></p><p class="c13"><span class="c32"></span></p><p class="c16"><span class="c32">&lt;</span><span class="c32 c10">div</span><span class="c32">&nbsp;</span><span class="c32 c5">id</span><span class="c32">=&quot;datalist_item_presenter&quot; </span><span class="c5 c32">data-role</span><span class="c32">=&quot;presenter&quot;&gt;</span></p><p class="c16"><span class="c32">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;</span><span class="c32 c10">option</span><span class="c32">&nbsp;</span><span class="c32 c5">value</span><span class="c32">=</span><span class="c32 c1">&quot;{binding from:value}&quot;</span><span class="c32">&gt;</span><span class="c32 c1">{binding from:label fallback:&#39;--&#39;}</span><span class="c32">&lt;/</span><span class="c32 c10">option</span><span class="c32">&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></p><p class="c16"><span class="c32">&nbsp;&lt;/</span><span class="c32 c10">div</span><span class="c32">&gt;</span></p><p class="c13"><span class="c32"></span></p><p class="c16"><span class="c32">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;3 et dans la page, on indique les bindings: comme on veut afficher un tableau, on utilise un item_presenter</span></p><p class="c13"><span class="c32"></span></p><p class="c16"><span class="c32">&lt;</span><span class="c32 c10">input</span><span class="c32">&nbsp;</span><span class="c32 c5">type</span><span class="c32">=&quot;text&quot; </span><span class="c32 c5">data-binded-value</span><span class="c32">=&quot;</span><span class="c32 c1">{binding from:possible mode:2way fallback:fr}</span><span class="c32">&quot; </span><span class="c32 c5">list</span><span class="c32">=&quot;myList&quot;&gt;&lt;/</span><span class="c32 c10">input</span><span class="c32">&gt;</span></p><p class="c17 c19"><span class="c32">&lt;</span><span class="c32 c10">datalist</span><span class="c32">&nbsp;</span><span class="c32 c5">id</span><span class="c32">=&quot;myList&quot;&gt;</span><span class="c32 c1">{binding from:possibles presenter:datalist_item_presenter} &nbsp; &nbsp;</span><span class="c32">&lt;/</span><span class="c32 c10">datalist</span><span class="c32">&gt;</span></p><p class="c13"><span></span></p><p class="c13"><span></span></p><p class="c13"><span></span></p><p class="c17 c25"><span></span></p><p class="c16"><span class="c1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.5 select</span></p><p class="c16"><span class="c1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>L&rsquo;utilisation du select se fait comme pour un input type=&rdquo;text&rdquo;. L&rsquo;event par d&eacute;faut est </span><span class="c1">CHANGE </span><span>et on peut aussi faire un binding sur les options &agrave; afficher dans le select&hellip;</span></p><p class="c13"><span></span></p><p class="c17"><span>&nbsp; &nbsp; &lt;</span><span class="c10">select</span><span>&nbsp;</span><span class="c5">data-binded-value</span><span>=&quot;</span><span class="c1">{binding from:possible mode:2way}</span><span>&quot;&gt;</span><span class="c1">{binding from:possibles presenter:datalist_item_presenter}</span><span>&lt;/select&gt;</span></p><p class="c13"><span></span></p><p class="c13"><span></span></p><p class="c16 c18"><span class="c1">3: v&eacute;rification des inputs et getter/setters et formulaires:</span></p><p class="c3"><span class="c1"></span></p><p class="c16 c18"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;La validation des entr&eacute;es utilisateur dans FTW&sup2; se fait via l&rsquo;utilisation des </span><span class="c1">property type getter/setter javascript et les formulaires</span><span>. On &lsquo;cache&rsquo; la propri&eacute;t&eacute; &agrave; v&eacute;rifier par une nouvelle property, et dans le setter, on fait la validation. </span><span class="c1">Si elle &eacute;choue, on lance une Error</span><span>&nbsp;avec un message qui sera affich&eacute; &agrave; l&rsquo;utilisateur. </span><span class="c1">Pour que s&rsquo;affiche les messages d&rsquo;erreurs, il faut cr&eacute;er un formulaire &lt;</span><span class="c10 c1">FORM</span><span class="c1">&gt;</span><span>&nbsp;et placer les champs inputs,select&hellip; &agrave; l&#39;int&eacute;rieur.</span></p><p class="c3"><span></span></p><p class="c3"><span></span></p><p class="c16 c18"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exemple: cr&eacute;ation d&rsquo;un formulaire &ldquo;client&rdquo; et validation des donn&eacute;es:</span></p><p class="c3"><span></span></p><p class="c3"><span></span></p><p class="c16 c18"><span>La classe repr&eacute;sentant notre client:</span></p><p class="c16 c18"><span class="c1">function Client (id, n,p,s){</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; this.id = id;</span><span class="c5 c1">&nbsp;//identifiant unique du client</span></p><p class="c3"><span class="c5 c1"></span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c5 c1">&nbsp;//mes propri&eacute;t&eacute;s cach&eacute;es: rappel: une propri&eacute;t&eacute; commen&ccedil;ant par un</span></p><p class="c16 c18"><span class="c5 c1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;// underscore n&rsquo;est pas visible par le framework</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; this._Nom = n;</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; this._Prenom = p;</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; this._Sexe = s;</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c5 c1">&nbsp; //les property type getter/setter pour les validations</span></p><p class="c16 c18"><span class="c5 c1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;// ce seront ces property qui seront visibles par le binding</span></p><p class="c16 c18"><span class="c5 c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Object.defineBindProperty(this,&quot;nom&quot;,{</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; get: function(){return this._Nom;},</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; set: function(v){</span></p><p class="c16 c18"><span class="c1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c5 c1">//le code de validation de la valeur, par exemple</span></p><p class="c16 c18"><span class="c5 c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //n&#39;autorise pas les valeurs nulles</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(v == null || v == undefined || v.trim()==&quot;&quot;) {</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c5 c1">&nbsp;//envoie un message a l&#39;utilisateur</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; throw new Error (&quot;Le Nom doit etre renseign&eacute;&quot;);</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c5 c1">&nbsp;//sinon, fait les modifications</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; this._Nom = v; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }); &nbsp;</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Client.defineBindProperty(&#39;prenom&#39;,{</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; get: function(){return this._Prenom;},</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; set: function(v){</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c5 c1">//n&#39;autorise pas les valeurs nulles</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(v == null || v == undefined || v.trim()==&quot;&quot;) {</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c5 c1">//envoie un message a l&#39;utilisateur</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; throw new Error (&quot;Le prenom doit etre renseign&eacute; aussi!&quot;);</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; this._Prenom = v; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }); &nbsp;</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Client.defineBindProperty(&quot;sexe&quot;,{</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; get: function(){return this._Sexe;},</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; set: function(v){</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c5 c1">&nbsp;//n&#39;autorise pas les valeurs autres que M,F et U</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(v == null || v == undefined || v.trim()==&quot;&quot;) {</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c5 c1">//envoie un message a l&#39;utilisateur</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; throw new Error (&quot;Le Sexe doit etre renseign&eacute;&quot;);</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (v==&#39;M&#39; || v==&#39;F&#39; || v==&#39;U&#39;){</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; this._Sexe = v;</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else throw new Error (&quot;Le sexe renseign&eacute; est inconnu!&quot;);</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }); &nbsp; </span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;};</span></p><p class="c3"><span></span></p><p class="c16 c18"><span>Le contexte de donn&eacute;es et les m&eacute;thodes d&rsquo;interactions:</span></p><p class="c3"><span></span></p><p class="c16 c18"><span class="c1">function myContext () { &nbsp;</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c5 c1">//une liste de clients renseign&eacute;e par d&eacute;faut</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clients : [ new Client(generateUUID(),&quot;MANSON&quot;,&quot;Marylin&quot;,&quot;U&quot;),</span></p><p class="c16 c18"><span class="c1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new Client(generateUUID(),&quot;MALLOW&quot;,&quot;Marc&quot;,&quot;M&quot;),</span></p><p class="c16 c18"><span class="c1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new Client(generateUUID(),&quot;DALTON&quot;,&quot;M&#39;a&quot;,&quot;F&quot;)],</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c5 c1">//le client selectionn&eacute; &agrave; &eacute;diter</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; selected : null, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></p><p class="c16 c18"><span class="c1">};</span></p><p class="c16 c18"><span class="c5 c1">//command: suppression d&rsquo;un client</span></p><p class="c16 c18"><span class="c1">myContext.prototype.delete_client = function(evt, id){</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c5 c1">&nbsp;//recherche l&#39;index du client a supprimer</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for (i=0;i&lt;this.clients.length;i++){</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (this.clients[i].id == id){</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; this.clients.splice(i,1);</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c16 c18"><span class="c5 c1">//command: cree un nouveau client sans informations (ie: sans id, toutes les donn&eacute;es a </span></p><p class="c16 c18"><span class="c5 c1">// undefined) </span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; myContext.prototype.add_client = function(evt){</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cl = new Client();</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c5 c1">//s&eacute;lectionne le pour &eacute;dition</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; this.selected = cl;</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; };</span></p><p class="c16 c18"><span class="c5 c1">//command: s&eacute;lectionne un client pour l&#39;&eacute;dition</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; myContext.prototype.edit_client = function(evt, id){</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for (i=0;i&lt;this.clients.length;i++){</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (this.clients[i].id == id){</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; this.selected = this.clients[i];</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;};</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c5 c1">&nbsp;//command: lors de la modification ou cr&eacute;ation d&rsquo;un client, </span></p><p class="c16 c18"><span class="c5 c1">&nbsp; &nbsp; &nbsp; &nbsp;// la m&eacute;thode OnSubmit a appeler</span></p><p class="c16 c18"><span class="c5 c1">&nbsp; &nbsp; &nbsp; &nbsp;//params: evt: l&rsquo;objet event g&eacute;n&eacute;r&eacute; par la commande</span></p><p class="c16 c18"><span class="c5 c1">&nbsp; &nbsp; &nbsp; &nbsp;// &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;params: dans ce cas, null</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; myContext.prototype.action_submit = function(evt, params){</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; evt.preventDefault();</span><span class="c5 c1">//ne pas oublier &ccedil;a....</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; id = this.selected.id;</span></p><p class="c12 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c5 c1">&nbsp;//si le client a d&eacute;j&agrave; un id, met a jour, sinon, enregistre un nouveau</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (id){</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c5 c1">//une simple mise a jour des infos</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; console.log(&quot;mise a jour des donn&eacute;es...&quot;);</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } else {</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c5 c1">//cr&eacute;e un id pour ce client</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; this.selected.id=generateUUID();</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c5 c1">//ajoute a la liste</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; this.clients.push(this.selected);</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c5 c1">//remet selected a null</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; this.selected = null;</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c5 c1">&nbsp;//pour &eacute;viter le rechargement de la page</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return false;</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp;};</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c5 c1">//un converter pour d&eacute;terminer la classe CSS a appliquer </span></p><p class="c16 c18"><span class="c5 c1">&nbsp; &nbsp; &nbsp; &nbsp;// permet de surligner en gris la ligne du client s&eacute;lectionn&eacute; dans </span></p><p class="c16 c18"><span class="c5 c1">&nbsp; &nbsp; &nbsp; &nbsp;// la liste des clients. Je la d&eacute;finie en tant que m&eacute;thode du context</span></p><p class="c16 c18"><span class="c5 c1">&nbsp; &nbsp; &nbsp; //global pour avoir acc&egrave;s aux donn&eacute;es (mais c&#39;est une mauvaise id&eacute;e!)</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; myContext.prototype.is_selected = function (value, params){</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (value){</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c5 c1">//recupere l&#39;index de l&#39;objet</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for (i=0;i&lt;this.clients.length;i++){</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (this.clients[i].id == value.id){</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c5 c1">//g&eacute;n&egrave;re la r&egrave;gle css a appliquer</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; index = i+1;</span><span class="c5 c1">//nth-child commence &agrave; 1!</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; style=&quot;.list li:nth-child(&quot;+index+&quot;){background:#E3E3E3;}&quot;;</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return style;</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return &quot; &quot;;</span><span class="c5 c1">//si pas de s&eacute;lection, renvoie vide</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; };</span></p><p class="c3"><span class="c1"></span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; </span><span class="c5 c1">&nbsp;//un converter pour afficher ou non le bouton submit (ne le fait appara&icirc;tre</span></p><p class="c16 c18"><span class="c5 c1">&nbsp; &nbsp; &nbsp; &nbsp;// que pour la cr&eacute;ation d&rsquo;un client)</span></p><p class="c16 c18"><span class="c5 c1">&nbsp; &nbsp; &nbsp; &nbsp;//si id existe, renvois &#39;block&#39;, sinon &quot;none&quot; comme valeur du display</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp;function got_id (v, params){</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if( v == undefined ) return &#39;display:block;&#39;;</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else return &#39;display:none;&#39;;</span></p><p class="c16 c18"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp;};</span></p><p class="c3"><span class="c1"></span></p><p class="c16 c18"><span>Dans le HTML, on modifie le presenter &ldquo;client_formulaire&rdquo; pour ajouter notre formulaire. </span></p><p class="c3"><span></span></p><p class="c16 c18"><span class="c2">&lt;!-- un presenter utilis&eacute; comme formulaire --&gt;</span></p><p class="c16 c18"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c10">div</span><span class="c2">&nbsp;</span><span class="c5">id</span><span class="c2">=&quot;client_formulaire&quot; </span><span class="c5">data-role</span><span class="c2">=&quot;presenter&quot;&gt;</span></p><p class="c16 c18"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c16 c18"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c10">form</span><span class="c2">&nbsp; </span><span class="c5">data-binded-submit</span><span class="c2">=&quot;</span><span class="c1">{binding command:action_submit}</span><span class="c2">&quot;&gt;</span></p><p class="c16 c18"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;!--on cree un binding 2way vers myContext.selected.nom, et on demande la mise a jour de l&#39;UI par l&#39;event input --&gt;</span></p><p class="c16 c18"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span class="c10">input</span><span class="c2">&nbsp;</span><span class="c5">type</span><span class="c2">=&quot;text&quot; </span></p><p class="c17 c24 c18"><span class="c5">data-binded-value</span><span class="c2">=&quot;</span><span class="c1">{binding from:nom mode:2way fallback:&#39;Le nom du client&#39; event:input}</span><span class="c2">&quot; </span><span class="c5">required</span><span class="c2">&gt;&lt;/</span><span class="c10">input</span><span class="c2">&gt;&lt;</span><span class="c10">br</span><span class="c2">/&gt;</span></p><p class="c3"><span class="c2"></span></p><p class="c16 c18"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;!--on cree un binding 2way vers myContext.selected.prenom, et on demande la mise a jour de l&#39;UI par l&#39;event blur (par defaut) --&gt;</span></p><p class="c16 c18"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c10">input</span><span class="c2">&nbsp;</span><span class="c5">type</span><span class="c2">=&quot;text&quot; </span></p><p class="c16 c24 c18"><span class="c5">data-binded-value</span><span class="c2">=&quot;</span><span class="c1">{binding from:prenom mode:2way fallback:&#39;Le prenom du client&#39;}</span><span class="c2">&quot; </span><span class="c5">required</span><span class="c2">&gt;&lt;/</span><span class="c10">input</span><span class="c2">&gt;&lt;</span><span class="c10">br</span><span class="c2">/&gt;</span></p><p class="c16 c18"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c16 c18"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;!-- binding avec un radiogroup utilise l&#39;event click pour recuperer les changements, c&#39;est un peu la seule facon de faire...--&gt;</span></p><p class="c16 c18"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c10">input</span><span class="c2">&nbsp;</span><span class="c5">type</span><span class="c2">=&quot;radio&quot; </span><span class="c5">value</span><span class="c2">=&quot;M&quot; </span><span class="c5">data-binded-checked</span><span class="c2">=&quot;</span><span class="c1">{binding from:sexe mode:2way}</span><span class="c2">&quot; </span><span class="c5">name</span><span class="c2">=&quot;sexe&quot;&gt;Masculin&lt;/</span><span class="c10">input</span><span class="c2">&gt;</span></p><p class="c16 c18"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c10">input</span><span class="c2">&nbsp;</span><span class="c5">type</span><span class="c2">=&quot;radio&quot; </span><span class="c5">value</span><span class="c2">=&quot;F&quot; </span><span class="c5">data-binded-checked</span><span class="c2">=&quot;</span><span class="c1">{binding from:sexe mode:2way}</span><span class="c2">&quot;</span><span class="c5">name</span><span class="c2">=&quot;sexe&quot; &gt;Feminin&lt;/</span><span class="c10">input</span><span class="c2">&gt;</span></p><p class="c16 c18"><span class="c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;!-- ici, indique un fallback a true pour s&eacute;l&eacute;ctionner cette radio par d&eacute;faut --&gt;</span></p><p class="c16 c18"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c10">input</span><span class="c2">&nbsp;</span><span class="c5">type</span><span class="c2">=&quot;radio&quot; </span><span class="c5">value</span><span class="c2">=&quot;U&quot; </span></p><p class="c16 c18 c24"><span class="c5">data-binded-checked</span><span class="c2">=&quot;</span><span>{binding from:sexe mode:2way fallback:true}</span><span class="c2">&quot; </span><span class="c5">name</span><span class="c2">=&quot;sexe&quot;&gt;Inconnu&lt;/</span><span class="c10">input</span><span class="c2">&gt;&lt;</span><span class="c10">br</span><span class="c2">/&gt;</span></p><p class="c16 c18"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c16 c18"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;!-- on ajoute un submit au cas ou... --&gt;</span></p><p class="c16 c18"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c10">input</span><span class="c2">&nbsp;</span><span class="c5">type</span><span class="c2">=&quot;submit&quot; </span><span class="c5">data-binded-style</span><span class="c2">=&quot;</span><span class="c1">{binding from:id converter:got_id forceAttr:true}</span><span class="c2">&quot; </span><span class="c5">value</span><span class="c2">=&quot;Enregistrer&quot; &gt;&lt;/</span><span class="c10">input</span><span class="c2">&gt;</span></p><p class="c16 c18"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/</span><span class="c10">form</span><span class="c2">&gt;</span></p><p class="c16 c18"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c3"><span class="c2"></span></p><p class="c3"><span class="c2"></span></p><p class="c16 c18"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c10">div</span><span class="c2">&nbsp;</span><span class="c5">data-type</span><span class="c2">=&quot;fallback&quot;&gt;</span></p><p class="c16 c18"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;!-- si le client est null, un simple message???? --&gt;</span></p><p class="c16 c18"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span class="c10">h3</span><span class="c2">&gt;S&eacute;lectionnez un client pour l&#39;&eacute;diter ou cliquez sur &quot;Ajouter un nouveau client&quot;&lt;/</span><span class="c10">h3</span><span class="c2">&gt;</span></p><p class="c16 c18"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c16 c18"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/</span><span class="c10">div</span><span class="c2">&gt;</span></p><p class="c16 c18"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/</span><span class="c10">div</span><span class="c2">&gt;</span></p><p class="c3"><span class="c2"></span></p><p class="c3"><span class="c2"></span></p><p class="c3"><span class="c2"></span></p><p class="c3"><span class="c2"></span></p><p class="c16 c18"><span>Et pour finir, l&rsquo;affichage de la page:</span></p><p class="c3"><span></span></p><p class="c3"><span></span></p><p class="c3"><span></span></p><p class="c16 c18"><span class="c2">&lt;!-- on tente le coup: generer un style? </span></p><p class="c16 c18"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; Dommage qu&rsquo;il faille le d&eacute;clarer dans le body pour prendre en compte les bindings....--&gt;</span></p><p class="c16 c18"><span class="c2">&lt;</span><span class="c10">style</span><span class="c2">&gt;</span><span class="c1">{binding from:selected converter:is_selected}</span><span class="c2">&lt;/</span><span class="c10">style</span><span class="c2">&gt;</span></p><p class="c16 c18"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c16 c18"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c16 c18"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c10">h3</span><span class="c2">&gt;Une simple liste de clients:&lt;/</span><span class="c10">h3</span><span class="c2">&gt;</span></p><p class="c16 c18"><span class="c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;!-- les clients d&eacute;j&agrave; dans la liste --&gt;</span></p><p class="c16 c18"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c10">ul</span><span class="c2">&nbsp;</span><span class="c5">class</span><span class="c2">=&quot;list&quot;&gt;</span><span class="c1">{binding from:clients presenter:client_item_presenter}</span><span class="c2">&lt;/</span><span class="c10">ul</span><span class="c2">&gt;</span></p><p class="c16 c18"><span class="c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;!-- la place de mon formulaire: si myContext.selected == null, affichera le message du data-type=&rdquo;fallback&rdquo;, sinon, affichera le formulaire. --&gt;</span></p><p class="c16 c18"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c10">div</span><span class="c2">&gt;</span><span class="c1">{binding from:selected presenter:client_formulaire}</span><span class="c2">&lt;/</span><span class="c10">div</span><span class="c2">&gt;</span></p><p class="c16 c18"><span class="c2">&nbsp; &nbsp; &nbsp; &lt;</span><span class="c10">a</span><span class="c2">&nbsp;</span><span class="c5">href</span><span class="c2">=&quot;#&quot; </span><span class="c5">data-binded-click</span><span class="c2">=&quot;</span><span class="c1">{binding command:add_client}</span><span class="c2">&quot;&gt;Cr&eacute;er un nouveau client...&lt;/</span><span class="c10">a</span><span class="c2">&gt; &nbsp; &nbsp; &nbsp; &nbsp;</span></p><p class="c3"><span></span></p><p class="c16 c18"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p class="c16 c18"><span class="c1">ReportValidity() et les navigateurs ne le supportant pas:</span></p><p class="c3"><span></span></p><p class="c16 c18"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Pour g&eacute;rer l&rsquo;affichage des messages d&rsquo;erreurs, FTW&sup2; repose sur les m&eacute;thodes setCustomValidity() et reportValidity() de HTML5. &Eacute;tonnamment, ma version de Firefox (43.0.1) ne semble pas disposer d&rsquo;une impl&eacute;mentation pour le reportValidity et n&rsquo;affiche donc pas les bubbles box d&rsquo;informations! Un workaround simple consiste a cr&eacute;er &agrave; la fin du formulaire &nbsp;un </span><span class="c1">&lt;</span><span class="c10 c1">input</span><span class="c1">&nbsp;</span><span class="c5 c1">type</span><span class="c1">=&rdquo;submit&rdquo; </span><span class="c5 c1">style</span><span class="c1">=&rdquo;display:none;&rdquo;&gt;. </span><span>Lors de la modification de la valeur d&rsquo;un champs du formulaire, si il y a une erreur, le framework simulera un click sur ce bouton et affichera les messages pendant 2 secondes.</span></p><p class="c3"><span></span></p><p class="c16 c18"><span class="c32">Note: Pour Flesh&amp;Bones, je ne voulais pas rajouter de CSS ou modifier le HTML de la page, seulement utiliser le javascript. Pour PANDEMIE, le syst&egrave;me changera peut &ecirc;tre en interne pour utiliser une validation et affichage des messages d&rsquo;erreurs fonctionnant avec tous les navigateurs de la m&ecirc;me fa&ccedil;on&hellip;</span></p><p class="c3"><span class="c32"></span></p><p class="c3"><span class="c32"></span></p><h1 class="c17 c33" id="h.8owiu993u13e"><span>9</span><span>: FEAR THE WALKING WEB-FLESH&amp;BONES:</span></h1><p class="c17 c25 c18"><span class="c14 c1"></span></p><p class="c16 c18"><span class="c14">Comme un exemple est plus explicite qu&#39;une doc, je propose de d&eacute;velopper une application compl&egrave;te avec FTW&sup2;. Vous pouvez voir </span><span class="c14 c32 c48"><a class="c34" href="https://www.google.com/url?q=http://127.0.0.1/fear-the-walking-web/docs_demos/wows/index.html&amp;sa=D&amp;ust=1456995045379000&amp;usg=AFQjCNF5AS6mZVVSBue9f_2yEzuTY6VetQ">l&#39;application finie ici</a></span><span class="c14">.</span></p><p class="c16 c18"><span class="c14">Pour la r&eacute;cup&eacute;ration des donn&eacute;es, j&#39;ai choisi le service web Microsoft, qui a l&#39;avantage de renvoyer les donn&eacute;es au format JSON, ce qui simplifie la vie (contrairement au CSV de Yahoo).</span></p><h1 class="c16 c42" id="h.ooq0r6sfjgfy"><span>the Wolf of WallStreet</span></h1><p class="c17 c25"><span></span></p><p class="c16 c18"><span class="c14">Cette application servira a visionner les cours boursiers d&#39;entreprises. La page affichera </span><span class="c14 c15">une zone d&#39;infos sur l&#39;entreprise</span><span class="c14">&nbsp;(le nom, la place boursi&egrave;re, la valeur actuelle et l&#39;&eacute;volution), </span><span class="c14 c15">un graphique SVG</span><span class="c14">&nbsp;pour afficher le cours (sur 1 jour, 1 semaine, 1 mois, 1 ann&eacute;e ou 5 ans), et </span><span class="c14 c15">une zone d&#39;informations g&eacute;n&eacute;rales</span><span class="c14">&nbsp;(volume, close, plage, amplitude...).</span></p><p class="c16 c18"><span class="c14">On pourra </span><span class="c14 c15">rechercher des actions</span><span class="c14">&nbsp;en entrant les premi&egrave;res lettres de leurs nom dans une zone de texte, et l&#39;application </span><span class="c14 c15">proposera des entreprises possibles</span><span class="c14">.</span></p><p class="c16 c18"><span class="c14 c15 c1">Screenshots de l&#39;application</span></p><p class="c3"><span class="c14 c1"></span></p><p class="c3"><span class="c14 c1"></span></p><p class="c3"><span class="c14 c1"></span></p><p class="c7 c25"><span class="c4 c8 c30"></span></p><p class="c7 c25"><span class="c4 c8 c30"></span></p><p class="c7 c25"><span class="c4 c8 c30"></span></p><h2 class="c17 c18 c42" id="h.e6uxzws4ivd6"><span class="c14 c1">Mise en place du projet</span></h2><p class="c16 c18"><span>Cr&eacute;ez</span><span class="c14">&nbsp;un dossier wows sur votre serveur (j&#39;utilise une version de </span><span class="c14 c32 c1 c48"><a class="c34" href="https://www.google.com/url?q=http://www.wampserver.com/&amp;sa=D&amp;ust=1456995045383000&amp;usg=AFQjCNGpNgkg2lWrcpzlk6gGTBR7fHa0uQ">WampServer</a></span><span class="c14">&nbsp;install&eacute;e en locale, dans ce cas, &#39;C:/wamp/www/wows&#39; ). Dans ce dossier, </span><span class="c14 c1">on </span><span class="c1">ajoutera le fichier fear-the-walking-web-flesh-and-bones.js</span><span>&nbsp;</span><span class="c14">, puis on cr&eacute;era </span><span>3</span><span class="c14">&nbsp;fichiers pour notre application:</span></p><p class="c3"><span class="c14"></span></p><ul class="c28 lst-kix_q7mqkdsqzfdu-0 start"><li class="c17 c26 c19 c18"><span class="c14 c15 c1">index.html</span><span class="c14">: contiendra le code html de notre application</span></li><li class="c17 c26 c19 c18"><span class="c14 c15 c1">wows.js</span><span class="c14">: contiendra le code javascript n&eacute;cessaire pour son fonctionnement</span></li><li class="c17 c19 c18 c26"><span class="c15 c1">wows.css</span><span>: contiendra les styles pour les affichages</span></li></ul><p class="c17 c25 c18"><span></span></p><p class="c17 c25 c18"><span></span></p><p class="c17"><span class="c14 c15 c1">Cr&eacute;ation d&#39;un data-context pour l&#39;application</span></p><p class="c16 c18"><span class="c14">La premi&egrave;re chose a faire, dans FTW&sup2;, est de cr&eacute;er un </span><span class="c14 c15 c1">Data-context</span><span class="c14">&nbsp;pour l&#39;application. </span><span class="c14 c31">Cela consiste en un plain object javascript de port&eacute;e globale que l&#39;on d&eacute;fini dans le fichier wows.js.</span><span class="c14">&nbsp;Celui ci servira de conteneur &agrave; toutes les propri&eacute;t&eacute;s que l&#39;on voudra afficher dans l&#39;application.</span></p><p class="c3"><span class="c14"></span></p><p class="c16 c18"><span class="c14">fichier: wows.js</span></p><p class="c7"><span class="c0">function </span><span class="c0 c14">wowsContext </span><span class="c0 c36">()</span><span class="c0 c14">&nbsp;</span><span class="c0 c14 c8">{</span><span class="c0 c14"><br> &nbsp; &nbsp;app_name</span><span class="c0 c14 c8">:</span><span class="c0 c14">&nbsp;</span><span class="c0 c14 c5">&quot;Wolf of WallStreet&quot;</span><span class="c0 c14"><br></span><span class="c0 c14 c8">}</span></p><p class="c7 c25"><span class="c0 c8"></span></p><p class="c7 c40 c18"><span class="c14">Maintenant, on passe au fichier html: on d&eacute;fini le charset et </span><span class="c14 c1">on importe les scripts et css</span><span class="c14">&nbsp;dans le head (l&#39;ordre des imports n&#39;a pas d&#39;importance), on cr&eacute;e le body, </span><span class="c14 c1">on renseigne le data-context</span><span class="c14">&nbsp;pour l</span><span>&rsquo;application</span><span class="c14">&nbsp;et</span><span class="c14 c1">&nbsp;on place notre conteneur &agrave; presenters</span><span class="c14">&nbsp;(on en aura besoin).</span></p><p class="c7 c18 c40"><span class="c14">fichier index.html</span></p><p class="c7"><span class="c4 c14 c2">&lt;!DOCTYPE html&gt;</span><span class="c4 c14 c8"><br>&lt;</span><span class="c4 c9">head</span><span class="c4 c14 c8">&gt;</span></p><p class="c7"><span class="c4 c14 c8">&nbsp; &lt;</span><span class="c9 c4">meta </span><span class="c4 c14 c5">charset</span><span class="c4 c14 c8">=&quot;</span><span class="c4 c14 c21">utf-8</span><span class="c4 c14 c8">&quot;&gt;<br> &nbsp;&lt;</span><span class="c9 c4">title</span><span class="c4 c14 c8">&gt;Wolf Of WallStreet&lt;/</span><span class="c9 c4">title</span><span class="c4 c14 c8">&gt;</span></p><p class="c7"><span class="c4 c14 c8">&nbsp; &nbsp; &lt;</span><span class="c9 c4">link </span><span class="c4 c14 c5">rel</span><span class="c4 c14 c8">=&quot;</span><span class="c4 c14 c21">stylesheet</span><span class="c4 c14 c8">&quot;</span><span class="c9 c4">&nbsp;</span><span class="c4 c14 c5">href</span><span class="c4 c14 c8">=&quot;</span><span class="c4 c14 c21">wows.css</span><span class="c4 c14 c8">&quot;/&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span class="c9 c4">script </span><span class="c4 c14 c5">src</span><span class="c4 c14 c8">=&quot;</span><span class="c4 c14 c21">fear-the-walking-web-flesh-and-bones.js</span><span class="c4 c14 c8">&quot;&gt;&lt;/</span><span class="c9 c4">script</span><span class="c4 c14 c8">&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span class="c9 c4">script </span><span class="c4 c14 c5">src</span><span class="c4 c14 c8">=&quot;</span><span class="c4 c14 c21">wows.js</span><span class="c4 c14 c8">&quot;&gt;&lt;/</span><span class="c9 c4">script</span><span class="c4 c14 c8">&gt;<br>&lt;/</span><span class="c9 c4">head</span><span class="c4 c14 c8">&gt;</span></p><p class="c7"><span class="c4 c8">&lt;</span><span class="c4 c10">body </span><span class="c4 c5">data-context</span><span class="c4 c2">=&quot;</span><span class="c4 c21">wowsContext</span><span class="c4 c2">&quot;</span><span class="c4 c8">&gt;</span></p><p class="c6"><span class="c4 c8">&lt;</span><span class="c4 c10">div</span><span class="c4 c8">&nbsp;</span><span class="c4 c5">data-role</span><span class="c4 c8">=</span><span class="c4 c21">&rdquo;presenters&rdquo;</span><span class="c4 c8">&gt;</span></p><p class="c6"><span class="c4 c8">&lt;/</span><span class="c4 c10">div</span><span class="c4 c8">&gt;</span></p><p class="c6"><span class="c4 c8">&lt;</span><span class="c4 c10">div</span><span class="c4 c8">&nbsp;</span><span class="c4 c5">id</span><span class="c4 c8">=&rdquo;</span><span class="c4 c21">recherche</span><span class="c4 c8">&rdquo;&gt;</span></p><p class="c6"><span class="c4 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;!-- la zone de recherche des cotations --&gt;</span></p><p class="c6"><span class="c4 c8">&lt;/</span><span class="c4 c10">div</span><span class="c4 c8">&gt;</span></p><p class="c6"><span class="c4 c8">&lt;</span><span class="c4 c10">div</span><span class="c4 c8">&nbsp;</span><span class="c4 c5">id</span><span class="c4 c8">=&rdquo;</span><span class="c4 c21">stock</span><span class="c4 c8">&rdquo;&gt;</span></p><p class="c6"><span class="c4 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;!-- la zone d&rsquo;affichage des informations sur le stock --&gt;</span></p><p class="c6"><span class="c4 c8">&lt;/</span><span class="c4 c10">div</span><span class="c4 c8">&gt;</span></p><p class="c7"><span class="c4 c8">&lt;/</span><span class="c4 c10">body</span><span class="c4 c8">&gt;</span><span class="c4 c14 c8"><br></span></p><p class="c7"><span class="c0 c15">R&eacute;cup&eacute;ration des donn&eacute;es entreprises par le webservice bing.finance:</span></p><p class="c6"><span class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p class="c6"><span class="c4">Pour pouvoir r&eacute;cup&eacute;rer les informations d&rsquo;un stock (cotation), </span><span class="c0">il faut fournir au webservice le code unique de l&rsquo;entreprise</span><span class="c4">&nbsp;(ressemblant &agrave; quelque chose comme &ldquo;160.1.ALO.PAR&rdquo; pour Alstom, bourse de Paris). Heureusement, BING fourni aussi un service qui, &agrave; partir du nom (ou d&eacute;but du nom) d&rsquo;une entreprise, va renvoyer les noms et codes des entreprises possibles. Un exemple d&rsquo;appel au webservice de r&eacute;solution de nom serait:</span></p><p class="c6"><span class="c0 c22"><a class="c34" href="https://www.google.com/url?q=http://finance.services.appex.bing.com/Market.svc/MTAutocomplete?q%3Dalsto%26locale%3DFR-FR%26count%3D5&amp;sa=D&amp;ust=1456995045408000&amp;usg=AFQjCNHZ1BdzYWCMFUoRDYGdMLI-mgO5fA">http://finance.services.appex.bing.com/Market.svc/MTAutocomplete?q=alsto&amp;locale=FR-FR&amp;count=5</a></span></p><p class="c6"><span class="c4">Les param&egrave;tres sont:</span></p><p class="c6 c19"><span class="c0">q</span><span class="c4">: ce qu&rsquo;on recherche (query)</span></p><p class="c6 c19"><span class="c0">locale</span><span class="c4">: la langue de la r&eacute;ponse (ici, FR-FR)</span></p><p class="c6 c19"><span class="c0">count</span><span class="c4">: le nombre de r&eacute;ponses maximum d&eacute;sir&eacute;es (ici, 5)</span></p><p class="c6"><span class="c4">Le webservice renvoie un objet JSON avec 2 propri&eacute;t&eacute;s : </span><span class="c0">COUNT</span><span class="c4">: le nombre de r&eacute;ponses renvoy&eacute;es et </span><span class="c0">DATA</span><span class="c4">: un tableau contenant les r&eacute;ponses sous forme d&rsquo;Objets. Parmi les propri&eacute;t&eacute;s de ces objets, on s&#39;int&eacute;ressera uniquement &agrave;:</span></p><p class="c6 c19"><span class="c0">FullInstrument</span><span class="c4">: le code unique de l&rsquo;entreprise (par exemple: 160.1.ALO.PAR)</span></p><p class="c6 c19"><span class="c0">LocaleName</span><span class="c4">: le nom de l&rsquo;entreprise (par exemple &ldquo;ALSTOM&rdquo;)</span></p><p class="c6 c19"><span class="c0">AC040</span><span class="c4">: le nom de la place boursi&egrave;re (par exemple CAC40)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p class="c7 c25"><span class="c4"></span></p><p class="c6"><span class="c4">Dans notre &lt;</span><span class="c4 c10">DIV</span><span class="c4">&nbsp;</span><span class="c4 c5">id</span><span class="c4">=&rdquo;recherche&rdquo;&gt;, on va rajouter une zone de saisie, qui a chaque caract&egrave;re tap&eacute; enverra une requ&ecirc;te pour r&eacute;cup&eacute;rer les codes et affichera les r&eacute;sultats dans une liste. Cliquer sur un &eacute;l&eacute;ment de la liste permettra de s&eacute;lectionner l&rsquo;entreprise &agrave; afficher.</span></p><p class="c6"><span class="c4">HTML:</span></p><p class="c6"><span class="c4">Dans la page html, on place la zone de recherche &lt;</span><span class="c4 c10">INPUT</span><span class="c4">&gt; et une liste &lt;</span><span class="c4 c10">UL</span><span class="c4">&gt; pour afficher les r&eacute;sultats de la recherche.</span></p><p class="c6 c25"><span class="c4"></span></p><p class="c6"><span class="c0">&nbsp; &nbsp;</span><span class="c4">&nbsp;&lt;</span><span class="c4 c10">div</span><span class="c4">&nbsp;</span><span class="c4 c5">id</span><span class="c4">=&quot;recherche&quot;&gt;</span></p><p class="c6"><span class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c4 c2">&lt;!-- une zone de recherche, met a jour la propri&eacute;t&eacute; a chaque caract&egrave;re entr&eacute; --&gt;</span></p><p class="c6"><span class="c4">&nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span class="c4 c10">input</span><span class="c4">&nbsp;</span><span class="c4 c5">id</span><span class="c4">=&#39;searchinput&#39; </span><span class="c4 c5">type</span><span class="c4">=&quot;text&quot;</span></p><p class="c6 c29"><span class="c4 c5">data-binded-value</span><span class="c4">=&quot;</span><span class="c0">{binding from:search_txt mode:2way fallback:&#39;search for stock&#39; event:input}</span><span class="c4">&quot;/&gt;</span></p><p class="c6"><span class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c4 c2">&lt;!-- les r&eacute;ponses: un binding de tableau, utilise le presenter suggestionItem pour afficher les &eacute;l&eacute;ments du tableau, et ne fait pas de binding sur les objets du tableau (deep=false), le tableau change a chaque requete --&gt;</span></p><p class="c6"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;</span><span class="c4 c10">ul</span><span class="c4">&gt;</span><span class="c0">{binding from:suggestList presenter:suggestionItem deep:false}</span><span class="c4">&lt;/</span><span class="c4 c10">ul</span><span class="c4">&gt;</span></p><p class="c6"><span class="c4">&nbsp; &nbsp;&lt;/</span><span class="c4 c10">div</span><span class="c4">&gt;</span></p><p class="c6 c25"><span class="c4"></span></p><p class="c6"><span class="c4">Puis on cr&eacute;e les presenters n&eacute;cessaires pour afficher les informations d&rsquo;une entreprise. On ne s&#39;int&eacute;ressera qu&rsquo;au code, nom et place boursi&egrave;re.</span></p><p class="c6"><span class="c4">&lt;</span><span class="c4 c10">div</span><span class="c4">&nbsp;</span><span class="c4 c5">data-role</span><span class="c4">=&quot;presenters&quot;&gt;</span></p><p class="c6"><span class="c4">&nbsp; &nbsp; &nbsp;&lt;</span><span class="c4 c10">div</span><span class="c4">&nbsp;</span><span class="c4 c5">data-role</span><span class="c4">=&quot;presenter&quot; </span><span class="c4 c5">id</span><span class="c4">=&#39;suggestionItem&#39;&gt;</span></p><p class="c6"><span class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c4 c2">&lt;!-- pour notre tableau on cr&eacute;e un presenter type LI et on place une commande dessus qui prend en param&egrave;tre le code unique de l&rsquo;entreprise --&gt;</span></p><p class="c6"><span class="c4">&nbsp; &nbsp; &nbsp; &lt;</span><span class="c4 c10">li</span><span class="c4">&nbsp;</span><span class="c4 c5">class</span><span class="c4">=&rdquo;suggest&rdquo; </span><span class="c4 c5">data-binded-click</span><span class="c4">=&quot;</span><span class="c0">{binding command:selectNewStock command_params:$FullInstrument}</span><span class="c4">&quot; &gt;</span></p><p class="c7 c19"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c4 c2">&lt;!-- &nbsp;un binding tout simple pour le nom de l&rsquo;entreprise --&gt;</span></p><p class="c6"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c4 c10">h2 </span><span class="c4 c5">class</span><span class="c4">=&rdquo;stck_place&rdquo;</span><span class="c4">&gt;</span><span class="c0">{binding from:FriendlyName fallback:&#39;no data&#39;}</span><span class="c4">&lt;/</span><span class="c4 c10">h2</span><span class="c4">&gt;</span></p><p class="c6"><span class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c4 c2">&lt;!-- idem pour la place boursi&egrave;re --&gt;</span></p><p class="c6"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;</span><span class="c4 c10">h5</span><span class="c4">&nbsp;</span><span class="c4 c5">class</span><span class="c4">=&quot;stck_place&quot;&gt;</span><span class="c0">{binding from:AC040 fallback:&#39;no data&#39;}</span><span class="c4">&lt;/</span><span class="c4 c10">h5</span><span class="c4">&gt;</span></p><p class="c6"><span class="c4">&nbsp; &nbsp; &nbsp; &lt;/</span><span class="c4 c10">li</span><span class="c4">&gt;</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &lt;/</span><span class="c4 c10">div</span><span class="c4">&gt;</span></p><p class="c6 c25"><span class="c4"></span></p><p class="c6"><span class="c4">et un peu de mise en style pour la forme&hellip;</span></p><p class="c6"><span class="c4">CSS:</span></p><p class="c6"><span class="c4">html{</span></p><p class="c6"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c4 c10">color</span><span class="c4">:#181D20;</span></p><p class="c6"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c4 c10">text-shadow</span><span class="c4">: 1px 2px #d3d3d3;</span></p><p class="c6"><span class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c4 c10">font-family</span><span class="c4">: Arial, Helvetica, sans-serif;</span></p><p class="c6"><span class="c4">}</span></p><p class="c6"><span class="c4 c5">/* le div recherche */</span></p><p class="c6"><span class="c4">#recherche{</span></p><p class="c6"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c4 c10">display</span><span class="c4">:table;</span></p><p class="c6"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c4 c10">width</span><span class="c4">:20%;</span></p><p class="c6"><span class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c4 c10">float</span><span class="c4">: left;</span></p><p class="c6"><span class="c4">}</span></p><p class="c6"><span class="c4 c5">/* la liste de r&eacute;sultats */</span></p><p class="c6"><span class="c4">#recherche ul{</span></p><p class="c6"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c4 c10">display</span><span class="c4">:table-row;</span></p><p class="c6"><span class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c4 c10">list-style</span><span class="c4">:none;</span></p><p class="c6"><span class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c4 c10">padding-left</span><span class="c4">:0;</span></p><p class="c6"><span class="c4">}</span></p><p class="c6"><span class="c4 c5">/* les &eacute;l&eacute;ments de la liste */</span></p><p class="c6"><span class="c4">#recherche ul li { &nbsp; &nbsp; &nbsp;</span></p><p class="c6"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c4 c10">text-align</span><span class="c4">:center;</span></p><p class="c6"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c4 c10">padding-top</span><span class="c4">:20px;</span></p><p class="c6"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c4 c10">cursor</span><span class="c4">:pointer;</span></p><p class="c6"><span class="c4">}</span></p><p class="c6"><span class="c4 c5">/* zone de saisie */</span></p><p class="c6"><span class="c4">#recherche input { &nbsp;</span></p><p class="c6"><span class="c4">&nbsp; </span><span class="c4 c10">padding-top</span><span class="c4">:30px;</span></p><p class="c6"><span class="c4">&nbsp; </span><span class="c4 c10">margin-bottom</span><span class="c4">:30px;</span></p><p class="c6"><span class="c4">&nbsp; </span><span class="c4 c10">font-size</span><span class="c4">:1.3em;</span></p><p class="c6"><span class="c4">&nbsp; </span><span class="c4 c10">display</span><span class="c4">:table-row;</span></p><p class="c6"><span class="c4">}</span></p><p class="c6"><span class="c4 c5">/* le look: simplement une barre grise en bottom </span></p><p class="c6"><span class="c4 c5">note: dans chrome, la zone de texte en focus aura un border ajouter, je ne vois pas</span></p><p class="c6"><span class="c4 c5">comment le supprimer&hellip;. */</span></p><p class="c6"><span class="c4">#recherche ul li ,</span></p><p class="c6"><span class="c4">#recherche input {</span></p><p class="c6"><span class="c4">&nbsp; </span><span class="c4 c10">margin</span><span class="c4">:0;</span></p><p class="c6"><span class="c4">&nbsp; </span><span class="c4 c10">vertical-align</span><span class="c4">:bottom;</span></p><p class="c6"><span class="c4">&nbsp; </span><span class="c4 c10">border</span><span class="c4">: none;</span></p><p class="c6"><span class="c4">&nbsp; </span><span class="c4 c10">border-bottom</span><span class="c4">: solid 2px #c9c9c9;</span></p><p class="c6"><span class="c4">&nbsp; </span><span class="c4 c10">transition</span><span class="c4">: border 0.3s;</span></p><p class="c6"><span class="c4">&nbsp; </span><span class="c4 c10">font-family</span><span class="c4">: sans-serif;</span></p><p class="c6"><span class="c4">&nbsp; </span><span class="c4 c10">width</span><span class="c4">:100%;</span></p><p class="c6"><span class="c4">}</span></p><p class="c6"><span class="c4">#recherche ul li:hover ,</span></p><p class="c6"><span class="c4">#recherche ul li.hover ,</span></p><p class="c6"><span class="c4">#recherche input.focus ,</span></p><p class="c6"><span class="c4">#recherche input:focus {</span></p><p class="c6"><span class="c4">&nbsp; </span><span class="c4 c10">border-bottom</span><span class="c4">: solid 2px #45B2FB;</span></p><p class="c6"><span class="c4">}</span></p><p class="c6"><span class="c4 c5">/* styles pour le nom de l&rsquo;entreprise et la place boursi&egrave;re */</span></p><p class="c6"><span class="c4">.stck_name {</span></p><p class="c6"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c4 c10">font-size</span><span class="c4">:1.3em;</span></p><p class="c6"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c4 c10">margin</span><span class="c4">:2px;</span></p><p class="c6"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c4 c10">padding</span><span class="c4">:0px;</span></p><p class="c6"><span class="c4">}</span></p><p class="c6"><span class="c4">.stck_place {</span></p><p class="c6"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c4 c10">font-style</span><span class="c4">:italic;</span></p><p class="c6"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c4 c10">font-size</span><span class="c4">:1.0em;</span></p><p class="c6"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c4 c10">margin</span><span class="c4">:2px;</span></p><p class="c6"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c4 c10">margin-bottom</span><span class="c4">: 5px;</span></p><p class="c6"><span class="c4">}</span></p><p class="c6 c25"><span class="c0"></span></p><p class="c6"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c16 c18"><span>Cot&eacute; Javascript, on commence par cr&eacute;er 2 propri&eacute;t&eacute;s dans le contexte de donn&eacute;es:</span></p><p class="c16 c18"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">_search_text</span><span>: pour la zone de saisie, comme on veut a chaque modification de sa valeur lancer une requ&ecirc;te AJAX, on la rend invisible (le underscore devant!) et on lui adjoint une property type getter/setter pour le binding. Dans le setter, on lancera les requ&ecirc;tes ajax.</span></p><p class="c16 c18"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">suggestList</span><span>: pour enregistrer la liste des r&eacute;ponses du webservice de r&eacute;solution de nom.</span></p><p class="c3"><span></span></p><p class="c16 c18"><span>La variable </span><span class="c1">xhr_delay </span><span>sert juste &agrave; &eacute;viter d&rsquo;envoyer trop de requ&ecirc;te au serveur en mettant un d&eacute;lais entre la modification de </span><span class="c1">_search_text</span><span>&nbsp;et l&rsquo;envoie r&eacute;el de la requ&ecirc;te.</span></p><p class="c3"><span></span></p><p class="c16"><span>fichier: wows.js</span></p><p class="c13"><span></span></p><p class="c7"><span class="c0">xhr_delay = null;</span><span class="c0 c5">//pour &eacute;viter de flooder le serveur de requ&ecirc;tes</span></p><p class="c17 c25"><span class="c1"></span></p><p class="c7"><span class="c0">function wowsContext </span><span class="c0 c36">()</span><span class="c0">&nbsp;</span><span class="c0 c8">{</span><span class="c0"><br> &nbsp; this.app_name</span><span class="c0 c8">=</span><span class="c0">&nbsp;</span><span class="c0 c5">&quot;Wolf of WallStreet&quot;;</span></p><p class="c17"><span class="c1">&nbsp; &nbsp;</span><span class="c0">&nbsp;this._search_txt = null; </span><span class="c0 c5">//la recherche d&#39;action</span></p><p class="c17 c25"><span class="c0"></span></p><p class="c17"><span class="c0">&nbsp; &nbsp; this.suggestList = null; </span><span class="c0 c5">//les suggestions obtenues</span></p><p class="c17 c25"><span class="c0 c5"></span></p><p class="c17"><span class="c0 c5">&nbsp; &nbsp;</span><span class="c0">&nbsp;this.selectNewStock = function (evt, id){</span></p><p class="c17 c25"><span class="c0"></span></p><p class="c17"><span class="c0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c0 c5">//la commande lors du click sur un &lt;LI&gt;, r&eacute;cup&eacute;re en argument le code (id) de l&rsquo;entreprise selectionn&eacute;e</span></p><p class="c17 c25"><span class="c0 c5"></span></p><p class="c17"><span class="c0">&nbsp; &nbsp;};</span></p><p class="c7"><span class="c0"><br></span><span class="c0 c8">};</span></p><p class="c7 c25"><span class="c4"></span></p><p class="c6"><span class="c4">on d&eacute;fini la property &lsquo;bindable&rsquo; et a chaque modification, on lance une requ&ecirc;te XHR pour avoir les codes des entreprises.</span></p><p class="c7"><span class="c0">wowsContext.defineBindProperty</span><span class="c4">(&quot;</span><span class="c4 c21">search_txt</span><span class="c4">&quot;,{</span></p><p class="c7"><span class="c4">&nbsp; &nbsp;</span><span class="c0">&nbsp;get: function()</span><span class="c4">{return this._search_txt;}, </span><span class="c4 c5">//renvoie simplement la valeur</span></p><p class="c7 c25"><span class="c4 c5"></span></p><p class="c7"><span class="c4">&nbsp; &nbsp; </span><span class="c0">set: function(value)</span><span class="c4">{</span></p><p class="c7 c25"><span class="c4"></span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; if (xhr_delay != null) clearTimeout(xhr_delay);//annule</span></p><p class="c7 c25"><span class="c4"></span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; var url = &quot;http://finance.services.appex.bing.com/Market.svc/MTAutocomplete?q=&quot;</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; +search</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; +&quot;&amp;locale=FR-FR&amp;count=8&quot;;</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; //chargement des donn&eacute;es avec un delay</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; var bind = this;</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; xhr_delay = setTimeout(function(){</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; clearInterval(xhr_delay);</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; xhr_delay = null;//fin de l&#39;attente</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //(&quot;send xhr request:&quot;+url);</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bind.__load_async_json(url,&quot;show_suggestions&quot;, bind.error_loading, bind.timeout_error);</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; }, 300);//attends 30ms avant de lancer la requete, au cas ou</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; //ajoute des lettres</span></p><p class="c7 c25"><span class="c4"></span></p><p class="c7"><span class="c4">&nbsp; &nbsp; }</span></p><p class="c7"><span class="c4">});</span></p><p class="c7 c25"><span class="c0"></span></p><p class="c7"><span class="c4 c5">//r&eacute;cup&egrave;re les donn&eacute;es du webservice et affiche dans la liste</span></p><p class="c7"><span class="c0">wowsContext.prototype.show_suggestions = function(data)</span><span class="c4">{</span></p><p class="c7"><span class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (datas.count&gt;0){ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; this.suggestList = datas.data; </span><span class="c4 c5">//enregistre directement les objets cr&eacute;es par JSON, normalement, on devrait cr&eacute;er nos</span></p><p class="c7"><span class="c4 c5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//propre type de donn&eacute;es... &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; } else {</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; this.suggestList = [];</span><span class="c4 c5">//renvoie une liste vide, pas de r&eacute;ponses&hellip;.</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c7"><span class="c4">};</span></p><p class="c7 c25"><span class="c0"></span></p><p class="c7"><span class="c4 c5">//gestion du xhr</span></p><p class="c7"><span class="c4">var xhr_timeout = 4000;</span><span class="c4 c5">//4 secondes avant annulation de la requete XHR</span></p><p class="c7 c25"><span class="c4 c5"></span></p><p class="c7"><span class="c4 c5">//charge les donn&eacute;es d&#39;une URL via XHR</span></p><p class="c7"><span class="c4 c5">//param url: l&rsquo;url ou se connecter</span></p><p class="c7"><span class="c4 c5">//param handler: le nom de la m&eacute;thode a appeller si le chargement a reussi</span></p><p class="c7"><span class="c4 c5">//param error_handler: nom de la m&eacute;thode a appeller si erreur</span></p><p class="c7"><span class="c4 c5">//param timeout: nom de la m&eacute;thode a appeller si timeout</span></p><p class="c7"><span class="c0">wowsContext.prototype.</span><span class="c0">__load_async_json( url, handler, error_handler, timeout)</span><span class="c4">{</span></p><p class="c7"><span class="c4">&nbsp;var ctx = this;</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; var xhr = new XMLHttpRequest();</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; xhr.onload = function(e){</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(xhr.status !== 200) {</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //erreur</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (error_handler) error_handler(xhr.responseText);</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else alert(&quot;error loading JSON file&quot;);</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return;</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; json_datas = xhr.response;</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; datas = JSON.parse(json_datas);</span></p><p class="c7 c25"><span class="c4"></span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //juste pour pouvoir avoir un &#39;this&#39; qui veut dire quelquechose....</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ctx[handler](datas);</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (error_handler){</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; xhr.onerror = error_handler;</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(timeout){</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; xhr.timeout = xhr_timeout;</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; xhr.ontimeout = timeout;</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c7 c25"><span class="c4"></span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; xhr.open(&#39;GET&#39;, url);</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; xhr.send();</span></p><p class="c7 c25"><span class="c4"></span></p><p class="c7"><span class="c4">};</span></p><p class="c7"><span class="c4 c5">//une m&eacute;thode basique pour afficher une erreur dans la console</span></p><p class="c7"><span class="c0">wowsContext.prototype.</span><span class="c0">error_loading = function(err)</span><span class="c4">{</span></p><p class="c7"><span class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;console.log(&quot;</span><span class="c4 c21">erreur: </span><span class="c4">&quot;+err);</span></p><p class="c7"><span class="c4">};</span></p><p class="c7"><span class="c4 c5">//une m&eacute;thode basique pour afficher un timeout dans la console</span></p><p class="c7"><span class="c0">wowsContext.prototype.</span><span class="c0">timeout_error = function(err)</span><span class="c4">{</span></p><p class="c7"><span class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;console.log(&quot;</span><span class="c4 c21">timeout: </span><span class="c4">&quot;+err);</span></p><p class="c7"><span class="c4">};</span></p><p class="c17 c25"><span class="c4"></span></p><p class="c17 c25"><span class="c4"></span></p><p class="c17 c25"><span class="c4"></span></p><p class="c17"><span class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c0 c15">Gestion des erreurs:</span></p><p class="c17"><span class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Lorsqu&rsquo;on fait une recherche d&rsquo;entreprise, on peut rencontrer 2 types d&rsquo;erreurs: une erreur de connection ou de timeout (pour simplifier le code, on ne les distinguera pas), et une erreur de type &ldquo;pas de r&eacute;ponses trouv&eacute;es&rdquo; si le aucune entreprise correspond &agrave; la recherche. </span></p><p class="c17 c25"><span class="c4"></span></p><p class="c17"><span class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c0">Erreur de connection/timeout:</span></p><p class="c17"><span class="c4">En place d&rsquo;un &ldquo;console.log&rdquo; pas tr&egrave;s user-friendly, on va rajouter dans le presenter </span><span class="c0">&#39;suggestionItem&#39; </span><span class="c4">un data-type pour g&eacute;rer les objet </span><span class="c0">Error, </span><span class="c4">un simple &eacute;l&eacute;ment de liste qui demandera a afficher la propri&eacute;t&eacute; </span><span class="c0">message</span><span class="c4">:</span></p><p class="c17 c25"><span class="c4"></span></p><p class="c17"><span class="c4 c2">&lt;</span><span class="c4 c10">div</span><span class="c4 c2">&nbsp;</span><span class="c4 c5">data-role</span><span class="c4 c2">=&quot;presenter&quot; </span><span class="c4 c5">id</span><span class="c4 c2">=&#39;suggestionItem&#39;&gt;</span></p><p class="c17"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&hellip;</span></p><p class="c17"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span class="c4 c10">li</span><span class="c4 c2">&nbsp;</span><span class="c4 c5">data-type</span><span class="c4 c2">=&quot;Error&quot;&gt;</span></p><p class="c17"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c4 c10">h3</span><span class="c4 c2">&nbsp;</span><span class="c4 c5">class</span><span class="c4 c2">=&quot;stck_name&quot;&gt;</span><span class="c0">{binding from:$message}</span><span class="c4 c2">&lt;/</span><span class="c4 c10">h3</span><span class="c4 c2">&gt;</span></p><p class="c17"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &lt;/</span><span class="c4 c10">li</span><span class="c4 c2">&gt;</span></p><p class="c17"><span class="c4 c2">&lt;/</span><span class="c4 c10">div</span><span class="c4 c2">&gt;</span></p><p class="c17 c25"><span class="c4 c2"></span></p><p class="c17"><span class="c4">En javascript, on modifie les m&eacute;thodes error_loading et timeout_error pour modifier la liste de r&eacute;sultats en fonction:</span></p><p class="c17 c25"><span class="c4"></span></p><p class="c7"><span class="c4 c5">//une m&eacute;thode basique pour afficher une erreur dans la console</span></p><p class="c7"><span class="c0">wowsContext.prototype.</span><span class="c0">error_loading = function(err)</span><span class="c4">{</span></p><p class="c7"><span class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.suggestList = [err];</span></p><p class="c7"><span class="c4">};</span></p><p class="c7"><span class="c4 c5">//une m&eacute;thode basique pour afficher un timeout dans la console</span></p><p class="c7"><span class="c0">wowsContext.prototype.</span><span class="c0">timeout_error = function(err)</span><span class="c4">{</span></p><p class="c7"><span class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.suggestList = [err];</span></p><p class="c7"><span class="c4">};</span></p><p class="c7 c25"><span class="c4"></span></p><p class="c7"><span class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c0">Erreur type &ldquo;pas de r&eacute;ponses&rdquo;:</span></p><p class="c6"><span class="c4">Pour g&eacute;rer le cas ou aucune r&eacute;ponses n&rsquo;a &eacute;t&eacute; trouv&eacute;e, on va cr&eacute;er un nouveau presenter &ldquo;</span><span class="c0">noSuggestions</span><span class="c4">&rdquo; pour afficher un message d&rsquo;erreur &agrave; l&rsquo;utilisateur et renseigner le param&egrave;tre </span><span class="c0">EMPTY </span><span class="c4">du binding. </span><span class="c4 c32">Rappel: dans un item_presenter (affichage de liste), le param&egrave;tre fallback sert a g&eacute;rer le cas ou la propri&eacute;t&eacute; est NULL, le param&egrave;tre empty sert dans le cas ou la liste est VIDE (length==0)</span></p><p class="c6"><span class="c4 c2">&lt;</span><span class="c4 c10">div</span><span class="c4 c2">&nbsp;</span><span class="c4 c5">data-role</span><span class="c4 c2">=&quot;presenters&quot;&gt;</span></p><p class="c6"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&hellip;</span></p><p class="c6 c19"><span class="c4 c2">&lt;</span><span class="c4 c10">div</span><span class="c4 c2">&nbsp;</span><span class="c4 c5">data-role</span><span class="c4 c2">=&quot;presenter&quot; </span><span class="c4 c5">id</span><span class="c4 c2">=&#39;noSuggestions&#39;&gt;</span></p><p class="c6"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c4 c10">li</span><span class="c4 c2">&gt;&lt;</span><span class="c4 c10">h3</span><span class="c4 c2">&nbsp; </span><span class="c4 c5">class</span><span class="c4 c2">=&quot;stck_name&quot;&gt;Aucune r&eacute;ponses pour la recherche...&lt;/</span><span class="c4 c10">h3</span><span class="c4 c2">&gt;&lt;/</span><span class="c4 c10">li</span><span class="c4 c2">&gt;</span></p><p class="c6"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &lt;/</span><span class="c4 c10">div</span><span class="c4 c2">&gt;</span></p><p class="c6"><span class="c4 c2">&lt;/</span><span class="c4 c10">div</span><span class="c4 c2">&gt;</span></p><p class="c6 c25"><span class="c4"></span></p><p class="c6"><span class="c4">et on modifie le binding de la liste:</span></p><p class="c6"><span class="c4 c2">&lt;</span><span class="c4 c10">ul</span><span class="c4 c2">&gt;</span><span class="c4">{binding from:suggestList presenter:suggestionItem deep:false </span><span class="c0">empty:noSuggestions</span><span class="c4">}</span><span class="c4 c2">&lt;/</span><span class="c4 c10">ul</span><span class="c4 c2">&gt;</span></p><p class="c6 c25"><span class="c4"></span></p><p class="c6 c25"><span class="c4"></span></p><p class="c6"><span class="c0 c15">R&eacute;cup&eacute;rer les informations de cotation d&rsquo;une entreprise:</span></p><p class="c7"><span class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Pour r&eacute;cup&eacute;rer les informations de cotation, on va lancer une requ&ecirc;te vers le webservice BING d&eacute;di&eacute;. Un exemple d&rsquo;URL est:</span></p><p class="c7"><span class="c22 c4"><a class="c34" href="https://www.google.com/url?q=http://finance.services.appex.bing.com/Market.svc/M-TodayEquityV4?rtSymbols%3D160.1.ALS.PAR%26chartSymbols%3D160.1.ALS.PAR%26chartType%3D1Y%26lang%3DFR-FR%26localizeFor%3DFR-FR&amp;sa=D&amp;ust=1456995045515000&amp;usg=AFQjCNFmE1tGlzVyHYSI35zVdpzXU4-QMw">http://finance.services.appex.bing.com/Market.svc/M-TodayEquityV4?rtSymbols=160.1.ALS.PAR&amp;chartSymbols=160.1.ALS.PAR&amp;chartType=1Y&amp;lang=FR-FR&amp;localizeFor=FR-FR</a></span></p><p class="c7 c25"><span class="c4"></span></p><p class="c7"><span class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Les param&egrave;tres sont:</span></p><p class="c7"><span class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c0">rtSymbols</span><span class="c4">: le ou les codes d&rsquo;entreprises dont on veut r&eacute;cup&eacute;rer les informations (ici, on en r&eacute;cup&eacute;rera qu&rsquo;une seule)</span></p><p class="c7"><span class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c0">chartSymbols</span><span class="c4">: le ou les codes d&rsquo;entreprises dont on veut r&eacute;cup&eacute;rer les cotations</span></p><p class="c7"><span class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c0">chartType</span><span class="c4">: la dur&eacute;e de cotation voulue (de 1jour &agrave; 5 ans)</span></p><p class="c7"><span class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c0">lang</span><span class="c4">&nbsp;&amp; </span><span class="c0">localizeFor</span><span class="c4">: la langue de r&eacute;ponse d&eacute;sir&eacute;e.</span></p><p class="c7 c25"><span class="c4"></span></p><p class="c7"><span class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;On obtient en retour un objet JSON avec les propri&eacute;t&eacute;s suivantes:</span></p><p class="c7"><span class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c0">FrNm</span><span class="c4">: nom de l&rsquo;entreprise (en francais)</span></p><p class="c7"><span class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c0">FlIns</span><span class="c4">: code unique de l&rsquo;entreprise</span></p><p class="c7"><span class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c0">EExNm</span><span class="c4">: place boursi&egrave;re</span></p><p class="c7"><span class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c0">market</span><span class="c4">: place boursi&egrave;rer (le nom)</span></p><p class="c7"><span class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c0">Lp</span><span class="c4">: valeur de la cotation</span></p><p class="c7"><span class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c0">Ch</span><span class="c4">: gain de la cotation (du jour?)</span></p><p class="c7"><span class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c0">Chp</span><span class="c4">: gain de la cotation (pourcentage)</span></p><p class="c7"><span class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c0">Yl, Yh</span><span class="c4">: amplitude sur 1 an</span></p><p class="c7"><span class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c0">Op</span><span class="c4">: valeur a l&rsquo;ouverture</span></p><p class="c7"><span class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c0">Pp</span><span class="c4">; valeur a la fermeture pr&eacute;c&eacute;dente</span></p><p class="c7"><span class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c0">V</span><span class="c4">: volume d&rsquo;&eacute;chage</span></p><p class="c7"><span class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c0">avgV</span><span class="c4">: volume d&rsquo;&eacute;change moyen</span></p><p class="c7"><span class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c0">Mc</span><span class="c4">: capitalisation de l&rsquo;entreprise</span></p><p class="c7"><span class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c0">Pe</span><span class="c4">: gain depuis l&rsquo;introduction en bourse.</span></p><p class="c7"><span class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c0">ChartDatas</span><span class="c4">: tableaux de valeurs de la cotation</span></p><p class="c7"><span class="c4 c32">Note: il y a beaucoup d&rsquo;autres informations renvoy&eacute;es par le webservice, mais dans ce tutoriel, on se limitera &agrave; ceux la</span></p><p class="c7"><span class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c0">Cr&eacute;ation des objets et r&eacute;cup&eacute;rations des informations.</span></p><p class="c7"><span class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cette fois, nous allons cr&eacute;er 2 classes pour empaqueter les informations sur les actions: StockData pour les informations de base (nom, code, market&hellip;) et une classe Extra pour des informations annexes (volume, capitalisation&hellip;).</span></p><p class="c7"><span class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c4 c32">NOTE: la classe Extra est un peu tir&eacute; par les cheveux, j&rsquo;avoue, c&rsquo;est juste pour illustrer le fait qu&rsquo;on peut inclure un presenter dans un presenter, ou un item_presenter dans un presenter.</span><span class="c4">&nbsp;</span></p><p class="c7"><span class="c0">function Extra ()</span><span class="c4">{</span></p><p class="c7"><span class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c4 c5">//les informations annexes pour la cotation...</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; this.open = null;</span><span class="c4 c5">//valeur a l&#39;ouverture</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; this.close = null;</span><span class="c4 c5">//valeur a la cloture precedente</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; this.volume = null;</span><span class="c4 c5">//volume d&#39;echange</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; this.avgVolume=null;</span><span class="c4 c5">//volume d&#39;echange moyen</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; this.capitalisation = null;</span><span class="c4 c5">//capitalisation boursiere</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; this.gain = null;</span><span class="c4 c5">//gain de l&#39;action depuis sa mise en bourse</span></p><p class="c7 c25"><span class="c4 c5"></span></p><p class="c7"><span class="c4">&nbsp; &nbsp; </span><span class="c4 c5">//permet d&rsquo;initialiser un objet Extra a partir des informations d&rsquo;un objet JSON r&eacute;cup&eacute;rer via le webservice</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; </span><span class="c0">this.copyFromJSON = function(infos)</span><span class="c4">{</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; this.open = infos.Op;</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; this.close = infos.Pp;</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; this.volume = infos.V;</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; this.avgVolume=infos.avgV;</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; this.capitalisation = infos.Mc;</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; this.gain = infos.Pe;</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; }</span></p><p class="c7"><span class="c4">}</span></p><p class="c7"><span class="c0">function StockData ()</span><span class="c4">{</span></p><p class="c7"><span class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c4 c5">//les informations sur la cotation</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; this.name = null;</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; this.code = null;</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; this.place = null;</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; this.market = null;</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; this.value = null;</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; this.gain = null;</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; this.pgain = null;</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; this.amplitude = null;</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c4 c5">//les informations annexes</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; this.extra = new Extra();</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c0">this.copyFromJSON = function(data)</span><span class="c4">{</span></p><p class="c7"><span class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c4 c5">//initialise un objet StockData avec les donn&eacute;es r&eacute;cup&eacute;r&eacute;es via le webservice</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; this.name = data.FrNm;</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; this.code = data.FlIns;</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; this.place = data.EExNm;</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; this.market = data.market;</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; this.value = data.Lp;</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; this.pgain = data.Chp;</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; this.gain = data.Ch;</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; this.amplitude = [data.Yl,data.Yh];</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; this.extra.copyFromJSON(data);</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c7"><span class="c4">}</span></p><p class="c7 c25"><span class="c4"></span></p><p class="c7 c25"><span class="c4"></span></p><p class="c7"><span class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dans le contexte de donn&eacute;es, on cr&eacute;e une nouvelle propri&eacute;t&eacute; &ldquo;stock&rdquo; qui repr&eacute;sentera la cotation s&eacute;lectionn&eacute;e par l&rsquo;utilisateur.</span></p><p class="c7"><span class="c0">function wowsContext () {</span></p><p class="c7"><span class="c0">&nbsp; &nbsp; this.</span><span class="c0 c2">app_name= &quot;Wolf of WallStreet&quot;, &nbsp; &nbsp;</span></p><p class="c7"><span class="c0 c2">&nbsp; &nbsp; </span><span class="c0">this.</span><span class="c0 c2">_search_txt=null, </span><span class="c0 c5">// le nom de l&#39;entreprise a rechercher</span></p><p class="c7"><span class="c0">&nbsp; &nbsp; this.</span><span class="c0 c2">suggestList=null,</span><span class="c0">&nbsp;</span><span class="c0 c5">//les resultats de la recherche</span><span class="c0">&nbsp; &nbsp; </span></p><p class="c7"><span class="c0">&nbsp; &nbsp; this.</span><span class="c0 c15">stock = new StockData(),</span><span class="c0 c5">//le stock a afficher</span></p><p class="c7"><span class="c0">};</span></p><p class="c7"><span class="c0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c4">Puis on modifie la m&eacute;thode &ldquo;</span><span class="c0">selectNewStock</span><span class="c4">&rdquo; pour lancer une requ&ecirc;te xhr et r&eacute;cup&eacute;rer les informations de cotations. Si elle r&eacute;ussie, la m&eacute;thode &ldquo;</span><span class="c0">copy_stock_details</span><span class="c4">&rdquo; sera appell&eacute;e pour mettre a jour l&rsquo;affichage:</span></p><p class="c7"><span class="c0">wowsContext.prototype.selectNewStock = function(evt, id)</span><span class="c4 c2">{</span></p><p class="c7"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c4">if (id != undefined){</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; this.stock_infos = null;</span></p><p class="c7"><span class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;url = &quot;</span><span class="c4 c21">http://finance.services.appex.bing.com/Market.svc/M-TodayEquityV4?rtSymbols=</span><span class="c4">&quot;</span></p><p class="c7"><span class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+id</span></p><p class="c7"><span class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&quot;</span><span class="c4 c21">&amp;chartSymbols=</span><span class="c4">&quot;+id</span></p><p class="c7"><span class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&quot;</span><span class="c4 c21">&amp;chartType=1Y&amp;lang=FR-FR&amp;localizeFor=FR-FR</span><span class="c4">&quot;;</span></p><p class="c7"><span class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="c4 c5">//chargement des donn&eacute;es</span></p><p class="c7"><span class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.__load_async_json (url,&quot;</span><span class="c4 c21">copy_stock_details</span><span class="c4">&quot; );</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c7"><span class="c4">}</span></p><p class="c7"><span class="c4 c5">//recupere et affiche les infos du stock</span></p><p class="c7"><span class="c0">wowsContext.prototype.copy_stock_details = function(data){</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; obj = data.Rtd[0];</span><span class="c4 c5">//les r&eacute;sultats se trouvent ici!</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; this.stock.copyFromJSON(obj);</span><span class="c4 c5">//copie les donn&eacute;es dans notre objet perso</span></p><p class="c7"><span class="c4">}</span></p><p class="c7"><span class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c0">Affichage des informations:</span></p><p class="c7"><span class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;On va maintenant modifier le &lt;</span><span class="c4 c10">DIV</span><span class="c4">&nbsp;</span><span class="c4 c5">id</span><span class="c4">=&rdquo;stock&rdquo;&gt; pour qu&rsquo;il affiche les informations charg&eacute;es dans notre propri&eacute;t&eacute; stock :</span></p><p class="c7 c25"><span class="c4"></span></p><p class="c7"><span class="c4 c2">&lt;</span><span class="c4 c10">div</span><span class="c4 c2">&nbsp;</span><span class="c4 c5">id</span><span class="c4 c2">=&quot;stock&quot;&gt;</span></p><p class="c6"><span class="c4">&lt;</span><span class="c4 c10">div</span><span class="c4">&gt;</span><span class="c0">{binding from:stock presenter:stock_presenter}</span><span class="c4 c2">&lt;/</span><span class="c4 c10">div</span><span class="c4 c2">&gt;</span></p><p class="c7"><span class="c4 c2">&lt;/</span><span class="c4 c10">div</span><span class="c4 c2">&gt;</span></p><p class="c7"><span class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;et cr&eacute;er le presenter &ldquo;</span><span class="c0">stock_presenter</span><span class="c4">&rdquo; qui sera charg&eacute; d&rsquo;afficher les propri&eacute;t&eacute;s d&rsquo;un objet de type </span><span class="c0">StockData</span><span class="c4">:</span></p><p class="c7 c25"><span class="c4 c2"></span></p><p class="c7"><span class="c4 c2">&lt;</span><span class="c4 c10">div</span><span class="c4 c2">&nbsp;</span><span class="c4 c5">data-role</span><span class="c4 c2">=&quot;presenter&quot; </span><span class="c4 c5">id</span><span class="c4 c2">=&quot;stock_presenter&quot;&gt;</span></p><p class="c7"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c4 c10">div</span><span class="c4 c2">&gt;</span></p><p class="c7"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c4 c10">div</span><span class="c4 c2">&nbsp;</span><span class="c4 c5">id</span><span class="c4 c2">=&rdquo;infos&rdquo;&gt;</span></p><p class="c7"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span class="c4 c10">div</span><span class="c4 c2">&nbsp;</span><span class="c4 c5">class</span><span class="c4 c2">=&quot;inline&quot;&gt;</span></p><p class="c7 c19"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c4 c10">h2</span><span class="c4 c2">&nbsp;</span><span class="c4 c5">class</span><span class="c4 c2">=&quot;stck_name&quot;&gt;</span><span class="c0">{binding from:name fallback:--}</span><span class="c4 c2">&lt;/</span><span class="c4 c10">h2</span><span class="c4 c2">&gt;&lt;</span><span class="c4 c10">br</span><span class="c4 c2">/&gt;</span></p><p class="c7 c19"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c4 c10">h4</span><span class="c4 c2">&nbsp;</span><span class="c4 c5">class</span><span class="c4 c2">=&quot;stck_place&quot; &gt;</span><span class="c0">{binding from:place fallback:&#39;no data&#39;}</span><span class="c4 c2">&lt;/</span><span class="c4 c10">h4</span><span class="c4 c2">&gt;</span></p><p class="c7 c19"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c4 c10">h4</span><span class="c4 c2">&nbsp;</span><span class="c4 c5">class</span><span class="c4 c2">=&quot;stck_place&quot; &gt;(</span><span class="c0">{binding from:market fallback:&#39;--&#39;}</span><span class="c4 c2">)&lt;/</span><span class="c4 c10">h4</span><span class="c4 c2">&gt;</span></p><p class="c7 c19"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/</span><span class="c4 c10">div</span><span class="c4 c2">&gt;</span></p><p class="c7 c25 c19"><span class="c4 c2"></span></p><p class="c7 c19"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c4 c10">div</span><span class="c4 c2">&nbsp;</span><span class="c4 c5">id</span><span class="c4 c2">=&quot;values&quot; &gt;</span></p><p class="c7 c19"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c4 c10">h4</span><span class="c4 c2">&nbsp;</span><span class="c4 c5">class</span><span class="c4 c2">=&quot;stck_place&quot;&gt;</span></p><p class="c6 c37"><span class="c0">{binding from:gain fallback:&#39;--&#39;}</span></p><p class="c6 c23"><span class="c4 c2">&lt;/</span><span class="c4 c10">h4</span><span class="c4 c2">&gt;&amp;nbsp;</span></p><p class="c7 c23"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &lt;</span><span class="c4 c10">h4</span><span class="c4 c2">&nbsp;</span><span class="c4 c5">class</span><span class="c4 c2">=&quot;stck_place&quot;&gt;</span><span class="c0">{binding from:gain fallback:&#39;--&#39;}</span><span class="c4 c2">%&lt;/</span><span class="c4 c10">h4</span><span class="c4 c2">&gt;</span></p><p class="c6 c23"><span class="c4 c2">&lt;</span><span class="c4 c10">h1</span><span class="c4 c2">&nbsp;</span><span class="c4 c10">class</span><span class="c4 c2">=&quot;stck_value&quot;&gt;</span><span class="c0">{binding from:value fallback:&#39;--&#39;}</span><span class="c4 c2">&lt;/</span><span class="c4 c10">h1</span><span class="c4 c2">&gt;</span></p><p class="c7 c19"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/</span><span class="c4 c10">div</span><span class="c4 c2">&gt;</span></p><p class="c7"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/</span><span class="c4 c10">div</span><span class="c4 c2">&gt;</span></p><p class="c7"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div id=&rdquo;graph&rdquo;&gt;</span></p><p class="c6 c24"><span class="c4 c2">&lt;svg&gt;</span></p><p class="c7"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/svg&gt;</span></p><p class="c7"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;</span></p><p class="c7"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &lt;!-- ici, on inclue un presenter pour afficher la propri&eacute;t&eacute; &ldquo;extra&rdquo; --&gt;</span></p><p class="c7"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c4 c10">div</span><span class="c4 c2">&nbsp;</span><span class="c4 c5">id</span><span class="c4 c2">=&quot;extra&quot;&gt;</span><span class="c0">{binding from:extra presenter:extra_presenter}</span><span class="c4 c2">&lt;/</span><span class="c4 c10">div</span><span class="c4 c2">&gt;</span></p><p class="c7"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/</span><span class="c4 c10">div</span><span class="c4 c2">&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></p><p class="c7"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/</span><span class="c4 c10">div</span><span class="c4 c2">&gt;</span></p><p class="c7"><span class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Et donc, on en profite pour cr&eacute;er aussi le presenter pour le type </span><span class="c0">Extra</span><span class="c4">:</span></p><p class="c7"><span class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c4 c2">&lt;</span><span class="c4 c10">div</span><span class="c4 c2">&nbsp;</span><span class="c4 c5">data-role</span><span class="c4 c2">=&quot;presenter&quot; </span><span class="c4 c5">id</span><span class="c4 c2">=&quot;extra_presenter&quot;&gt;</span></p><p class="c7"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c4 c10">ul</span><span class="c4 c2">&nbsp;</span><span class="c4 c5">id</span><span class="c4 c2">=&quot;st_infs&quot; </span><span class="c4 c5">class</span><span class="c4 c2">=&quot;center_horizontal&quot;&gt;</span></p><p class="c7"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c4 c10">li</span><span class="c4 c2">&gt;&lt;</span><span class="c4 c5">span</span><span class="c4 c2">&nbsp;</span><span class="c4 c5">class</span><span class="c4 c2">=&quot;label&quot; &gt;Ouverture&lt;/</span><span class="c4 c10">span</span><span class="c4 c2">&gt;</span></p><p class="c7 c20"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;</span><span class="c4 c10">span</span><span class="c4 c2">&nbsp;</span><span class="c4 c5">class</span><span class="c4 c2">=&quot;datas&quot;&gt;</span><span class="c0">{binding from:open fallback:--,--}</span><span class="c4 c2">&lt;/</span><span class="c4 c10">span</span><span class="c4 c2">&gt;</span></p><p class="c7 c20"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &lt;/</span><span class="c4 c10">li</span><span class="c4 c2">&gt;</span></p><p class="c7"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c4 c10">li</span><span class="c4 c2">&gt;</span></p><p class="c7 c24"><span class="c4 c2">&nbsp; &nbsp;&lt;</span><span class="c4 c10">span</span><span class="c4 c2">&nbsp;</span><span class="c4 c5">class</span><span class="c4 c2">=&quot;label&quot;&gt;Cloture precedente&lt;/</span><span class="c4 c10">span</span><span class="c4 c2">&gt;</span></p><p class="c7 c24"><span class="c4 c2">&nbsp; &nbsp;&lt;</span><span class="c4 c10">span</span><span class="c4 c2">&nbsp;</span><span class="c4 c5">class</span><span class="c4 c2">=&quot;datas&quot;&gt;</span><span class="c0">{binding from:close fallback:--,--}</span><span class="c4 c2">&lt;/</span><span class="c4 c10">span</span><span class="c4 c2">&gt;</span></p><p class="c6 c20"><span class="c4 c2">&lt;/</span><span class="c4 c10">li</span><span class="c4 c2">&gt;</span></p><p class="c7"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;</span><span class="c4 c10">li</span><span class="c4 c2">&gt;</span></p><p class="c6 c24"><span class="c4 c2">&lt;</span><span class="c4 c10">span</span><span class="c4 c2">&nbsp;</span><span class="c4 c5">class</span><span class="c4 c2">=&quot;label&quot; &gt;Volume&lt;/</span><span class="c4 c10">span</span><span class="c4 c2">&gt;</span></p><p class="c6 c24"><span class="c4 c2">&lt;</span><span class="c4 c10">span</span><span class="c4 c2">&nbsp;</span><span class="c4 c5">class</span><span class="c4 c2">=&quot;datas&quot;&gt;</span><span class="c0">{binding from:volume fallback:--,--}</span><span class="c4 c2">&lt;/</span><span class="c4 c10">span</span><span class="c4 c2">&gt;</span></p><p class="c6 c20"><span class="c4 c2">&lt;/</span><span class="c4 c10">li</span><span class="c4 c2">&gt;</span></p><p class="c7"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c4 c10">li</span><span class="c4 c2">&gt;</span></p><p class="c6 c24"><span class="c4 c2">&lt;</span><span class="c4 c10">span</span><span class="c4 c2">&nbsp;</span><span class="c4 c5">class</span><span class="c4 c2">=&quot;label&quot; &gt;Volume moyen&lt;/</span><span class="c4 c10">span</span><span class="c4 c2">&gt;</span></p><p class="c7 c27"><span class="c4 c2">&lt;</span><span class="c4 c10">span</span><span class="c4 c2">&nbsp;</span><span class="c4 c5">class</span><span class="c4 c2">=&quot;datas&quot;&gt;</span><span class="c0">{binding from:avgVolume fallback:--,--}</span><span class="c4 c2">&lt;/</span><span class="c4 c10">span</span><span class="c4 c2">&gt;</span></p><p class="c6 c20"><span class="c4 c2">&lt;/</span><span class="c4 c10">li</span><span class="c4 c2">&gt;</span></p><p class="c7"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c4 c10">li</span><span class="c4 c2">&gt;</span></p><p class="c6 c24"><span class="c4 c2">&lt;</span><span class="c4 c10">span</span><span class="c4 c2">&nbsp;</span><span class="c4 c5">class</span><span class="c4 c2">=&quot;label&quot; &gt;Capitalisation (Mrds)&lt;/</span><span class="c4 c10">span</span><span class="c4 c2">&gt;</span></p><p class="c6 c24"><span class="c4 c2">&lt;</span><span class="c4 c10">span</span><span class="c4 c2">&nbsp;</span><span class="c4 c5">class</span><span class="c4 c2">=&quot;datas&quot;&gt;</span><span class="c0">{binding from:capitalisation fallback:--,--}</span><span class="c4 c2">&lt;/</span><span class="c4 c10">span</span><span class="c4 c2">&gt;</span></p><p class="c6 c20"><span class="c4 c2">&lt;/</span><span class="c4 c10">li</span><span class="c4 c2">&gt;</span></p><p class="c7"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c4 c10">li</span><span class="c4 c2">&gt;</span></p><p class="c6 c24"><span class="c4 c2">&lt;</span><span class="c4 c10">span</span><span class="c4 c2">&nbsp;</span><span class="c4 c5">class</span><span class="c4 c2">=&quot;label&quot; &gt;Prix/Gain (%)&lt;/</span><span class="c4 c10">span</span><span class="c4 c2">&gt;</span></p><p class="c6 c24"><span class="c4 c2">&lt;</span><span class="c4 c10">span</span><span class="c4 c2">&nbsp;</span><span class="c4 c5">class</span><span class="c4 c2">=&quot;datas&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&gt;</span><span class="c0">{binding from:gain fallback:--,--}</span><span class="c4 c2">&lt;/</span><span class="c4 c10">span</span><span class="c4 c2">&gt;</span></p><p class="c6 c20"><span class="c4 c2">&lt;/</span><span class="c4 c10">li</span><span class="c4 c2">&gt;</span></p><p class="c7"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/</span><span class="c4 c10">ul</span><span class="c4 c2">&gt;</span></p><p class="c7"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/</span><span class="c4 c10">div</span><span class="c4 c2">&gt;</span></p><p class="c7"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c4">Pour finir, un peu de style pour l&rsquo;affichage:</span></p><p class="c7"><span class="c4">wows.css:</span></p><p class="c7 c25"><span class="c4 c2"></span></p><p class="c7"><span class="c0 c2">h1, h2, h3, h4, h5</span><span class="c4 c2">{</span></p><p class="c7"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c4 c10">line-height</span><span class="c4 c2">: 1em;</span></p><p class="c7"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c4 c10">margin</span><span class="c4 c2">: 0;</span></p><p class="c7"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c4 c10">display</span><span class="c4 c2">: block;</span></p><p class="c7"><span class="c4 c2">}</span></p><p class="c7 c25"><span class="c4 c2"></span></p><p class="c7"><span class="c0 c2">#stock_infos</span><span class="c4 c2">{</span></p><p class="c7"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c4 c10">float</span><span class="c4 c2">:right;</span></p><p class="c7"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c4 c10">width</span><span class="c4 c2">:80%;</span></p><p class="c7"><span class="c4 c2">}</span></p><p class="c7"><span class="c0 c2">#extra &gt;div</span><span class="c4 c2">{</span></p><p class="c7"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c4 c10">width</span><span class="c4 c2">:75%;</span></p><p class="c7"><span class="c4 c2">}</span></p><p class="c7"><span class="c0 c2">#extra ul</span><span class="c4 c2">{</span></p><p class="c7"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c4 c10">display</span><span class="c4 c2">:table;</span></p><p class="c7"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c4 c10">list-style</span><span class="c4 c2">:none;</span></p><p class="c7"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c4 c10">margin</span><span class="c4 c2">:2%;</span></p><p class="c7"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c4 c10">margin-top</span><span class="c4 c2">:10px;</span></p><p class="c7"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c4 c10">width</span><span class="c4 c2">:90%;</span></p><p class="c7"><span class="c4 c2">}</span></p><p class="c7"><span class="c0 c2">#extra ul &gt;li</span><span class="c4 c2">{</span></p><p class="c7"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c4 c10">display</span><span class="c4 c2">:table-row;</span></p><p class="c7"><span class="c4 c2">}</span></p><p class="c7"><span class="c0 c2">#extra ul &gt;li:last-child&gt;span </span><span class="c4 c2">{</span></p><p class="c7"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c4 c10">border-bottom</span><span class="c4 c2">:none !important;</span></p><p class="c7"><span class="c4 c2">}</span></p><p class="c7"><span class="c0 c2">.label</span><span class="c4 c2">{</span></p><p class="c7"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c4 c10">font-size</span><span class="c4 c2">: 0.8em;</span></p><p class="c7"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c4 c10">font-style</span><span class="c4 c2">: italic;</span></p><p class="c7"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c4 c10">color</span><span class="c4 c2">: #a6a6a6;</span></p><p class="c7"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c4 c10">display</span><span class="c4 c2">: table-cell;</span></p><p class="c7"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c4 c10">border-bottom</span><span class="c4 c2">: 1px dashed #e3e3e3;</span></p><p class="c7"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c4 c10">padding-bottom</span><span class="c4 c2">: 10px;</span></p><p class="c7"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c4 c10">padding-top</span><span class="c4 c2">:10px;</span></p><p class="c7"><span class="c4 c2">}</span></p><p class="c7"><span class="c0 c2">.datas </span><span class="c4 c2">{</span></p><p class="c7"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c4 c10">display</span><span class="c4 c2">: table-cell;</span></p><p class="c7"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c4 c10">font-size</span><span class="c4 c2">: 1.1em;</span></p><p class="c7"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c4 c10">font-weight</span><span class="c4 c2">: bolder;</span></p><p class="c7"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c4 c10">text-align</span><span class="c4 c2">: right;</span></p><p class="c7"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c4 c10">border-bottom</span><span class="c4 c2">: 1px dashed #e3e3e3;</span></p><p class="c7"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;</span></p><p class="c7"><span class="c4 c2">}</span></p><p class="c7"><span class="c0 c2">.stck_name</span><span class="c4 c2">{</span></p><p class="c7"><span class="c4 c2">&nbsp; &nbsp; </span><span class="c4 c10">line-height</span><span class="c4 c2">: 30px;</span></p><p class="c7"><span class="c4 c2">&nbsp; &nbsp; </span><span class="c4 c10">margin-right</span><span class="c4 c2">: 10px;</span></p><p class="c7"><span class="c4 c2">&nbsp; &nbsp; </span><span class="c4 c10">display</span><span class="c4 c2">:inline-block;</span></p><p class="c7"><span class="c4 c2">}</span></p><p class="c7"><span class="c0 c2">.inline</span><span class="c4 c2">&nbsp;{</span><span class="c4 c10">display</span><span class="c4 c2">: inline-block;}</span></p><p class="c7"><span class="c0 c2">#values</span><span class="c4 c2">{</span><span class="c4 c10">float</span><span class="c4 c2">:right;}</span></p><p class="c7"><span class="c0 c2">#infos</span><span class="c4 c2">{</span><span class="c4 c10">padding-left</span><span class="c4 c2">:10px;</span></p><p class="c7"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c4 c10">padding-right</span><span class="c4 c2">:10px;}</span></p><p class="c7 c25"><span class="c4"></span></p><p class="c6 c19"><span class="c0">am&eacute;liorer les affichages: signToColor, Localize</span><span class="c4">:</span></p><p class="c6 c19"><span class="c4">Pour rendre les affichages un peu plus lisibles, </span><span class="c0">on va localiser les diff&eacute;rentes valeurs</span><span class="c4">, c.a.d. &nbsp;transformer un &ldquo;2.3456&rdquo; en une version francis&eacute;e avec 2 chiffres apr&egrave;s la virgule: &ldquo;2,35&rdquo;. Dans le fichier wows.js, </span><span class="c0">on cr&eacute;e une m&eacute;thode de conversion &ldquo;localize&rdquo;</span><span class="c4">&nbsp;qui prends en param&egrave;tres la valeur du binding, et un extra &ldquo;after_dot_count&rdquo; qui, s&rsquo;il est renseign&eacute;, permet de pr&eacute;ciser le nombre de chiffres apr&egrave;s la virgule:</span></p><p class="c7 c19"><span class="c0 c2">function localize(value, after_dot_count)</span><span class="c4 c2">{</span></p><p class="c7 c19"><span class="c4 c2">&nbsp; </span><span class="c4 c5">//remplace le point par une virgule</span></p><p class="c7 c19"><span class="c4 c2">&nbsp; if (value == null) return &quot;&quot;;</span></p><p class="c7 c19"><span class="c4 c2">&nbsp; after = after_dot_count || 2;</span></p><p class="c7 c19"><span class="c4 c2">&nbsp; return &nbsp;value.toLocaleString(&quot;fr-FR&quot;,{maximumFractionDigits:after, minimumFractionDigits:after});</span></p><p class="c7 c25 c19"><span class="c4 c2"></span></p><p class="c7 c19"><span class="c4 c2">}</span></p><p class="c7 c25 c19"><span class="c4 c2"></span></p><p class="c7 c19"><span class="c4">Et, &agrave; chaque valeur num&eacute;rique, on renseigne le converter pour avoir l&rsquo;affichage en fran&ccedil;ais, par exemple,le binding des informations de gains/valeur actuelle deviendrait:</span></p><p class="c6 c20"><span class="c4 c2">&lt;</span><span class="c4 c10">div</span><span class="c4 c2">&nbsp;</span><span class="c4 c5">id</span><span class="c4 c2">=&quot;values&quot; &gt;</span></p><p class="c7"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c4 c10">h4</span><span class="c4 c2">&nbsp;</span><span class="c4 c5">class</span><span class="c4 c2">=&quot;stck_place&quot;&gt;</span></p><p class="c6 c23"><span class="c0">{binding from:gain </span><span class="c0 c15">converter:localize</span><span class="c0">&nbsp; fallback:&#39;--&#39;}</span></p><p class="c6 c27"><span class="c4 c2">&lt;/</span><span class="c4 c10">h4</span><span class="c4 c2">&gt;&amp;nbsp;</span></p><p class="c7 c27"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &lt;</span><span class="c4 c10">h4</span><span class="c4 c2">&nbsp;</span><span class="c4 c5">class</span><span class="c4 c2">=&quot;stck_place&quot;&gt;</span><span class="c0">{binding from:pgain &nbsp;</span><span class="c0 c15">converter:localize</span><span class="c0">&nbsp;fallback:&#39;--&#39;}</span><span class="c4 c2">%&lt;/</span><span class="c4 c10">h4</span><span class="c4 c2">&gt;</span></p><p class="c6 c27"><span class="c4 c2">&lt;</span><span class="c4 c10">h1</span><span class="c4 c2">&nbsp;</span><span class="c4 c10">class</span><span class="c4 c2">=&quot;stck_value&quot;&gt;</span></p><p class="c6 c27"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;!-- ici, on demande 3 chiffres apr&egrave;s la virgule! --&gt;</span></p><p class="c6 c23"><span class="c0">{binding from:value &nbsp;</span><span class="c0 c15">converter:localize convereter_params:3</span><span class="c0">&nbsp;fallback:&#39;--&#39;}</span></p><p class="c7 c23"><span class="c4 c2">&lt;/</span><span class="c4 c10">h1</span><span class="c4 c2">&gt;</span></p><p class="c7"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/</span><span class="c4 c10">div</span><span class="c4 c2">&gt;</span></p><p class="c7 c19"><span class="c4">De m&ecirc;me, </span><span class="c0">on va modifier la couleur d&rsquo;affichage des gains/valeurs suivant le signe du gain</span><span class="c4">, rouge si la valeur est n&eacute;gative, vert si elle est positive. On commence par cr&eacute;er 2 nouvelles classes CSS:</span></p><p class="c7 c19"><span class="c4 c2">.</span><span class="c0 c2">negatif</span><span class="c4 c2">{</span><span class="c4 c10">color</span><span class="c4 c2">:red;}</span></p><p class="c7 c19"><span class="c4 c2">.</span><span class="c0 c2">positif</span><span class="c4 c2">{</span><span class="c4 c10">color</span><span class="c4 c2">:green;}</span></p><p class="c7 c25 c19"><span class="c4 c2"></span></p><p class="c7 c19"><span class="c4">Puis une m&eacute;thode de conversion qui prendra en valeur le gain de l&rsquo;action et renverra le nom de la classe CSS &agrave; utiliser suivant le signe:</span></p><p class="c7 c19"><span class="c0 c2">function signToColor(value)</span><span class="c4 c2">{</span></p><p class="c7 c19"><span class="c4 c2">&nbsp; &nbsp; if(value &lt; 0) return &quot;</span><span class="c4 c21">negatif</span><span class="c4 c2">&quot;;</span></p><p class="c7 c19"><span class="c4 c2">&nbsp; &nbsp; else return &quot;</span><span class="c4 c21">positif</span><span class="c4 c2">&quot;;</span></p><p class="c7 c19"><span class="c4 c2">}</span></p><p class="c7 c19"><span class="c4">Et on cr&eacute;e de nouveaux bindings, cette fois sur l&rsquo;attribut &ldquo;class&rdquo; de nos &eacute;l&eacute;ments HTML (qu&rsquo;on renomme </span><span class="c0">data-binded-class</span><span class="c4">):</span></p><p class="c7 c25 c19"><span class="c4"></span></p><p class="c6 c20"><span class="c4 c2">&lt;</span><span class="c4 c10">div</span><span class="c4 c2">&nbsp;</span><span class="c4 c5">id</span><span class="c4 c2">=&quot;values&quot; &gt;</span></p><p class="c7"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c4 c10">h4</span><span class="c4 c2">&nbsp;</span><span class="c0 c15">data-binded-class</span><span class="c4 c2">=&quot;stck_place </span><span class="c0 c15">{binding from:gain converter:signToColor}</span><span class="c4 c2">&quot;&gt;</span></p><p class="c6 c23"><span class="c0">{binding from:gain </span><span class="c0">converter:localize</span><span class="c0">&nbsp; fallback:&#39;--&#39;}</span></p><p class="c6 c27"><span class="c4 c2">&lt;/</span><span class="c4 c10">h4</span><span class="c4 c2">&gt;&amp;nbsp;</span></p><p class="c7 c27"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &lt;</span><span class="c4 c10">h4</span><span class="c4 c2">&nbsp; </span><span class="c0 c15">data-binded-class</span><span class="c4 c2">=&quot;stck_place </span><span class="c0 c15">{binding from:gain converter:signToColor}</span><span class="c4 c2">&quot;&gt;</span></p><p class="c6 c23"><span class="c0">{binding from:pgain &nbsp;</span><span class="c0">converter:localize</span><span class="c0">&nbsp;fallback:&#39;--&#39;}</span><span class="c4 c2">%</span></p><p class="c6 c27"><span class="c4 c2">&lt;/</span><span class="c4 c10">h4</span><span class="c4 c2">&gt;</span></p><p class="c6 c27"><span class="c4 c2">&lt;</span><span class="c4 c10">h1</span><span class="c4 c2">&nbsp; </span><span class="c0 c15">data-binded-class</span><span class="c4 c2">=&quot;stck_value </span><span class="c0 c15">{binding from:gain converter:signToColor}</span><span class="c4 c2">&quot;&gt;</span></p><p class="c6 c27"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;!-- ici, on demande 3 chiffres apr&egrave;s la virgule! --&gt;</span></p><p class="c6 c23"><span class="c0">{binding from:value &nbsp;</span><span class="c0">converter:localize convereter_params:3</span><span class="c0">&nbsp;fallback:&#39;--&#39;}</span></p><p class="c7 c23"><span class="c4 c2">&lt;/</span><span class="c4 c10">h1</span><span class="c4 c2">&gt;</span></p><p class="c7"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/</span><span class="c4 c10">div</span><span class="c4 c2">&gt;</span></p><p class="c7 c25"><span class="c4"></span></p><p class="c6"><span class="c0">SVG, affichage des informations sous forme de graphiques</span><span class="c4">:</span></p><p class="c6"><span class="c4">Cette fois ci, on va travailler avec les donn&eacute;es de ChartDatas pour afficher dans un graphique SVG l&rsquo;&eacute;volution de la valeur de la cotation dans le temps. </span><span class="c0">On ajoute une propri&eacute;t&eacute; &ldquo;charts&rdquo; </span><span class="c4">dans notre objet &ldquo;</span><span class="c0">StockData</span><span class="c4">&rdquo; et on l&rsquo;initialise avec les autres dans la m&eacute;thode &ldquo;copyFromJSON&rdquo;:</span></p><p class="c6"><span class="c0 c2">function StockData ()</span><span class="c4 c2">{</span></p><p class="c6"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&hellip;</span></p><p class="c6"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c4 c15">this.charts = null;</span></p><p class="c6"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c0 c2">this.copyFromJSON = function(data, </span><span class="c0 c15">charts</span><span class="c0 c2">)</span><span class="c4 c2">{</span></p><p class="c6"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&hellip;</span></p><p class="c6"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c4 c15">this.charts = charts;</span><span class="c4 c5">//les valeurs dans le temps</span></p><p class="c6"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p><p class="c6"><span class="c4 c2">}</span></p><p class="c6"><span class="c4 c2">On modifie aussi la m&eacute;thode</span><span class="c0 c2">&nbsp;copy_stock_details </span><span class="c4 c2">pour passer les donn&eacute;es des graphique &agrave; la m&eacute;thode copyFromJSON:</span></p><p class="c6"><span class="c0 c2">wowsContext.prototype.copy_stock_details = function(data)</span><span class="c4 c2">{</span></p><p class="c6"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; obj = data.Rtd[0];</span></p><p class="c6"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; this.stock.copyFromJSON(obj,</span><span class="c4 c15">&nbsp;data.Charts[0].Series</span><span class="c4 c2">);</span></p><p class="c6"><span class="c4 c2">}</span></p><p class="c6 c25"><span class="c4 c2"></span></p><p class="c6"><span class="c4">Et on demande a afficher un graphique SVG dans notre page HTML:</span></p><ul class="c28 lst-kix_lt6ovg7vgtck-0 start"><li class="c7 c29 c26"><span class="c4">dans le tag &lt;SVG&gt;, </span><span class="c0">on ajoute un tag &lt;POLYGON&gt;</span><span class="c4">&nbsp;qui repr&eacute;sentera notre graphique</span></li><li class="c7 c29 c26"><span class="c0">on cr&eacute;e le binding sur l&rsquo;attribut &ldquo;POINTS&rdquo;</span><span class="c4">&nbsp;(qu&rsquo;on renomme &ldquo;data-binded-points&rdquo;) et on force le binding sur l&rsquo;attribut html plut&ocirc;t que la propri&eacute;t&eacute; de l&rsquo;objet SVGElement. (pour laisser au soin du navigateur les conversions string/SVGPoints)</span></li><li class="c7 c29 c26"><span class="c4">on indique d&rsquo;</span><span class="c0">utiliser un converter &ldquo;linearise&rdquo;</span><span class="c4">&nbsp;en passant en param&egrave;tre l&rsquo;amplitude de la courbe.</span></li></ul><p class="c7 c25"><span class="c4"></span></p><p class="c7 c25"><span class="c4"></span></p><p class="c7 c25"><span class="c4"></span></p><p class="c6"><span class="c4 c2">&lt;</span><span class="c4 c10">div</span><span class="c4 c2">&nbsp;</span><span class="c4 c5">id</span><span class="c4 c2">=&quot;graph&quot;&gt;</span></p><p class="c6"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &lt;</span><span class="c4 c10">svg</span><span class="c4 c2">&nbsp;</span><span class="c4 c5">class</span><span class="c4 c2">=&quot;graph center_horizontal&quot; </span><span class="c4 c5">id</span><span class="c4 c2">=&quot;svg_graph&quot; </span><span class="c4 c5">viewBox</span><span class="c4 c2">=&quot;0 0 100 100&quot; </span><span class="c4 c5">preserveAspectRatio</span><span class="c4 c2">=&quot;none&quot;&gt; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span class="c4 c10">polygon</span><span class="c4 c2">&nbsp;</span><span class="c4 c5">fill</span><span class="c4 c2">=&quot;#8FD1FD&quot; </span><span class="c4 c5">data-binded-points</span><span class="c4 c2">=&quot;</span><span class="c0">{binding from:chart &nbsp;converter:linearise converter_params:$amplitude forceAttr:true}</span><span class="c4 c2">&quot;&gt;&lt;/</span><span class="c4 c10">polygon</span><span class="c4 c2">&gt;</span></p><p class="c6"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;!-- on dessine juste des axes tout simplement --&gt;</span></p><p class="c6"><span class="c4 c2">&nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span class="c4 c10">line</span><span class="c4 c2">&nbsp;</span><span class="c4 c5">id</span><span class="c4 c2">=&quot;axey&quot; </span><span class="c4 c5">x1</span><span class="c4 c2">=&quot;0&quot; </span><span class="c4 c5">y1</span><span class="c4 c2">=&quot;0&quot; </span><span class="c4 c5">x2</span><span class="c4 c2">=&quot;0&quot; </span><span class="c4 c5">y2</span><span class="c4 c2">=&quot;100%&quot; </span><span class="c4 c5">style</span><span class="c4 c2">=&quot;stroke:#a6a6a6;stroke-width:0.2&quot;&gt;&lt;/</span><span class="c4 c10">line</span><span class="c4 c2">&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;</span><span class="c4 c10">line</span><span class="c4 c2">&nbsp;</span><span class="c4 c5">id</span><span class="c4 c2">=&quot;axex&quot; </span><span class="c4 c5">x1</span><span class="c4 c2">=&quot;0&quot; </span><span class="c4 c5">y1</span><span class="c4 c2">=&quot;100%&quot; </span><span class="c4 c5">x2</span><span class="c4 c2">=&quot;100%&quot; </span><span class="c4 c5">y2</span><span class="c4 c2">=&quot;100%&quot; </span><span class="c4 c5">style</span><span class="c4 c2">=&quot;stroke:#a6a6a6;stroke-width:0.1&quot;&gt; &lt;/</span><span class="c4 c10">line</span><span class="c4 c2">&gt;</span></p><p class="c6"><span class="c4 c2">&nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/</span><span class="c4 c10">svg</span><span class="c4 c2">&gt;</span></p><p class="c6"><span class="c4 c2">&nbsp; &nbsp;&lt;/</span><span class="c4 c10">div</span><span class="c4 c2">&gt;</span></p><p class="c6"><span class="c4 c2">Converter pour les donn&eacute;es du chart:</span></p><p class="c6"><span class="c0 c2">function linearise(value, plage)</span><span class="c4 c2">{</span></p><p class="c6"><span class="c4 c2">&nbsp; &nbsp; </span><span class="c4 c5">//linearise le tableau de donn&eacute;es pour dessiner les courbes</span></p><p class="c6"><span class="c4 c5">&nbsp; &nbsp; //comme svg travaille avec des objets particuliers</span></p><p class="c6"><span class="c4 c5">&nbsp; &nbsp; //on passe par les attributs et on laisse faire le navigateur</span></p><p class="c7"><span class="c4 c5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;//le converter est appel&eacute; avant toute chose, vous devez v&eacute;rifier si la valeur est null ou undefined</span></p><p class="c7"><span class="c4 c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // et agir en cons&eacute;quence</span></p><p class="c6"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (value==null || value == undefined) return &ldquo;&rdquo;;</span></p><p class="c6"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; total = value.length;</span></p><p class="c6"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; if (plage == null || plage[0]==null || plage[1]==null) plage=[0,100];</span></p><p class="c6"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;step_x = (100 / total);</span></p><p class="c6"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;step_y = 100 /(plage[1]-plage[0])</span></p><p class="c6 c25"><span class="c4 c2"></span></p><p class="c6"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dts = &quot;&quot;;</span></p><p class="c6"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (i=0; i &lt; total; i++){</span></p><p class="c6"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c4 c5">//converti en %</span></p><p class="c6"><span class="c4 c5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//chaque objet de value poss&egrave;de une propri&eacute;t&eacute; P qui contient la valeur</span></p><p class="c6"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v = step_y * (plage[1]-value[i].P );</span></p><p class="c6"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x = step_x * i;</span></p><p class="c6"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dts+= x+&quot;,&quot;+v+&quot; &quot;;</span></p><p class="c6"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p><p class="c6 c25"><span class="c4 c2"></span></p><p class="c6"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return &nbsp;&quot;0,100 &quot;+dts+&quot;100,100&quot;;</span></p><p class="c6"><span class="c4 c2">}</span></p><p class="c6 c25"><span class="c4"></span></p><p class="c6"><span class="c4">Comme d&rsquo;habitude, on style le graphique...</span></p><p class="c6 c25"><span class="c4 c2"></span></p><p class="c6"><span class="c0 c2">.graph</span><span class="c4 c2">{</span></p><p class="c6"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c4 c10">width</span><span class="c4 c2">: 80%;</span></p><p class="c6"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c4 c10">height</span><span class="c4 c2">: 450px;</span></p><p class="c6"><span class="c4 c2">}</span></p><p class="c6"><span class="c0 c2">.center_horizontal</span><span class="c4 c2">{</span></p><p class="c6"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c4 c10">position</span><span class="c4 c2">: relative;</span></p><p class="c6"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c4 c10">left</span><span class="c4 c2">: 50%;</span></p><p class="c6"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c4 c10">transform</span><span class="c4 c2">: translate(-50%,0);</span></p><p class="c6"><span class="c4 c2">}</span></p><p class="c6 c25"><span class="c4 c2"></span></p><p class="c6 c25"><span class="c4 c2"></span></p><p class="c6"><span class="c0 c32">Note &nbsp;Renommer POINTS en DATA-BINDED-POINTS:</span></p><p class="c6"><span class="c4 c32">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Il est vivement conseill&eacute;, quand on travaille avec le SVG, de renommer les attributs que vous allez &ldquo;binder&rdquo; avec le pr&eacute;fixe &ldquo;data-binded-&rdquo;. Certains navigateurs (Edge, pour ne pas le nommer), lorsqu&rsquo;il rencontre un attribut SVG invalide, semble tout simplement annuler le rendu et merci, au revoir. Heureusement, les attributs inconnus (et pr&eacute;fix&eacute;s par data) ne semblent pas poser probl&egrave;mes&hellip;</span></p><p class="c7 c25"><span class="c4"></span></p><p class="c7"><span class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c0">Des rep&egrave;res visuels pour les valeurs</span><span class="c4">:</span></p><p class="c7"><span class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;On va rajouter au graphique des rep&egrave;res visuels &agrave; 20%, 40%, 60% et 80% de la hauteur du graphique pour rendre la lecture plus facile. A chaque cran, on dessine une ligne horizontale en pointill&eacute;e et en bout, la valeur que represente la ligne (ainsi, si les donn&eacute;es sont comprises entre 100 et 200, on affichera les lignes correspondantes &agrave; 120, 140, 160 et 180). </span></p><p class="c7"><span class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c4 c31">On rajoute dans le SVG un binding sur &ldquo;</span><span class="c0 c31">amplitude</span><span class="c4 c31">&rdquo; (les valeurs min et max sur 52 semaines), on utilise un converter &ldquo;toReferences&rdquo; qui renverra &agrave; partir des informations d&rsquo;amplitudes un tableau de 4 valeurs, et un item_presenter (puisque tableau) pour afficher les lignes.</span></p><p class="c7"><span class="c4 c31">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c4">On cr&eacute;e une nouvelle propri&eacute;t&eacute; &quot;r&eacute;f&eacute;rences&quot; dans l&#39;objet StockData qui renverra un tableau renfermant ces informations. Comme elle ne sera que calcul&eacute;e &agrave; partir de la donn&eacute;e &quot;amplitude&quot;, on ne lui d&eacute;finira qu&#39;un getter:</span></p><p class="c7"><span class="c0">StockData.defineBindProperty</span><span class="c4">(&quot;references&quot;,{</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; get: function(){</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c4 c5">&nbsp;//renvois les valeurs a 20, 40, 60 et 80% de la hauteur, suivant l&#39;amplitude a 52 semaines (ie: valeurs</span></p><p class="c7"><span class="c4 c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // a 0%=Yl et 100%=Yh</span></p><p class="c7"><span class="c4 c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //sous la forme: i: le pourcentage de la hauteur, v: la valeur a cette hauteur</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; var value = this.amplitude;</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (value == null) return null;</span></p><p class="c7 c25"><span class="c4"></span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; total = value[1]-value[0];</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; min = value[0]</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c4 c5">&nbsp;//les 4 indexs qui nous int&eacute;resse...</span></p><p class="c7 c25"><span class="c4"></span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; v= [ {i:&#39;80&#39;,v:min+(total*0.2)},{i:&#39;60&#39;,v:min+(total*0.4)},{i:&#39;40&#39;,v:min+(total*0.6)},{i:&#39;20&#39;,v:min+(total*0.8)} ];</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return v;</span></p><p class="c7"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c7"><span class="c4">});</span></p><p class="c7 c25"><span class="c4"></span></p><p class="c7"><span class="c4 c2">&lt;</span><span class="c4 c10">div</span><span class="c4 c2">&nbsp;</span><span class="c4 c5">id</span><span class="c4 c2">=&quot;graph&quot;&gt;</span></p><p class="c7"><span class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c4 c2">&lt;</span><span class="c4 c10">svg</span><span class="c4 c2">&nbsp;&hellip;&gt;</span></p><p class="c7"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span class="c4 c10">polygon</span><span class="c4 c2">&nbsp;&hellip;&gt;</span></p><p class="c7"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;!-- g designe un groupe en svg, c&rsquo;est un conteneur, un peu comme un div</span></p><p class="c6 c19"><span class="c4 c2">on binde la propri&eacute;t&eacute; &quot;reference&quot; de notre context de donn&eacute;es, et on lui associe en plus la cl&eacute; &quot;amplitude&quot;</span></p><p class="c6 c19"><span class="c4 c2">ie: a chaque fois que &quot;amplitude&quot; sera modifi&eacute;e, &quot;references&quot; se mettra aussi &agrave; jour --&gt;</span></p><p class="c7"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span class="c4 c10">g</span><span class="c4 c2">&gt;</span><span class="c0">{binding from:references alt:amplitude &nbsp;presenter:stckref converter:toReferences fallback:nosvgdatas}</span><span class="c4 c2">&lt;/</span><span class="c4 c10">g</span><span class="c4 c2">&gt;</span></p><p class="c7"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/svg&gt;</span></p><p class="c7 c25"><span class="c4 c2"></span></p><p class="c6"><span class="c4">On cr&eacute;e le presenter </span><span class="c0">stckref </span><span class="c4">et </span><span class="c0">nosvgdatas </span><span class="c4">dans le cas ou on n&rsquo;a pas de donn&eacute;es. Comme le SVG utilise des SVGElement et pas des HTMLElement,</span><span class="c0">&nbsp;on cr&eacute;e nos presenters avec une balise &lt;SVG&gt;</span><span class="c4">&nbsp;et pas &lt;DIV&gt; (sinon, il n&rsquo;y aurait pas de rendu), et </span><span class="c0">on binde les attributs</span><span class="c4">&nbsp;y1, y2, etc&hellip; </span><span class="c0">en les pr&eacute;fixant par &ldquo;data-binded&rdquo; &nbsp;et en pr&eacute;cisant forceAttr:true </span><span class="c4">pour &eacute;viter d&rsquo;irriter les navigateurs tatillons.</span></p><p class="c6 c25"><span class="c4"></span></p><p class="c7"><span class="c4 c2">&lt;</span><span class="c4 c10">div</span><span class="c4 c2">&nbsp;</span><span class="c4 c5">data-role</span><span class="c4 c2">=&quot;presenters&quot;&gt;</span></p><p class="c7"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&hellip;</span></p><p class="c6"><span class="c4 c2">&lt;</span><span class="c4 c10">svg</span><span class="c4 c2">&nbsp;</span><span class="c4 c5">data-role</span><span class="c4 c2">=&quot;presenter&quot; </span><span class="c4 c5">id</span><span class="c4 c2">=&quot;stckref&quot;&gt;</span></p><p class="c7"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span class="c4 c10">g</span><span class="c4 c2">&gt;</span></p><p class="c7"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;</span><span class="c4 c10">line</span><span class="c4 c2">&nbsp; &nbsp;</span><span class="c4 c5">x1</span><span class="c4 c2">=&quot;0&quot; </span><span class="c4 c5">data-binded-y1</span><span class="c4 c2">=&quot;</span><span class="c0">{binding from:i forceAttr:true fallback:&#39;0&#39;}</span><span class="c4 c2">&quot;</span></p><p class="c6 c20"><span class="c4 c2">&nbsp;</span><span class="c4 c5">x2</span><span class="c4 c2">=&quot;100&quot; </span><span class="c4 c5">data-binded-y2</span><span class="c4 c2">=&quot;</span><span class="c0">{binding from:i forceAttr:true fallback:&#39;0&#39;}</span><span class="c4 c2">&quot; </span></p><p class="c6 c20"><span class="c4 c5">style</span><span class="c4 c2">=&quot;stroke:#2A3138;stroke-width:0.2;&quot; stroke-dasharray=&quot;1,1&quot;&gt;&lt;/</span><span class="c4 c10">line</span><span class="c4 c2">&gt;</span></p><p class="c7"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c4 c10">text</span><span class="c4 c2">&nbsp; </span><span class="c4 c5">x</span><span class="c4 c2">=&quot;99%&quot; </span><span class="c4 c5">data-binded-y</span><span class="c4 c2">=&quot;</span><span class="c0">{binding from:i forceAttr:true fallback:&#39;0&#39;}</span><span class="c4 c2">&quot; </span></p><p class="c6 c24"><span class="c4 c5">text-anchor</span><span class="c4 c2">=&quot;end&quot; </span><span class="c4 c5">font-size</span><span class="c4 c2">=&quot;2.3&quot; </span><span class="c4 c5">fill</span><span class="c4 c2">=&quot;#a6a6a6&quot;</span></p><p class="c6 c24"><span class="c4 c5">stroke</span><span class="c4 c2">=&quot;#a6a6a6;stroke-width:0.1;&quot;&gt;</span><span class="c0">{binding from:v &nbsp;converter:localize fallback:&#39;0&#39;}</span><span class="c4 c2">&lt;/</span><span class="c4 c10">text</span><span class="c4 c2">&gt;</span></p><p class="c7"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/</span><span class="c4 c10">g</span><span class="c4 c2">&gt;</span></p><p class="c7"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/</span><span class="c4 c10">svg</span><span class="c4 c2">&gt;</span></p><p class="c7"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c4 c10">svg</span><span class="c4 c2">&nbsp;</span><span class="c4 c5">data-role</span><span class="c4 c2">=&quot;presenter&quot; </span><span class="c4 c5">id</span><span class="c4 c2">=&quot;nosvgdatas&quot;&gt;</span></p><p class="c7"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c4 c10">text</span><span class="c4 c2">&nbsp; </span><span class="c4 c5">x</span><span class="c4 c2">=&quot;50%&quot; </span><span class="c4 c5">y</span><span class="c4 c2">=&quot;50%&quot; </span><span class="c4 c5">text-anchor</span><span class="c4 c2">=&quot;middle&quot; </span><span class="c4 c5">font-size</span><span class="c4 c2">=&quot;4&quot; </span><span class="c4 c5">fill</span><span class="c4 c2">=&quot;#a6a6a6&quot;</span></p><p class="c6 c20"><span class="c4 c2">&nbsp;</span><span class="c4 c5">stroke</span><span class="c4 c2">=&quot;#a6a6a6;stroke-width:0.1;&quot;&gt;no datas&lt;/</span><span class="c4 c10">text</span><span class="c4 c2">&gt;</span></p><p class="c7"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/</span><span class="c4 c10">svg</span><span class="c4 c2">&gt;</span></p><p class="c7 c25"><span class="c4 c2"></span></p><p class="c7 c25"><span class="c4"></span></p><p class="c6"><span class="c0">Choisir la dur&eacute;e d&rsquo;affichage</span><span class="c4">:</span></p><p class="c7"><span class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Pour en finir avec l&rsquo;application de d&eacute;monstration, </span><span class="c0">on va donner la possibilit&eacute; &agrave; l&rsquo;utilisateur de choisir la dur&eacute;e du chart</span><span class="c4">. Par d&eacute;faut, on propose 1 an, on va permettre de choisir d&rsquo;afficher l&#39;&eacute;volution pour la journ&eacute;e, la semaine, le mois, l&rsquo;ann&eacute;e ou 5 ans.</span></p><p class="c7"><span class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;On va cr&eacute;er un radiogroup sous le graphique, li&eacute; &agrave; une propri&eacute;t&eacute; (disons: time) du contexte de donn&eacute;es, &agrave; chaque click sur un bouton, on rechargera les informations de cotation.</span></p><p class="c7"><span class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;On commence par cr&eacute;er une nouvelle propri&eacute;t&eacute; dans notre data-context, comme on veut agir lors de sa modification, on cr&eacute;e donc une propri&eacute;t&eacute; &lsquo;invisible&rsquo;(pr&eacute;c&eacute;d&eacute;e par un underscore: ici </span><span class="c0">_time</span><span class="c4">) et on lui adjoint un setter (dont le nom servira pour les bindings, ici </span><span class="c0">time</span><span class="c4">)</span></p><p class="c7"><span class="c4 c2">function wowsContext () {</span></p><p class="c7"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&hellip;</span></p><p class="c7"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this._time = &ldquo;1Y&rdquo;; </span><span class="c4 c5">//par d&eacute;faut, vaut 1 an</span></p><p class="c7"><span class="c4 c2">}</span></p><p class="c7 c25"><span class="c4 c2"></span></p><p class="c7"><span class="c4 c2">wowsContext.defineBindProperty(&quot;</span><span class="c4 c21">time</span><span class="c4 c2">&quot;,{</span></p><p class="c7"><span class="c4 c2">&nbsp; &nbsp; </span><span class="c0 c2">get:function()</span><span class="c4 c2">{</span></p><p class="c7"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; return this._time;</span></p><p class="c7"><span class="c4 c2">&nbsp; &nbsp; },</span></p><p class="c7"><span class="c4 c2">&nbsp; &nbsp; </span><span class="c0 c2">set:function(value)</span><span class="c4 c2">{</span></p><p class="c7"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; this._time=value;</span></p><p class="c7"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c4 c5">//recharge les donn&eacute;es de cotation seulement si on en affiche une...</span></p><p class="c7"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; if(this.stock.code!=null) this.</span><span class="c0 c2">selectNewStock</span><span class="c4 c2">(null, this.stock.code);</span></p><p class="c7"><span class="c4 c2">&nbsp; &nbsp; }</span></p><p class="c7"><span class="c4 c2">})</span></p><p class="c7"><span class="c4">Ensuite, on modifie la m&eacute;thode </span><span class="c0">selectNewStock </span><span class="c4">pour prendre en compte notre nouveau param&egrave;tre </span><span class="c0">_time</span><span class="c4">:</span></p><p class="c7"><span class="c0 c2">wowsContext.prototype.selectNewStock = function(evt, id)</span><span class="c4 c2">{</span></p><p class="c7"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; if (id != undefined){</span></p><p class="c7"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;url = &quot;http://finance.services.appex.bing.com/Market.svc/M-TodayEquityV4?rtSymbols=&quot;</span></p><p class="c7"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+id</span></p><p class="c7"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&quot;&amp;chartSymbols=&quot;+id</span></p><p class="c7"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&quot;&amp;chartType=&rdquo;</span><span class="c4 c15">+this.time+</span><span class="c4 c2">&rdquo;&amp;lang=FR-FR&amp;localizeFor=FR-FR&quot;;</span></p><p class="c7"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="c4 c5">//chargement des donn&eacute;es</span></p><p class="c7"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; __load_async_json (url,&quot;copy_stock_details&quot;, error_loading, timeout_error );</span></p><p class="c7"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c7"><span class="c4 c2">}</span></p><p class="c7"><span class="c4">Dans notre HTML, sous le presenter pour notre objet stock, on rajoute notre radiogroup et on cr&eacute;e les bindings 2way:</span></p><p class="c7"><span class="c4 c2">&lt;</span><span class="c4 c10">div</span><span class="c4 c2">&nbsp;</span><span class="c4 c5">id</span><span class="c4 c2">=&quot;stock&quot;&gt;</span></p><p class="c6"><span class="c4">&lt;</span><span class="c4 c10">div</span><span class="c4">&gt;</span><span class="c0">{binding from:stock presenter:stock_presenter}</span><span class="c4 c2">&lt;/</span><span class="c4 c10">div</span><span class="c4 c2">&gt;</span></p><p class="c7"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;!-- menu pour les jours --&gt;</span></p><p class="c7"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c4 c10">div</span><span class="c4 c2">&nbsp;</span><span class="c4 c5">class</span><span class="c4 c2">=&quot;ui-rdgroup-horizontal center_horizontal&quot;&gt;</span></p><p class="c7"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c4 c10">input</span><span class="c4 c2">&nbsp;</span><span class="c4 c5">type</span><span class="c4 c2">=&quot;radio&quot; </span><span class="c4 c5">data-binded-checked</span><span class="c4 c2">=&quot;</span><span class="c0 c2">{binding from:time mode:2way}</span><span class="c4 c2">&quot; </span><span class="c4 c5">value</span><span class="c4 c2">=&quot;1D&quot; </span><span class="c4 c5">name</span><span class="c4 c2">=&quot;time&quot; </span><span class="c4 c5">id</span><span class="c4 c2">=&quot;time_j&quot;/&gt;</span></p><p class="c7"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c4 c10">label</span><span class="c4 c2">&nbsp;</span><span class="c4 c5">for</span><span class="c4 c2">=&quot;time_j&quot;&gt;Jour&lt;/</span><span class="c4 c10">label</span><span class="c4 c2">&gt;</span></p><p class="c7"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c4 c10">input</span><span class="c4 c2">&nbsp;</span><span class="c4 c5">type</span><span class="c4 c2">=&quot;radio&quot; </span><span class="c4 c5">data-binded-checked</span><span class="c4 c2">=&quot;</span><span class="c0 c2">{binding from:time mode:2way}</span><span class="c4 c2">&quot; </span><span class="c4 c5">value</span><span class="c4 c2">=&quot;5D&quot; </span><span class="c4 c5">name</span><span class="c4 c2">=&quot;time&quot; </span><span class="c4 c5">id</span><span class="c4 c2">=&quot;time_s&quot;/&gt;</span></p><p class="c7"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c4 c10">label</span><span class="c4 c2">&nbsp;</span><span class="c4 c5">for</span><span class="c4 c2">=&quot;time_s&quot;&gt;Semaine&lt;/</span><span class="c4 c10">label</span><span class="c4 c2">&gt;</span></p><p class="c7 c19"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &lt;</span><span class="c4 c10">input</span><span class="c4 c2">&nbsp;</span><span class="c4 c5">type</span><span class="c4 c2">=&quot;radio&quot; </span><span class="c4 c5">data-binded-checked</span><span class="c4 c2">=&quot;</span><span class="c0 c2">{binding from:time mode:2way}</span><span class="c4 c2">&quot; </span><span class="c4 c5">value</span><span class="c4 c2">=&quot;1M&quot; </span><span class="c4 c5">name</span><span class="c4 c2">=&quot;time&quot; &nbsp;</span><span class="c4 c5">id</span><span class="c4 c2">=&quot;time_m&quot;/&gt;</span></p><p class="c7"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;</span><span class="c4 c10">label</span><span class="c4 c2">&nbsp;</span><span class="c4 c5">for</span><span class="c4 c2">=&quot;time_m&quot;&gt;Mois&lt;/</span><span class="c4 c10">label</span><span class="c4 c2">&gt;</span></p><p class="c6"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &lt;</span><span class="c4 c10">input</span><span class="c4 c2">&nbsp;</span><span class="c4 c5">type</span><span class="c4 c2">=&quot;radio&quot; </span><span class="c4 c5">data-binded-checked</span><span class="c4 c2">=&quot;</span><span class="c0 c2">{binding from:time mode:2way}</span><span class="c4 c2">&quot; </span><span class="c4 c5">name</span><span class="c4 c2">=&quot;time&quot; </span><span class="c4 c5">value</span><span class="c4 c2">=&quot;1Y&quot; </span><span class="c4 c5">id</span><span class="c4 c2">=&quot;time_a&quot;/&gt;</span></p><p class="c7"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;</span><span class="c4 c10">label</span><span class="c4 c2">&nbsp;</span><span class="c4 c5">for</span><span class="c4 c2">=&quot;time_a&quot;&gt;Ann&eacute;e&lt;/</span><span class="c4 c10">label</span><span class="c4 c2">&gt;</span></p><p class="c7"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;</span><span class="c4 c10">input</span><span class="c4 c2">&nbsp;</span><span class="c4 c5">type</span><span class="c4 c2">=&quot;radio&quot; </span><span class="c4 c5">data-binded-checked</span><span class="c4 c2">=&quot;</span><span class="c0 c2">{binding from:time mode:2way}</span><span class="c4 c2">&quot; </span><span class="c4 c5">name</span><span class="c4 c2">=&quot;time&quot; </span><span class="c4 c5">value</span><span class="c4 c2">=&quot;5Y&quot; </span><span class="c4 c5">id</span><span class="c4 c2">=&quot;time_5a&quot;/&gt;</span></p><p class="c7"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c4 c10">label</span><span class="c4 c2">&nbsp;</span><span class="c4 c5">for</span><span class="c4 c2">=&quot;time_5a&quot;&gt;5 ans&lt;/</span><span class="c4 c10">label</span><span class="c4 c2">&gt;</span></p><p class="c7"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;&lt;/</span><span class="c4 c10">div</span><span class="c4 c2">&gt;</span></p><p class="c7"><span class="c4 c2">&lt;/</span><span class="c4 c10">div</span><span class="c4 c2">&gt;</span></p><p class="c7"><span class="c4">Et un peu de style pour finir:</span></p><p class="c7 c25"><span class="c4 c2"></span></p><p class="c7"><span class="c0 c2">.ui-rdgroup-horizontal </span><span class="c4 c2">{</span></p><p class="c7"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c4 c10">display</span><span class="c4 c2">:inline-block;</span></p><p class="c7"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c4 c10">width</span><span class="c4 c2">: 80%;</span></p><p class="c7"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c4 c10">text-align</span><span class="c4 c2">: center;</span></p><p class="c7"><span class="c4 c2">}</span></p><p class="c7 c25"><span class="c4 c2"></span></p><p class="c7"><span class="c0 c2">.ui-rdgroup-horizontal &gt; input[type=radio]</span><span class="c4 c2">{</span></p><p class="c7"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c4 c10">display</span><span class="c4 c2">:none;</span></p><p class="c7"><span class="c4 c2">}</span></p><p class="c7"><span class="c0 c2">.ui-rdgroup-horizontal &gt;input[type=radio] + label</span><span class="c4 c2">{</span></p><p class="c7 c25"><span class="c4 c2"></span></p><p class="c7"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c4 c10">background-color</span><span class="c4 c2">:inherit;</span></p><p class="c7"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c4 c10">font-size</span><span class="c4 c2">: 1.1em;</span></p><p class="c7"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c4 c10">color</span><span class="c4 c2">: inherit;</span></p><p class="c7"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c4 c10">text-align</span><span class="c4 c2">:center;</span></p><p class="c7"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c4 c10">margin-right</span><span class="c4 c2">: 10px;</span></p><p class="c7"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c4 c10">white-space</span><span class="c4 c2">: nowrap;</span></p><p class="c7"><span class="c4 c2">}</span></p><p class="c7"><span class="c0 c2">.ui-rdgroup-horizontal &gt;label </span><span class="c4 c2">{</span><span class="c4 c10">cursor</span><span class="c4 c2">:pointer;}</span></p><p class="c7"><span class="c0 c2">.ui-rdgroup-horizontal &gt;label:last-child</span><span class="c4 c2">{</span></p><p class="c7"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c4 c10">margin-right</span><span class="c4 c2">: 0px !important;</span></p><p class="c7"><span class="c4 c2">}</span></p><p class="c7"><span class="c0 c2">.ui-rdgroup-horizontal &gt;input[type=radio]:checked + label</span><span class="c4 c2">{</span></p><p class="c7"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c4 c10">color</span><span class="c4 c2">:#45B2FB;</span></p><p class="c7"><span class="c4 c2">}</span></p><p class="c7 c25"><span class="c4 c2"></span></p><p class="c7 c25"><span class="c4 c2"></span></p><p class="c7"><span class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c0">Loading widget</span><span class="c4">:</span></p><p class="c7 c19"><span class="c4">Pour faire patienter l&rsquo;utilisateur lors du chargement des informations de cotation, on va mettre en place un widget de chargement (il n&rsquo;est pas de moi, je l&rsquo;ai trouv&eacute; sur le net mais impossible de me rappeler o&ugrave;&hellip;) uniquement CSS.</span></p><p class="c7 c19"><span class="c4">wows.css</span></p><p class="c7 c19"><span class="c4 c2">/* animation css de chargement*/</span></p><p class="c7 c19"><span class="c0 c2">.nospinner </span><span class="c4 c2">{</span><span class="c4 c10">display</span><span class="c4 c2">:none;}</span></p><p class="c7 c19"><span class="c0 c2">.spinner</span><span class="c4 c2">&nbsp;{</span></p><p class="c7 c19"><span class="c4 c2">&nbsp; </span><span class="c4 c10">width</span><span class="c4 c2">: 40px;</span></p><p class="c7 c19"><span class="c4 c2">&nbsp; </span><span class="c4 c10">height</span><span class="c4 c2">: 40px;</span></p><p class="c7 c25 c19"><span class="c4 c2"></span></p><p class="c7 c19"><span class="c4 c2">&nbsp; </span><span class="c4 c10">z-index</span><span class="c4 c2">: 100;</span></p><p class="c7 c19"><span class="c4 c2">&nbsp; </span><span class="c4 c10">background-color</span><span class="c4 c2">: #45B2FB;</span></p><p class="c7 c19"><span class="c4 c2">&nbsp;</span><span class="c4 c10">display</span><span class="c4 c2">: block;</span></p><p class="c7 c19"><span class="c4 c2">&nbsp; </span><span class="c4 c10">margin</span><span class="c4 c2">: 100px auto;</span></p><p class="c7 c19"><span class="c4 c2">&nbsp; </span><span class="c4 c10">-webkit-animation</span><span class="c4 c2">: sk-rotateplane 1.2s infinite ease-in-out;</span></p><p class="c7 c19"><span class="c4 c2">&nbsp; </span><span class="c4 c10">animation</span><span class="c4 c2">: sk-rotateplane 1.2s infinite ease-in-out;</span></p><p class="c7 c25 c19"><span class="c4 c2"></span></p><p class="c7 c19"><span class="c4 c10">position</span><span class="c4 c2">: absolute;</span></p><p class="c7 c19"><span class="c4 c2">&nbsp; </span><span class="c4 c10">top</span><span class="c4 c2">:20%;</span></p><p class="c7 c19"><span class="c4 c2">&nbsp; </span><span class="c4 c10">left</span><span class="c4 c2">:50%;</span></p><p class="c7 c19"><span class="c4 c2">}</span></p><p class="c7 c19"><span class="c0 c2">@-webkit-keyframes sk-rotateplane</span><span class="c4 c2">&nbsp;{</span></p><p class="c7 c19"><span class="c4 c2">&nbsp; 0% { -webkit-transform: perspective(120px) }</span></p><p class="c7 c19"><span class="c4 c2">&nbsp; 50% { -webkit-transform: perspective(120px) rotateY(180deg) }</span></p><p class="c7 c19"><span class="c4 c2">&nbsp; 100% { -webkit-transform: perspective(120px) rotateY(180deg) &nbsp;rotateX(180deg) }</span></p><p class="c7 c19"><span class="c4 c2">}</span></p><p class="c7 c25 c19"><span class="c4 c2"></span></p><p class="c7 c19"><span class="c0 c2">@keyframes sk-rotateplane </span><span class="c4 c2">{</span></p><p class="c7 c19"><span class="c4 c2">&nbsp; 0% {</span></p><p class="c7 c19"><span class="c4 c2">&nbsp; &nbsp; </span><span class="c4 c10">transform</span><span class="c4 c2">: perspective(120px) rotateX(0deg) rotateY(0deg);</span></p><p class="c7 c19"><span class="c4 c2">&nbsp; &nbsp; </span><span class="c4 c10">-webkit-transform</span><span class="c4 c2">: perspective(120px) rotateX(0deg) rotateY(0deg)</span></p><p class="c7 c19"><span class="c4 c2">&nbsp; } 50% {</span></p><p class="c7 c19"><span class="c4 c2">&nbsp; &nbsp; </span><span class="c4 c10">transform</span><span class="c4 c2">: perspective(120px) rotateX(-180.1deg) rotateY(0deg);</span></p><p class="c7 c19"><span class="c4 c2">&nbsp; &nbsp; </span><span class="c4 c10">-webkit-transform</span><span class="c4 c2">: perspective(120px) rotateX(-180.1deg) rotateY(0deg)</span></p><p class="c7 c19"><span class="c4 c2">&nbsp; } 100% {</span></p><p class="c7 c19"><span class="c4 c2">&nbsp; &nbsp; </span><span class="c4 c10">transform</span><span class="c4 c2">: perspective(120px) rotateX(-180deg) rotateY(-179.9deg);</span></p><p class="c7 c19"><span class="c4 c2">&nbsp; &nbsp; </span><span class="c4 c10">-webkit-transform</span><span class="c4 c2">: perspective(120px) rotateX(-180deg) rotateY(-179.9deg);</span></p><p class="c7 c19"><span class="c4 c2">&nbsp; }</span></p><p class="c7 c19"><span class="c4 c2">}</span></p><p class="c7 c19"><span class="c4">Pour g&eacute;rer l&rsquo;affichage ou pas du widget, on va cr&eacute;er dans le contexte de donn&eacute;es global (wowsContext) une nouvelle propri&eacute;t&eacute; du type boolean nomm&eacute;e &ldquo;</span><span class="c0">loading</span><span class="c4">&rdquo;, initialis&eacute;e par d&eacute;faut &agrave; false. Cette propri&eacute;t&eacute; servira &agrave; d&eacute;terminer la classe &agrave; appliquer au &lt;DIV&gt; qui contiendra notre widget (</span><span class="c0">spinner</span><span class="c4">&nbsp;si est en train de charger(</span><span class="c0">true</span><span class="c4">), </span><span class="c0">no_spinner </span><span class="c4">si ne fait rien(</span><span class="c0">false</span><span class="c4">))... </span></p><p class="c7 c19"><span class="c4 c2">function wowsContext() {</span></p><p class="c7 c19"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&hellip;</span></p><p class="c7 c19"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.loading= false,</span></p><p class="c7 c19"><span class="c4 c2">};</span></p><p class="c7 c19"><span class="c4">...on modifie le code de </span><span class="c0">selectNewStock </span><span class="c4">pour la passer &agrave; true &nbsp;et indiquer le d&eacute;but de chargement)...</span></p><p class="c7 c19"><span class="c4 c2">wowsContext.prototype.selectNewStock = function(evt, id){</span></p><p class="c7 c19"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; if (id != undefined){</span></p><p class="c7 c19"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c4 c5">//indique que lance le chargement</span></p><p class="c7 c19"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c4 c15">&nbsp;this.loading = true;</span></p><p class="c7 c19"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;url = &quot;http://finance.services.appex.bing.com/Market.svc/M-TodayEquityV4?rtSymbols=&quot;</span></p><p class="c7 c19"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+id</span></p><p class="c7 c19"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&quot;&amp;chartSymbols=&quot;+id</span></p><p class="c7 c19"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&quot;&amp;chartType=&quot;+this._time+&quot;&amp;lang=FR-FR&amp;localizeFor=FR-FR&quot;;</span></p><p class="c7 c19"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="c4 c5">//chargement des donn&eacute;es</span></p><p class="c7 c19"><span class="c4 c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //le timeout pose probleme a cause du this!</span></p><p class="c7 c19"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; var ctx = this;</span></p><p class="c7 c19"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; setTimeout(function(){ctx.__load_async_json (url,&quot;copy_stock_details&quot;, ctx.error_loading, ctx.timeout_error )},1000);</span></p><p class="c7 c19"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c7 c25 c19"><span class="c4 c2"></span></p><p class="c7 c19"><span class="c4 c2">}</span></p><p class="c7 c25 c19"><span class="c4"></span></p><p class="c7 c19"><span class="c4">...et la m&eacute;thode </span><span class="c0">copy_stock_details </span><span class="c4">o&ugrave; on la remettra &agrave; false pour indiquer la fin du chargement:</span></p><p class="c7 c19"><span class="c4 c2">wowsContext.prototype.copy_stock_details = function(data){</span></p><p class="c7 c19"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; obj = data.Rtd[0];</span></p><p class="c7 c19"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; this.stock.copyFromJSON(obj, data.Charts[0].Series);</span></p><p class="c7 c19"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c7 c19"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c4 c5">//fin de chargement</span></p><p class="c7 c19"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c4 c15">this.loading = false;</span></p><p class="c7 c19"><span class="c4 c2">}</span></p><p class="c7 c19"><span class="c4">Pour r&eacute;cup&eacute;rer le nom de la classe &agrave; appliquer en fonction de &ldquo;loading&rdquo;, on cr&eacute;e une m&eacute;thode de conversion </span><span class="c0">is_loading</span><span class="c4">:</span></p><p class="c7 c19"><span class="c4 c2">function is_loading(value){</span></p><p class="c7 c19"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; return value ? &quot;spinner&quot; : &quot;no_spinner&quot;;</span></p><p class="c7 c19"><span class="c4 c2">}</span></p><p class="c7 c25 c19"><span class="c4"></span></p><p class="c7 c25 c19"><span class="c4"></span></p><p class="c7 c19"><span class="c4">Il ne reste plus qu&rsquo;&agrave; cr&eacute;er mon widget dans la page HTML et appliquer le binding:</span></p><p class="c7 c25 c19"><span class="c4"></span></p><p class="c7 c19"><span class="c4 c2">&hellip;</span></p><p class="c7 c19"><span class="c4 c2">&lt;</span><span class="c4 c10">div</span><span class="c4 c2">&nbsp;</span><span class="c4 c5">id</span><span class="c4 c2">=&quot;stock&quot;&gt;</span></p><p class="c7 c19"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c4 c10">div</span><span class="c4 c2">&nbsp;</span><span class="c4 c5">data-binded-class</span><span class="c4 c2">=&quot;</span><span class="c0">{binding from:loading converter:is_loading fallback:spinner}</span><span class="c4 c2">&quot;&gt;&lt;/</span><span class="c4 c10">div</span><span class="c4 c2">&gt;</span></p><p class="c7 c19"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span class="c4 c10">div</span><span class="c4 c2">&gt;</span><span class="c0 c2">{binding from:stock presenter:stock_presenter}</span><span class="c4 c2">&lt;/</span><span class="c4 c10">div</span><span class="c4 c2">&gt;</span></p><p class="c7 c19"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;!-- menu pour les jours --&gt;</span></p><p class="c7 c19"><span class="c4 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...</span></p><p class="c7 c25 c19"><span class="c4"></span></p><p class="c7 c25 c19"><span class="c4"></span></p></body></html>